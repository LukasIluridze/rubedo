import{ItemStack as Xn,MinecraftItemTypes as Jn}from"mojang-minecraft";import{world as Ot}from"mojang-minecraft";var k="-";import{Location as Bt}from"mojang-minecraft";import{world as Dt}from"mojang-minecraft";function Ye(t){return[...Dt.getPlayers()].find(e=>e.name===t)}var N=class{constructor(e="literal"){this.name=e;this.typeName="literal";this.name=e}matches(e){return{success:this.name==e}}},Y=class{constructor(e="string"){this.name=e;this.typeName="string";this.name=e}matches(e){return{success:e&&e!="",value:e}}},V=class{constructor(e="integer"){this.name=e;this.typeName="int";this.name=e}matches(e){return{success:!isNaN(e),value:parseInt(e)}}},_e=class{constructor(e="float"){this.name=e;this.typeName="float";this.name=e}matches(e){return{success:Boolean(e?.match(/^\d+\.\d+$/)?.[0]),value:parseInt(e)}}},L=class{constructor(e="location"){this.name=e;this.typeName="location";this.name=e}matches(e){return{success:!isNaN(e),value:e}}},H=class{constructor(e="boolean"){this.name=e;this.typeName="boolean";this.name=e}matches(e){return{success:Boolean(e?.match(/^(true|false)$/)?.[0]),value:e=="true"}}},Ie=class{constructor(e="player"){this.name=e;this.typeName="playerName";this.name=e}matches(e){return{success:!!Ye(e),value:Ye(e)}}},ke=class{constructor(e="target"){this.name=e;this.typeName="Target";this.name=e}matches(e){return{success:Boolean(e?.match(/^(@.|"[\s\S]+")$/)?.[0]),value:e}}},j=class{constructor(e="array",n){this.name=e;this.types=n;this.typeName="string";this.name=e,this.types=n,this.typeName=n.join(" | ").replace(/(.{25})..+/,"$1...")}matches(e){return{success:this.types.includes(e),value:e}}},we=class{constructor(e){this.name=e;this.typeName="UnitValueType"}matches(e){return["years","yrs","weeks","days","hours","hrs","minutes","mins","seconds","secs","milliseconds","msecs","ms"].includes(e)?{success:e&&e!="",value:e}:{success:!1}}},h={string:Y,int:V,float:_e,location:L,boolean:H,player:Ie,target:ke,array:j,unit:we};var ne=class{constructor(e){this.data=e,this.sender=e.sender}reply(e){this.sender.tell(e)}};function Ve(t,e){return t.slice(e.length).trim().match(/"[^"]+"|[^\s]+/g).map(n=>n.replace(/"(.+)"/,"$1").toString())}function He(t,e){t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.unknown",with:[`${e}`]}]})}function Ce(t,e){t.tell({rawtext:[{text:e.data.invaildPermission?e.data.invaildPermission:`\xA7cYou do not have perrmission to use "${e.data.name}"`}]})}function je(t,e,n,r){t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.syntax",with:[`${k}${e.data.name} ${n.slice(0,r).join(" ")}`,n[r]??" ",n.slice(r+1).join(" ")]}]})}function $t([t,e,n],{location:r,viewVector:o}){if(!t||!e||!t)return null;let i=[r.x,r.y,r.z],a=[o.x,o.y,o.z],c=[t,e,n].map(g=>{let b=parseInt(g.replace(/\D/g,""));return isNaN(b)?0:b}),m=[t,e,n].map((g,b)=>g.includes("~")?c[b]+i[b]:g.includes("^")?c[b]+a[b]:c[b]);return new Bt(m[0],m[1],m[2])}function qe(t,e,n,r){let o=e[e.length-1]??r,i=[];for(let[a,c]of e.entries())if(!c.type.name.endsWith("*")){if(c.type instanceof L){i.push($t([t[a],t[a+1],t[a+2]],n.sender));continue}c.type instanceof N||i.push(c.type.matches(t[a]).value??t[a])}o.callback(new ne(n),...i)}var E=[];Ot.events.beforeChat.subscribe(t=>{if(!t.message.startsWith(k))return;t.cancel=!0;let e=Ve(t.message,k),n=E.find(i=>i.depth==0&&(i.data.name==e[0]||i.data?.aliases?.includes(e[0])));if(!n)return He(t.sender,e[0]);if(!n.data?.requires(t.sender))return Ce(t.sender,n);e.shift();let r=[],o=(i,a)=>{if(i.children.length>0){let c=i.children.find(m=>m.type.matches(e[a]).success);return!c&&!e[a]&&i.callback?void 0:c?c.data?.requires(t.sender)?(r.push(c),o(c,a+1)):(Ce(t.sender,c),"fail"):(je(t.sender,n,e,a),"fail")}};o(n,0)||qe(e,r,t,n)});import{world as Wt}from"mojang-minecraft";var Ee="rubedo:gui",ve="rubedo:inventory",Ke="home";import{world as G}from"mojang-minecraft";var q={};function re(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let o=0;o<r.size;o++){let i=e.slots[o];if(!i||!i.item){r.setItem(o,$);continue}r.setItem(o,i.item.setComponents())}}function Xe(t){let e="";if(t){let{id:n,nameTag:r,amount:o,data:i}=t;e=[n,r,o,i].join("")}return e}var T=class{constructor(e,n,r=re){if(n%9!=0)throw new Error("Size needs to be in a increment of 9");if(q[e])throw new Error(`Id of ${e} Already exsists`);this.id=e,this.size=n,this.slots=Array(this.size),this.fillType=r,q[e]=this}setSlots(e,n,r){let o=n?{item:n,action:r}:null;for(let i of e)this.slots[i]=o;return this}setButtonAtSlot(e,n){return this.slots[e]={item:n.Item,action:n.Action},this}};import{world as Je}from"mojang-minecraft";var We=new Map,K=class{constructor(e,n,r=!1,o=Date.now()){this.callbackTick=null,this.tickDelay=n,this.loop=r,this.callback=e,this.id=o,We.set(o,this),this.TickCallBack=Je.events.tick.subscribe(({currentTick:i})=>{if(this.callbackTick||(this.callbackTick=i+this.tickDelay),!(this.callbackTick>i)){if(this.callback(i),!this.loop)return this.expire();this.callbackTick=i+this.tickDelay}})}expire(){Je.events.tick.unsubscribe(this.TickCallBack),We.delete(this.id)}};var Ze=t=>new Promise(e=>Se(e,t));function Se(t,e){new K(t,e)}function v(t,e){return new K(t,e,!0)}var oe=class{constructor(e,n,r){this.gui=e,this.slot=n,this.change=r}message(e){this.gui.player.tell(e)}getItemAdded(){return this.slot.item?null:this.gui.entity.getComponent("minecraft:inventory").container.getItem(this.change.slot)}GiveAction(e=this.slot.item.itemStack){this.gui.player.getComponent("minecraft:inventory").container.addItem(e)}TakeAction(e=null){this.gui.player.getComponent("minecraft:inventory").container.addItem(this.slot.item.itemStack),this.gui.page.slots[this.change.slot]=null,e&&e.delete(this.slot.item.components.dbKey)}PageAction(e,n){this.gui.setPage(e,n)}BackAction(e=1){if(this.gui.pageHistory.length<e)return new Error("Tried to Go back to a page number that doesnt exist");console.warn(JSON.stringify(this.gui.pageHistory));let n=this.gui.pageHistory.splice(-1-e)[0];console.warn(JSON.stringify(this.gui.page.extras)),this.PageAction(n,this.gui.page.extras)}CloseAction(){this.gui.kill()}SetAction(){this.gui.entity.getComponent("minecraft:inventory").container.setItem(this.change.slot,this.slot.item.itemStack)}async FormAction(e){return this.CloseAction(),await Ze(5),await e.show(this.gui.player)}};import{MinecraftDimensionTypes as Kt}from"mojang-minecraft";import{world as w,BlockLocation as Re,MinecraftBlockTypes as Vt,MinecraftDimensionTypes as O}from"mojang-minecraft";var I={"api.name":()=>"Smelly API","api.error.unknown":()=>"An unknown error has occured.","api.database.error.table_name":(t,e)=>`The display name ${t} is too long for an objective, it can be at most ${e} characters long`,"api.utilities.formatter.error.ms":t=>`${t} is not a string or a number`,"api.Providers.form.invaildtype":(t,e)=>`Type ${t} is not a vaild type to add a ${e}`,"api.Providers.form.invaildFormtype":(t,e)=>{`${t}${JSON.stringify(e)}`},"api.ChestGUI.error.pagenotfound":t=>`Page ${t} not found!`,"modules.protections.cps.clickingToFast":()=>"You are clicking to fast! Please click slower!","modules.managers.mute.isMuted":()=>"You are muted and cannot send messages please try again later","modules.commands.ban.reply":(t,e=0,n="",r="")=>`\xA7cBanned \xA7f"\xA7a${t}\xA7f" \xA7cfor ${e} ${n} Because: "${r??"No reason Provided"}" \xA7aSuccessfully`};import{BlockLocation as zt,world as Gt}from"mojang-minecraft";var Qe=32e3,X="rubedo:database",Te=Gt.getDimension("overworld"),Ae=new zt(0,-64,0);import{ItemStack as Ft,MinecraftItemTypes as Ut}from"mojang-minecraft";function et(t,e){return t.match(new RegExp(".{1,"+e+"}","g"))}var d=class{static compress(e){return e}static decompress(e){return e}static createEntity(e,n){let r=Te.spawnEntity(X,Ae);r.setDynamicProperty("name",e),r.setDynamicProperty("index",n);let o=r.getComponent("inventory").container,i=new Ft(Ut.acaciaBoat,1);return n==0&&(i.nameTag="{}"),o.setItem(0,i),r}static getInventorySlotName(e,n){return e.getComponent("inventory").container.getItem(n)?.nameTag}static setInventorySlotName(e,n,r){let o=e.getComponent("inventory").container,i=o.getItem(n);return i.nameTag=r,o.setItem(n,i)}constructor(e){this.name=e,this.savedEntitys=void 0,this.MEMORY=void 0}get entitys(){if(this.savedEntitys)return this.savedEntitys;let e=Te.getEntitiesAtBlockLocation(Ae).filter(n=>n.id==X&&n.getDynamicProperty("name")==this.name);return this.savedEntitys=e,e}data(){if(this.MEMORY)return this.MEMORY;if(this.entitys.length==0&&d.createEntity(this.name,0),this.entitys.length==1){let n=JSON.parse(d.decompress(d.getInventorySlotName(this.entitys[0],0)));return this.MEMORY=n,n}let e=new Array(this.entitys.length);for(let n of this.entitys){let r=n.getDynamicProperty("index");e[r]=d.getInventorySlotName(n,0)}try{e=JSON.parse(e.join(""))}catch{e={}}return this.MEMORY=e,e}save(e){this.MEMORY=e;let n=et(d.compress(JSON.stringify(e)),Qe);if(this.entitys&&n.length==this.entitys.length)for(let r=0;r<n.length;r++)d.setInventorySlotName(this.entitys[r],0,n[r]);else{this.entitys?.forEach(r=>r?.triggerEvent("despawn")),this.savedEntitys=void 0;for(let r=0;r<n.length;r++){let o=d.createEntity(this.name,r);d.setInventorySlotName(o,0,n[r])}}}set(e,n){let r=this.data();r[e]=n,this.save(r)}get(e){return this.data()[e]}has(e){return this.keys().includes(e)}delete(e){let n=this.data(),r=delete n[e];return this.save(n),r}size(){return this.keys().length}clear(){this.save({})}keys(){return Object.keys(this.data())}values(){return Object.values(this.data())}getCollection(){return this.data()}};var s={config:new d("config"),freezes:new d("freezes"),mutes:new d("mutes"),bans:new d("bans"),regions:new d("regions"),roles:new d("roles"),tasks:new d("tasks"),npcs:new d("npcs")};var tt={doorsAndSwitches:!0,openContainers:!0,pvp:!1,allowedEntitys:["minecraft:player","minecraft:npc","minecraft:item"]},nt=["minecraft:acacia_door","minecraft:acacia_trapdoor","minecraft:acacia_button","minecraft:birch_door","minecraft:birch_trapdoor","minecraft:birch_button","minecraft:crimson_door","minecraft:crimson_trapdoor","minecraft:crimson_button","minecraft:dark_oak_door","minecraft:dark_oak_trapdoor","minecraft:dark_oak_button","minecraft:jungle_door","minecraft:jungle_trapdoor","minecraft:jungle_button","minecraft:mangrove_door","minecraft:mangrove_trapdoor","minecraft:mangrove_button","minecraft:spruce_door","minecraft:spruce_trapdoor","minecraft:spruce_button","minecraft:warped_door","minecraft:warped_trapdoor","minecraft:warped_button","minecraft:wooden_door","minecraft:wooden_button","minecraft:trapdoor","minecraft:iron_door","minecraft:iron_trapdoor","minecraft:polished_blackstone_button","minecraft:lever"],rt=["minecraft:chest","minecraft:ender_chest","minecraft:barrel","minecraft:trapped_chest","minecraft:dispenser","minecraft:dropper","minecraft:furnace","minecraft:blast_furnace","minecraft:lit_furnace","minecraft:lit_blast_furnace","minecraft:hopper","minecraft:shulker_box","minecraft:undyed_shulker_box"];var xe=[],Yt=!1,ot=-64,it=320;function st(t,e,n){return n.every((r,o)=>r>=Math.min(t[o],e[o])&&r<=Math.max(t[o],e[o]))}var f=class{static getAllRegions(){if(Yt)return xe;let e=s.regions.values().map(n=>new f(n.from,n.to,n.dimensionId,n.permissions,n.key));return e.forEach(n=>{xe.push(n)}),e}static blockLocationInRegion(e,n){return this.getAllRegions().find(r=>r.dimensionId==n&&st([r.from.x,ot,r.from.z],[r.to.x,it,r.to.z],[e.x,e.y,e.z]))}static removeRegionAtBlockLocation(e,n){let r=this.blockLocationInRegion(e,n);return r?s.regions.delete(r.key):!1}constructor(e,n,r,o,i){this.from=e,this.to=n,this.dimensionId=r,this.permissions=o??tt,this.key=i||Date.now().toString(),i||(this.update(),ie(),xe.push(this))}update(){s.regions.set(this.key,{key:this.key,from:this.from,dimensionId:this.dimensionId,permissions:this.permissions,to:this.to})}delete(){return s.regions.delete(this.key)}entityInRegion(e){return this.dimensionId==e.dimension.id&&st([this.from.x,ot,this.from.z],[this.to.x,it,this.to.z],[e.location.x,e.location.y,e.location.z])}changePermission(e,n){this.permissions[e]=n,this.update()}};var S=class{static getTasks(){return s.tasks.get("changePlayerRole")??[]}static getPlayersRoleToSet(e){return S.getTasks().find(r=>r.playerName==e)?.role}constructor(e,n){let r=S.getTasks();r.push({playerName:e,role:n}),s.tasks.set("changePlayerRole",r)}};var A={overworld:w.getDimension(O.overworld),nether:w.getDimension(O.nether),theEnd:w.getDimension(O.theEnd),"minecraft:overworld":w.getDimension(O.overworld),"minecraft:nether":w.getDimension(O.nether),"minecraft:the_end":w.getDimension(O.theEnd)};function se(t,e=[],n){try{t.runCommand(`kick "${t.nameTag}" \xA7r${e.join(`
`)}`),t.triggerEvent("kick")}catch(r){if(!/"statusCode":-2147352576/.test(r))return;n&&n()}}function p(t){if(typeof t=="string"){let e=[...w.getPlayers()].find(n=>n.name==t);return e?e.getDynamicProperty("role"):s.roles.get(t)??"member"}else return t.getDynamicProperty("role")}function at(t,e){if(typeof t=="string"){s.roles.set(t,e);let n=[...w.getPlayers()].find(r=>r.name==t);n?n.setDynamicProperty("role",e):new S(t,e)}else s.roles.set(t.name,e),t.setDynamicProperty("role",e)}function ie(){for(let t of f.getAllRegions()){let e=new Re(t.from.x,-64,t.from.z),n=new Re(t.to.x,-64,t.to.z);for(let r of e.blocksBetween(n))A[t.dimensionId].getBlock(r)?.setType(Vt.deny)}}var mt=[];function _(t,e=0){mt.push({callback:t,delay:e,lastCall:0})}w.events.tick.subscribe(t=>{let e=[...w.getPlayers()];for(let[n,r]of e.entries()){if(["moderator","admin"].includes(p(r)))return;for(let o of mt)o.delay!=0&&t.currentTick-o.lastCall<o.delay||(o.callback(r,t),n==e.length-1&&(o.lastCall=t.currentTick))}});function ct(t,e="overworld",n=!1){try{return n?console.warn(JSON.stringify(this.runCommand(t))):A.overworld.runCommand(t)}catch{return{error:!0}}}function y(t){try{return t.scoreboard.id.toString()}catch{try{try{t.runCommand("scoreboard objectives add test dummy")}catch{}try{t.runCommand("scoreboard players add @s test 0")}catch{}return t.scoreboard.id.toString()}catch{let r=t.getTags().find(i=>i.startsWith("id:"));if(r)return r.replace("id:","");let o=Date.now();return t.addTag(`id:${o}`),o.toString()}}}function z(t,{compactDuration:e,fullDuration:n,avoidDuration:r}={}){try{if(typeof t=="string"){if(/^\d+$/.test(t))return Number(t);let o=t.match(/-?\d*\.?\d+\s*?(years?|yrs?|weeks?|days?|hours?|hrs?|minutes?|mins?|seconds?|secs?|milliseconds?|msecs?|ms|[smhdwy])/gi);return o?o.reduce((i,a)=>i+Ht(a),0):null}if(typeof t=="number")return jt(t,{compactDuration:e,fullDuration:n,avoidDuration:r});throw new Error(I["api.utilities.formatter.error.ms"](t))}catch(o){let i=qt(o)?`${o.message}. Value = ${JSON.stringify(t)}`:I["api.error.unknown"]();throw new Error(i)}}function Ht(t){let e=Number(t.replace(/[^-.0-9]+/g,""));return t=t.replace(/\s+/g,""),/\d+(?=y)/i.test(t)?e*3154e7:/\d+(?=w)/i.test(t)?e*6048e5:/\d+(?=d)/i.test(t)?e*864e5:/\d+(?=h)/i.test(t)?e*36e5:/\d+(?=m)/i.test(t)?e*6e4:/\d+(?=s)/i.test(t)?e*1e3:/\d+(?=ms|milliseconds?)/i.test(t)?e:0}function jt(t,{compactDuration:e,fullDuration:n,avoidDuration:r}={}){let o=Math.abs(t),a=[{short:"w",long:"week",duration:Math.floor(o/6048e5)},{short:"d",long:"day",duration:Math.floor(o/864e5)%7},{short:"h",long:"hour",duration:Math.floor(o/36e5)%24},{short:"m",long:"minute",duration:Math.floor(o/6e4)%60},{short:"s",long:"second",duration:Math.floor(o/1e3)%60},{short:"ms",long:"millisecond",duration:o%1e3}].filter(m=>m.duration!==0&&r?n&&!r.map(g=>g.toLowerCase()).includes(m.short):m.duration).map(m=>`${Math.sign(t)===-1?"-":""}${e?`${Math.floor(m.duration)}${m.short}`:`${Math.floor(m.duration)} ${m.long}${m.duration===1?"":"s"}`}`);return(n?a.join(e?" ":", "):a[0])||`${o}`}function qt(t){return typeof t=="object"&&t!==null&&"message"in t}function lt(t){return new Re(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))}async function pt(t,e){try{let n=t.getComponent("minecraft:inventory").container,r=[];for(let o=0;o<n.size;o++){let i=n.getItem(o);!i||i?.id==e?.id&&(r.push({slot:o,item:i}),n.setItem,o<9?t.runCommand(`replaceitem entity @s slot.hotbar ${o} air`):t.runCommand(`replaceitem entity @s slot.inventory ${o-9} air`))}t.runCommand(`clear @s ${e?.id} ${e.data} ${e.amount}`);for(let o of r)n.setItem(o.slot,o.item)}catch(n){console.warn(n+n.stack),[...t.dimension.getEntities({type:"minecraft:item",location:t.location,maxDistance:2,closest:1})].forEach(r=>r.kill())}}function ft(t,e){return t.getComponent("minecraft:inventory").container.getItem(e)}function ut(t){let e=[];for(let n of Object.keys(Kt))[...A[n].getEntities()].forEach(r=>e.push(r));return t?e.filter(n=>n?.id==t):e}function Pe(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}var M={},F=class{static getEntitysGuiInstance(e){return Object.values(M).find(n=>n.entity==e)}static getSlotChange(e,n){if(e.length!=n.length)return null;for(let r=0;r<e.length;r++)if(e[r].uid!=n[r].uid)return{slot:r,item:e[r].item};return null}constructor(e,n){this.player=e,this.playersName=e.name,this.entity=n,this.previousMap=null,this.HAS_CONTAINER_OPEN=!1,this.pageHistory=[],this.extras=null,this.page=null,this.loops=[],this.entity||this.summon(),this.events={tick:G.events.tick.subscribe(()=>{try{if(!this.HAS_CONTAINER_OPEN||!this.previousMap)return;for(let o of this.loops)o();let r=F.getSlotChange(this.previousMap,this.mapInventory);if(r==null)return;this.onSlotChange(r)}catch(r){console.warn(r+r.stack)}}),playerLeave:G.events.playerLeave.subscribe(({playerName:r})=>{r==this.playersName&&this.kill()}),beforeDataDrivenEntityTriggerEvent:G.events.beforeDataDrivenEntityTriggerEvent.subscribe(r=>{if(!!["rubedo:has_container_open","rubedo:dosent_have_container_open"].includes(r.id)&&r.entity.nameTag==this.player.nameTag){if(r.id=="rubedo:has_container_open")return this.HAS_CONTAINER_OPEN=!0;this.HAS_CONTAINER_OPEN=!1}})},M[this.playersName]=this}summon(){try{ut(ve)?.find(n=>n.getTags().includes(`id:${this.playersName}`))?.triggerEvent("despawn");let e=G.events.entityCreate.subscribe(n=>{n.entity?.id==ve&&(this.entity=n.entity,this.entity.addTag(`id:${this.playersName}`),this.setPage(Ke)),G.events.entityCreate.unsubscribe(e)});this.player.triggerEvent("rubedo:spawn_inventory")}catch(e){console.warn(e+e.stack)}}reload(){this.entity.triggerEvent("despawn"),this.summon()}kill(){try{this.entity?.triggerEvent("despawn")}catch{}for(let e in this.events)G.events[e].unsubscribe(this.events[e]);delete M[this.playersName]}setPage(e,n){this.extras=n,this.pageHistory.push(e),this.loops=[];let r=q[e];if(!r)return new Error(I["api.ChestGUI.error.pagenotfound"](e??"Undefined"));r.fillType(this.entity,r,n),this.page=r,this.previousMap=this.mapInventory,this.entity.nameTag=`size:${r.size}`??"size:27"}get mapInventory(){let e=this.entity.getComponent("inventory").container,n=[];for(let r=0;r<e.size;r++){let o=e.getItem(r);n.push({uid:Xe(o),item:o})}return this.previousMap=n,n}onSlotChange(e){let n=this.page.slots[e.slot];if(!n)this.entity.runCommand(`replaceitem entity @s slot.inventory ${e.slot} air`);else{if(n.item&&pt(this.player,n.item),!n.item&&!ft(this.entity,e.slot))return;this.runItemAction(n,e)}this.previousMap=this.mapInventory}runItemAction(e,n){!e.action||e.action(new oe(this,e,n))}registerLoop(e){this.loops.push(e)}};import{Items as Xt,ItemStack as Jt,MinecraftEnchantmentTypes as Ne}from"mojang-minecraft";var u=class{static itemStackToItem(e,n={}){let r=e.getComponent("enchantments").enchantments,o=[];for(let i in Ne)!r.getEnchantment(Ne[i])||o.push(Ne[i]);return new u(e.id,e.amount,e.data,{nameTag:e.nameTag,lore:e.getLore(),enchantments:o})}constructor(e,n=1,r=0,o={},i){this.id=e,this.amount=n,this.data=r,this.components=o,this.itemStack=i||new Jt(Xt.get(this.id),n,r)}setComponents(e=this.components){if(this.components=e,e?.nameTag&&(this.itemStack.nameTag=e.nameTag),this.components?.lore&&this.itemStack.setLore(this.components.lore),e?.enchantments?.length>0){let n=this.itemStack.getComponent("enchantments").enchantments;for(let r of e.enchantments)n.addEnchantment(r);this.itemStack.getComponent("enchantments").enchantments=n}return this.itemStack}};var ae=class{};ae.Item=new u("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),ae.Action=e=>{e.BackAction()};var C=class{};C.Item=new u("minecraft:barrier",1,0,{nameTag:"\xA7cClose GUI"}),C.Action=e=>{e.CloseAction()};var Mo=new T("home",54,re).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,48,50,51,52,53],new u("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([22],new u("minecraft:ender_chest",1,0,{nameTag:"\xA7l\xA7bInventory Viewer"}),t=>{t.PageAction("moderation:see")}).setButtonAtSlot(49,C);_(t=>{if(Pe(t)?.id!=Ee)return;M[t.name]||(M[t.name]=new F(t))});Wt.events.tick.subscribe(()=>{for(let t of Object.values(M))if(!!t.entity?.id){try{if(t.entity.getComponent("minecraft:health").current<=0)return t.kill()}catch{t.kill()}if(Pe(t.player)?.id!=Ee||!t.player)return t.kill();t.entity.teleport(t.player.location,t.player.dimension,0,0)}});var l=class{constructor(e,n,r=0,o){this.data=e;this.type=n;this.depth=r;this.parent=o;e.requires||(e.requires=i=>!0),this.data=e,this.type=n??new N(this.data.name),this.children=[],this.depth=r,this.parent=o,this.callback=null,E.push(this)}argument(e){let n=new l(this.data,e,this.depth+1,this);return this.children.push(n),n}string(e){return this.argument(new Y(e))}int(e){return this.argument(new V(e))}array(e,n){return this.argument(new j(e,n))}boolean(e){return this.argument(new H(e))}location(e){let n=this.argument(new L(e));return e.endsWith("*")?n:n.location(e+"_y*").location(e+"_z*")}literal(e){let n=new l(e,new N(e.name),this.depth+1,this);return this.children.push(n),n}executes(e){return this.callback=e,this}};var x=class{constructor(e,n,r,o="No Reason",i="Smelly Anti Cheat"){n=n?z(`${n} ${r}`):null;let a={key:y(e),player:e.name,date:Date.now(),length:n,expire:n?n+Date.now():null,reason:o,by:i};s.bans.set(y(e),a)}};new l({name:"ban",description:"Bans a player for lengths",requires:t=>p(t)=="admin"}).argument(new h.player("player")).executes((t,e)=>{new x(e,null,null,t.sender.name),t.reply(I["modules.commands.ban.reply"](e.name,0,"Forever","No Reason"))}).argument(new h.int("length")).argument(new h.unit("unit")).executes((t,e,n,r)=>{new x(e,n,r,null,t.sender.name),t.reply(I["modules.commands.ban.reply"](e.name,n,r,"No Reason"))}).string("reason").executes((t,e,n,r,o)=>{new x(e,n,r,o,t.sender.name),t.reply(I["modules.commands.ban.reply"](e.name,n,r,o))});var D={aquaAffinity:1,baneOfArthropods:5,binding:1,blastProtection:4,channeling:1,depthStrider:3,efficiency:5,featherFalling:4,fireAspect:2,fireProtection:4,flame:1,fortune:3,frostWalker:2,impaling:5,infinity:1,knockback:2,looting:3,loyalty:4,luckOfTheSea:3,lure:3,mending:1,multishot:1,piercing:4,power:5,projectileProtection:4,protection:4,punch:2,quickCharge:3,respiration:3,riptide:3,sharpness:5,silkTouch:1,smite:5,soulSpeed:3,swiftSneak:4,thorns:3,unbreaking:3,vanishing:1};var J=["minecraft:beehive","minecraft:bee_nest","minecraft:acacia_standing_sign","minecraft:acacia_wall_sign","minecraft:agent_spawn_egg","minecraft:allay_spawn_egg","minecraft:allow","minecraft:axolotl_bucket","minecraft:axolotl_spawn_egg","minecraft:balloon","minecraft:bamboo_sapling","minecraft:barrier","minecraft:barrier","minecraft:bat_spawn_egg","minecraft:bedrock","minecraft:bee_nest","minecraft:bee_spawn_egg","minecraft:beehive","minecraft:birch_standing_sign","minecraft:birch_wall_sign","minecraft:blackstone_double_slab","minecraft:blaze_spawn_egg","minecraft:border_block","minecraft:brewingstandblock","minecraft:bubble_column","minecraft:camera","minecraft:carrots","minecraft:cat_spawn_egg","minecraft:cave_spider_spawn_egg","minecraft:cave_vines","minecraft:cave_vines_body_with_berries","minecraft:chain_command_block","minecraft:chemical_heat","minecraft:chemistry_table","minecraft:chicken_spawn_egg","minecraft:client_request_placeholder_block","minecraft:cobbled_deepslate_double_slab","minecraft:cod_bucket","minecraft:cod_spawn_egg","minecraft:colored_torch","minecraft:colored_torch_bp","minecraft:colored_torch_rg","minecraft:command_block","minecraft:command_block_minecart","minecraft:compound","minecraft:compoundcreator","minecraft:cow_spawn_egg","minecraft:creeper_spawn_egg","minecraft:crimson_double_slab","minecraft:crimson_standing_sign","minecraft:crimson_wall_sign","minecraft:darkoak_standing_sign","minecraft:darkoak_wall_sign","minecraft:daylight_detector_inverted","minecraft:debug_stick","minecraft:deepslate_brick_double_slab","minecraft:deepslate_tile_double_slab","minecraft:deny","minecraft:dolphin_spawn_egg","minecraft:donkey_spawn_egg","minecraft:double_cut_copper_slab","minecraft:double_wooden_slab","minecraft:drowned_spawn_egg","minecraft:elder_guardian_spawn_egg","minecraft:end_gateway","minecraft:end_portal","minecraft:end_portal_frame","minecraft:enderman_spawn_egg","minecraft:endermite_spawn_egg","minecraft:evoker_spawn_egg","minecraft:exposed_double_cut_copper_slab","minecraft:fire","minecraft:flowing_lava","minecraft:flowing_water","minecraft:fox_spawn_egg","minecraft:frog_spawn_egg","minecraft:frosted_ice","minecraft:ghast_spawn_egg","minecraft:glow_squid_spawn_egg","minecraft:glow_stick","minecraft:glowingobsidian","minecraft:goat_spawn_egg","minecraft:guardian_spawn_egg","minecraft:hard_glass","minecraft:hard_glass_pane","minecraft:hard_stained_glass","minecraft:hard_stained_glass_pane","minecraft:hoglin_spawn_egg","minecraft:horse_spawn_egg","minecraft:husk_spawn_egg","minecraft:ice_bomb","minecraft:info_update","minecraft:info_update2","minecraft:invisible_bedrock","minecraft:invisiblebedrock","minecraft:item.acacia_door","minecraft:item.bed","minecraft:item.beetroot","minecraft:item.birch_door","minecraft:item.cake","minecraft:item.campfire","minecraft:item.cauldron","minecraft:item.chain","minecraft:item.crimson_door","minecraft:item.dark_oak_door","minecraft:item.flower_pot","minecraft:item.frame","minecraft:item.glow_frame","minecraft:item.hopper","minecraft:item.iron_door","minecraft:item.jungle_door","minecraft:item.kelp","minecraft:item.nether_sprouts","minecraft:item.nether_wart","minecraft:item.reeds","minecraft:item.skull","minecraft:item.soul_campfire","minecraft:item.spruce_door","minecraft:item.warped_door","minecraft:item.wheat","minecraft:item.wooden_door","minecraft:jigsaw","minecraft:jungle_standing_sign","minecraft:jungle_wall_sign","minecraft:lava","minecraft:lava_cauldron","minecraft:light_block","minecraft:lit_blast_furnace","minecraft:lit_deepslate_redstone_ore","minecraft:lit_furnace","minecraft:lit_redstone_lamp","minecraft:lit_redstone_ore","minecraft:lit_smoker","minecraft:llama_spawn_egg","minecraft:magma_cube_spawn_egg","minecraft:medicine","minecraft:melon_stem","minecraft:mob_spawner","minecraft:mooshroom_spawn_egg","minecraft:movingBlock","minecraft:moving_block","minecraft:movingblock","minecraft:mule_spawn_egg","minecraft:netherreactor","minecraft:npc_spawn","minecraft:npc_spawn_egg","minecraft:ocelot_spawn_egg","minecraft:oxidized_double_cut_copper_slab","minecraft:panda_spawn_egg","minecraft:parrot_spawn_egg","minecraft:phantom_spawn_egg","minecraft:pig_spawn_egg","minecraft:piglin_brute_spawn_egg","minecraft:piglin_spawn_egg","minecraft:pillager_spawn_egg","minecraft:piston_arm_collision","minecraft:piston_arm_collision","minecraft:pistonarmcollision","minecraft:polar_bear_spawn_egg","minecraft:polished_blackstone_brick_double_slab","minecraft:polished_blackstone_double_slab","minecraft:polished_deepslate_double_slab","minecraft:portal","minecraft:potatoes","minecraft:powder_snow","minecraft:powder_snow_bucket","minecraft:powered_comparator","minecraft:powered_repeater","minecraft:pufferfish_bucket","minecraft:pufferfish_spawn_egg","minecraft:pumpkin_stem","minecraft:rabbit_spawn_egg","minecraft:rapid_fertilizer","minecraft:ravager_spawn_egg","minecraft:real_double_stone_slab","minecraft:real_double_stone_slab2","minecraft:real_double_stone_slab3","minecraft:real_double_stone_slab4","minecraft:redstone_wire","minecraft:repeating_command_block","minecraft:reserved3","minecraft:reserved4","minecraft:reserved6","minecraft:salmon_bucket","minecraft:salmon_spawn_egg","minecraft:sea_turtle_spawn_egg","minecraft:sheep_spawn_egg","minecraft:shulker_spawn_egg","minecraft:silverfish_spawn_egg","minecraft:skeleton_horse_spawn_egg","minecraft:skeleton_spawn_egg","minecraft:slime_spawn_egg","minecraft:soul_fire","minecraft:soul_fire","minecraft:sparkler","minecraft:spawn_egg","minecraft:spawn_egg","minecraft:spawner","minecraft:spider_spawn_egg","minecraft:spruce_standing_sign","minecraft:spruce_wall_sign","minecraft:squid_spawn_egg","minecraft:standing_banner","minecraft:standing_sign","minecraft:stickyPistonArmCollision","minecraft:sticky_piston_arm_collision","minecraft:stonecutter","minecraft:stray_spawn_egg","minecraft:strider_spawn_egg","minecraft:structure_block","minecraft:structure_void","minecraft:tadpole_bucket","minecraft:tadpole_spawn_egg","minecraft:tripwire","minecraft:tropical_fish_bucket","minecraft:tropical_fish_spawn_egg","minecraft:underwater_torch","minecraft:unknown","minecraft:unlit_redstone_ore","minecraft:unpowered_comparator","minecraft:unpowered_repeater","minecraft:vex_spawn_egg","minecraft:villager_spawn_egg","minecraft:vindicator_spawn_egg","minecraft:wall_banner","minecraft:wall_sign","minecraft:wandering_trader_spawn_egg","minecraft:warden_spawn_egg","minecraft:warped_double_slab","minecraft:warped_standing_sign","minecraft:warped_wall_sign","minecraft:water","minecraft:waxed_double_cut_copper_slab","minecraft:waxed_exposed_double_cut_copper_slab","minecraft:waxed_oxidized_double_cut_copper_slab","minecraft:waxed_weathered_double_cut_copper_slab","minecraft:weathered_double_cut_copper_slab","minecraft:witch_spawn_egg","minecraft:wither_spawn_egg","minecraft:wolf_spawn_egg","minecraft:zoglin_spawn_egg","minecraft:zombie_horse_spawn_egg","minecraft:zombie_spawn_egg","minecraft:zombie_villager_spawn_egg","minecraft:zombified_piglin_spawn_egg"],W=["minecraft:moving_block","minecraft:beehive","minecraft:beenest"],me=["minecraft:chest","minecraft:trapped_chest"],B={x:7,y:7,z:7};var Le=new l({name:"config",description:"Opens up a form to configure rubedo",requires:t=>p(t)=="admin"}),dt=Le.literal({name:"banned",description:"Manages banned items/blocks on this server"}),gt=dt.literal({name:"items",description:"Manages the banned items on this server"});gt.literal({name:"add",description:"Adds a item to the banned items list"}).string("item").executes((t,e)=>{let n=s.config.get("banned_items")??J;n.includes(e)||n.push(e),s.config.set("banned_items",n),t.reply(`Banned the item "${e}"`)});gt.literal({name:"remove",description:"Removes a item from the banned items list"}).string("item").executes((t,e)=>{let n=s.config.get("banned_items")??J;if(!n.includes(e))return t.reply(`item: "${e}" is not banned`);n=n.filter(r=>r!=e),s.config.set("banned_items",n),t.reply(`Removed Banned item "${e}"`)});var yt=dt.literal({name:"blocks",description:"Manages the banned blocks on this server"});yt.literal({name:"add",description:"Adds a block to the banned blocks list"}).string("block").executes((t,e)=>{let n=s.config.get("banned_blocks")??W;n.includes(e)||n.push(e),s.config.set("banned_blocks",e),t.reply(`Banned the block "${e}"`)});yt.literal({name:"remove",description:"Removes a block from the banned blocks list"}).string("block").executes((t,e)=>{let n=s.config.get("banned_blocks")??W;if(!n.includes(e))return t.reply(`block: "${e}" is not banned`);n=n.filter(r=>r!=e),s.config.set("banned_blocks",e),t.reply(`Removed Banned block "${e}"`)});var ht=Le.literal({name:"enchantments",description:"Manages the maxEnchants on this srrver"});ht.literal({name:"set",description:"Sets a enchantment to a level"}).array("enchantment",Object.keys(D)).int("level").executes((t,e,n)=>{let r=s.config.get("enchantments")??D;r[e]=n,s.config.set("enchantments",r),t.reply(`Set max level for ${e} to ${n}`)});ht.literal({name:"get",description:"Gets the max level for a enchantment"}).array("enchantment",Object.keys(D)).executes((t,e)=>{let n=s.config.get("enchantments")??D;t.reply(`Max level for ${e} is ${n[e]}`)});Le.literal({name:"setAppealLink",description:"Sets the appeal link for this server"}).string("link").executes((t,e)=>{s.config.set("appealLink",e),t.reply(`Changed the servers appeal link to ${e}`)});var Me=new l({name:"database",description:"Interacts with SA Database",aliases:["db"],requires:t=>p(t)=="admin"});Me.literal({name:"get"}).string("table").string("key").executes((t,e,n)=>{try{let r=s[e].get(n);r?t.reply(r):t.reply(`No data could be found for key ${n}`)}catch(r){t.reply(r+r.stack)}});Me.literal({name:"set"}).string("table").string("key").string("value").executes((t,e,n,r)=>{try{s[e].set(n,r),t.reply(`Set Key: "${n}", to value: "${r}" on table: "${e}"`)}catch(o){t.reply(o+o.stack)}});Me.literal({name:"clear"}).string("table").executes((t,e)=>{try{s[e].clear(),t.reply(`Cleared Table ${e}`)}catch(n){t.reply(n+n.stack)}});new l({name:"ecwipe",description:"Clears a players ender chest",requires:t=>p(t)=="admin"}).argument(new h.player("player")).executes((t,e)=>{for(let n=0;n<27;n++)e.runCommand(`replaceitem entity @s slot.enderchest ${n} air`);t.reply(`Cleared ${e.name} Ender chest!`)});var ce=class{constructor(e,n="No Reason"){let r={player:e.name,key:y(e),reason:n,location:{x:e.location.x,y:e.location.y,z:e.location.z,dimension:e.dimension.id}};s.freezes.set(y(e),r)}};new l({name:"freeze",description:"Freeze a player",requires:t=>p(t)=="admin"}).argument(new h.player("player")).string("reason").executes((t,e,n)=>{new ce(e,n),t.reply(`\xA7cFroze \xA7f"\xA7a${e.name}\xA7f" Because: "${n}" \xA7aSuccessfully`),t.sender.tell(`\xA7cYou have been frozen by \xA7f"\xA7a${t.sender.name}\xA7f" Because: "${n}"`)});var De=class{constructor(e){this.name=e;this.typeName="CommandName"}matches(e){return{success:Boolean(E.find(n=>n.depth==0&&n.data.name==e)),value:e}}};function Zt(t,e,n){n.tell(`${k}${t.data.name} ${e.map(r=>r.type.typeName=="literal"?r.data.name:`<${r.type.name}: ${r.type.typeName}>`).join(" ")}`)}function le(t,e,n,r){if(!e.data?.requires(r))return console.warn(`no perm ${e.data.name}`);if(e.callback&&Zt(t,e.depth==0?n:n.concat(e),r),e.children.length>0)for(let o of e.children)le(t,o,e.depth==0?n:n.concat(e),r)}function bt(t,e,n){t.tell({rawtext:[{text:`\xA72--- Showing help page ${e} of ${n} (${k}help <page: int>) ---`}]})}function _t(t){let e=E.filter(n=>n.depth==0&&n.data?.requires(t));return e.length==0?0:Math.ceil(e.length/5)}var It=new l({name:"help",description:"Provides help/list of commands.",aliases:["?","h"]}).executes(t=>{let e=_t(t.sender),n=E.filter(r=>r.depth==0&&r.data?.requires(t.sender)).slice(1*5-5,1*5);bt(t.sender,1,e);for(let r of n)le(r,r,[],t.sender)});It.int("page").executes((t,e)=>{let n=_t(t.sender);e>n&&(e=n);let r=E.filter(o=>o.depth==0&&o.data?.requires(t.sender)).slice(e*5-5,e*5);bt(t.sender,e,n);for(let o of r)le(o,o,[],t.sender)});It.argument(new De("command")).executes((t,e)=>{let n=E.filter(r=>r.depth==0&&r.data.name==e)[0];le(n,n,[],t.sender)});var R=class{static getMuteData(e){return s.mutes.get(e.name)}constructor(e,n,r,o="No Reason",i="Smelly Anti Cheat"){e.runCommand("ability @s mute true");let a=n?z(`${n} ${r}`):null,c={player:e.name,date:Date.now(),length:a,expire:a?a+Date.now():null,reason:o,by:i};s.mutes.set(e.name,c)}};new l({name:"mute",description:"Mute a player for lengths",requires:t=>["admin","moderator"].includes(p(t))}).argument(new h.player("player")).argument(new h.int("length")).argument(new h.unit("unit")).string("reason").executes((t,e,n,r,o)=>{new R(e,n,r,o,t.sender.name),t.reply(`\xA7cMuted \xA7f"\xA7a${e.name}\xA7f" \xA7cfor ${n} ${r} Because: "${o}" \xA7aSuccessfully`),e.tell(`\xA7cYou have been muted by \xA7f"${t.sender.name}" \xA7cfor ${n} ${r} Because: "${o}"`)});var U=class{static isVaild(e){if(e.id!="minecraft:npc")return!1;if(pe.find(r=>r.equals(e.location)))return!0;let n=y(e);return!!s.npcs.keys().find(r=>n==r)}constructor(e,n){pe.push(e);let r=n.spawnEntity("minecraft:npc",e),o={dimension:r.dimension.id,x:r.location.x,y:r.location.y,z:r.location.z};s.npcs.set(y(r),o),kt()}};new l({name:"npc",description:"Spawns a npc at your coordinates",requires:t=>p(t)=="admin"}).executes(t=>{new U(t.sender.location,t.sender.dimension),t.reply("Spawned a verifed npc at your current location")});import{world as wt}from"mojang-minecraft";new l({name:"ping",description:"Returns the current TPS of the servers ping"}).executes(t=>{let e=wt.events.tick.subscribe(({deltaTime:n})=>{t.reply(`Pong! Current TPS: ${1/n}`),wt.events.tick.unsubscribe(e)})});import{BlockLocation as Z}from"mojang-minecraft";var Q=new l({name:"region",description:"Create a Region",requires:t=>p(t)=="admin"});Q.literal({name:"add",description:"Adds a new protection region"}).int("from_x").int("from_z").int("to_x").int("to_z").executes((t,e,n,r,o)=>{new f({x:e,z:n},{x:r,z:o},t.sender.dimension.id),t.reply(`Created Region From ${e} -64 ${n} ${r} 320 ${o}`)});Q.literal({name:"remove",description:"Removes a region at the players current postion"}).executes(t=>{let e=new Z(t.sender.location.x,t.sender.location.y,t.sender.location.z);f.removeRegionAtBlockLocation(e,t.sender.dimension.id)?t.reply(`Removed Region at ${e.x} ${e.y} ${e.z}`):t.reply(`Failed to find/remove region at ${e.x} ${e.y} ${e.z}`)});Q.literal({name:"removeAll",description:"Removes all regions"}).executes(t=>{f.getAllRegions().forEach(e=>e.delete()),t.reply("Removed All regions")});Q.literal({name:"list",description:"Lists all regions and positions"}).executes(t=>{let e=f.getAllRegions();for(let n of e)t.reply(`Region from ${n.from.x}, ${n.from.z} to ${n.to.x}, ${n.to.z} in dimension ${n.dimensionId}`);if(e.length==0)return t.reply("No regions have been made yet")});var Be=Q.literal({name:"permission",description:"Handels permissions for regions"});Be.literal({name:"set",description:"Sets a certin permission on the region the player is currently in to a value"}).array("key",["doorsAndSwitches","openContainers","pvp"]).boolean("value").executes((t,e,n)=>{let r=f.blockLocationInRegion(new Z(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!r)return t.reply("You are not in a region");r.changePermission(e,n),t.reply(`Changed permision ${e} to ${n}`)});Be.literal({name:"list",description:"Lists the permissions for the current region"}).executes(t=>{let e=f.blockLocationInRegion(new Z(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!e)return t.reply("You are not in a region");t.reply(`Current region permissions ${JSON.stringify(e.permissions)}`)});var Ct=Be.literal({name:"entities",description:"Holds the subCommands for adding or removing allowedEntitys"});Ct.literal({name:"add",description:"Adds a entity to the allowed entitys list"}).string("entity").executes((t,e)=>{let n=f.blockLocationInRegion(new Z(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;r.push(e),n.changePermission("allowedEntitys",r),t.reply(`Added entity ${e} to the allowed entitys of the region your currently standing in`)});Ct.literal({name:"remove",description:"Removes a entity from the allowed entitys in the region"}).string("entity").executes((t,e)=>{let n=f.blockLocationInRegion(new Z(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;if(!r.includes(e))return t.reply(`The entity ${e} is not allowed to enter the region`);r=r.filter(o=>o!=e),n.changePermission("allowedEntitys",r),t.reply(`Removed entity ${e} to the allowed entitys of the region your currently standing in`)});import{world as Qt}from"mojang-minecraft";var $e=(o=>(o[o.member=0]="member",o[o.admin=1]="admin",o[o.moderator=2]="moderator",o[o.builder=3]="builder",o))($e||{});var en=t=>isNaN(Number(t))===!1;function tn(t){return Object.keys(t).filter(en).map(e=>t[e])}var Et=new l({name:"role",description:"Changes the role for a player",requires:t=>p(t)=="admin"||Qt.getDynamicProperty("worldsOwner")==y(t)});Et.literal({name:"set",description:"Sets the role for a player"}).string("playerName").argument(new h.array("role",tn($e))).executes((t,e,n)=>{at(e,n),t.reply(`Changed role of ${e} to ${n}`)});Et.literal({name:"get",description:"Gets the role of a player"}).string("playerName").executes((t,e)=>{t.reply(`${e} has role: ${p(e)}`)});import{world as vt}from"mojang-minecraft";new l({name:"vanish",description:"Toggles Vanish Mode on the sender",requires:t=>p(t)=="admin"}).boolean("say").executes((t,e)=>{if(t.sender.hasTag("spectator")){if(t.sender.runCommand("gamemode c"),t.sender.runCommand("event entity @s removeSpectator"),t.sender.removeTag("spectator"),!e)return;vt.say({rawtext:[{translate:"multiplayer.player.joined",with:[`\xA7e${t.sender.name}`]}]})}else{if(t.sender.runCommand("gamemode spectator"),t.sender.runCommand("event entity @s addSpectator"),t.sender.addTag("spectator"),!e)return;vt.say({rawtext:[{translate:"multiplayer.player.left",with:[`\xA7e${t.sender.name}`]}]})}});new l({name:"unban",description:"Unban a banned player",requires:t=>p(t)=="admin"}).string("playerName").executes((t,e)=>{let n=s.bans.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not banned`);s.bans.delete(n.key),t.reply(`\xA7a${e}\xA7r has been Unbanned!`)});new l({name:"unfreeze",description:"Unfreeze a frozen player",requires:t=>p(t)=="admin"}).string("playerName").executes((t,e)=>{let n=s.freezes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not frozen`);s.freezes.delete(n.key),t.reply(`\xA7a${e}\xA7r has been UnFrozen!`)});new l({name:"unmute",description:"Unmutes a muted player",requires:t=>["admin","moderator"].includes(p(t))}).string("playerName").executes((t,e)=>{let n=s.mutes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not muted!`);s.mutes.delete(n.player);try{t.sender.runCommand(`ability "${e}" mute false`)}catch{}t.reply(`\xA7a${e}\xA7r has been UnMuted!`)});var St="2.4.3-beta";var Tt="https://discord.gg/dMa3A5UYKX";new l({name:"version",description:"Get Current Version",aliases:["v"]}).executes(t=>{t.reply(`Current Rubedo Version: ${St}`)});_(t=>{try{let e=y(t),n=s.bans.get(e);if(!n)return;if(n.expire&&n.expire<Date.now())return s.bans.delete(e);se(t,["\xA7cYou have been banned!",`\xA7aReason: \xA7f${n.reason}`,`\xA7fExpiry: \xA7b${n.expire?z(n.length):"Forever"}`,`\xA7fAppeal at: \xA7b${s.config.get("appealLink")??Tt}`],()=>{s.bans.delete(e)})}catch(e){console.warn(e+e.stack)}},20);import{Location as nn}from"mojang-minecraft";_(t=>{let e=s.freezes.get(y(t));!e||t.teleport(new nn(e.location.x,e.location.y,e.location.z),A[e.location.dimension],0,0)},20);import{world as rn}from"mojang-minecraft";rn.events.beforeChat.subscribe(t=>{if(t.message.startsWith(k))return;let e=R.getMuteData(t.sender);if(!!e){if(e.expire&&e.expire<Date.now())return s.mutes.delete(t.sender.name);t.cancel=!0,t.sender.tell(I["modules.managers.mute.isMuted"]())}});import{BlockLocation as on,world as fe}from"mojang-minecraft";v(()=>{ie()},6e3);fe.events.beforeItemUseOn.subscribe(t=>{if(["moderator","admin"].includes(p(t.source)))return;let e=f.blockLocationInRegion(t.blockLocation,t.source.dimension.id);if(!e)return;let n=t.source.dimension.getBlock(t.blockLocation);nt.includes(n.id)&&e.permissions.doorsAndSwitches||rt.includes(n.id)&&e.permissions.openContainers||(t.cancel=!0)});fe.events.beforeExplosion.subscribe(t=>{for(let e=0;e<t.impactedBlocks.length;e++){let n=t.impactedBlocks[e];if(f.blockLocationInRegion(n,t.dimension.id))return t.cancel=!0}});fe.events.entityCreate.subscribe(t=>{let e=f.blockLocationInRegion(new on(t.entity.location.x,t.entity.location.y,t.entity.location.z),t.entity.dimension.id);!e||e.permissions.allowedEntitys.includes(t.entity.id)||(t.entity.teleport({x:0,y:-64,z:0},t.entity.dimension,0,0),t.entity.kill())});v(()=>{for(let t of f.getAllRegions())for(let e of fe.getDimension(t.dimensionId).getEntities({excludeTypes:t.permissions.allowedEntitys}))!t.entityInRegion(e)||(e.teleport({x:0,y:-64,z:0},e.dimension,0,0),e.kill())},100);_(t=>{for(let e of f.getAllRegions())e.entityInRegion(t)?(t.addTag("inRegion"),e.permissions.pvp||t.addTag("region-protected")):(t.removeTag("inRegion"),t.removeTag("region-protected"))},5);import{world as Oe}from"mojang-minecraft";Oe.events.playerJoin.subscribe(({player:t})=>{let e=Oe.events.tick.subscribe(n=>{try{A.overworld.runCommand(`testfor @a[name="${t.name}"]`),Oe.events.tick.unsubscribe(e),R.getMuteData(t)&&t.runCommand("ability @s mute true");let r=S.getPlayersRoleToSet(t.name);r&&t.setDynamicProperty("role",r)}catch{}})});import{MinecraftItemTypes as sn,world as ze}from"mojang-minecraft";var At=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],an=[10,11,12,13,14,15,16,19,20,21,22,23,24,25,28,29,30,31,32,33,34,37,38,39,40,41,42,43];function mn(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let o=0;o<r.size;o++){let i=e.slots[o];if(!i||!i.item){r.setItem(o,$);continue}r.setItem(o,i.item.setComponents())}for(let[o,i]of[...ze.getPlayers()].entries()){let a=At[o],c=new u("minecraft:skull",1,3,{nameTag:i.name});r.setItem(a,c.setComponents()),e.slots[a]={item:c,action:m=>{m.PageAction("moderation:see_inventory",{name:i.name})}}}}function cn(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let m=0;m<r.size;m++){let g=e.slots[m];if(!g||!g.item){r.setItem(m,$);continue}r.setItem(m,g.item.setComponents())}let o=new u("minecraft:ender_chest",1,0,{nameTag:`\xA7eView \xA7f${n?.name}\xA7e Ender Chest
\xA7fNote: \xA7cThis will not grab \xA7lANY NBT!\xA7r`});r.setItem(49,o.setComponents()),e.slots[49]={item:o,action:m=>{m.PageAction("moderation:see_ender_chest",{name:n.name})}};let i=[...ze.getPlayers()].find(m=>m.name==n.name);if(!i)return;let a=i.getComponent("inventory").container,c=0;for(let m=0;m<a.size;m++){let g=a.getItem(m);if(!g)continue;let b=At[c];c++,r.setItem(b,g),e.slots[b]={item:new u(g.id,g.amount,g.data,null,g),action:Lt=>{m<9?i.runCommand(`replaceitem entity @s slot.hotbar ${m} air`):i.runCommand(`replaceitem entity @s slot.inventory ${m-9} air`),Lt.GiveAction(),e.slots[b]={item:null,action:Mt=>{a.addItem(Mt.getItemAdded())}}}}}}function ln(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let a=0;a<r.size;a++){let c=e.slots[a];if(!c||!c.item){r.setItem(a,$);continue}r.setItem(a,c.item.setComponents())}let o=[...ze.getPlayers()].find(a=>a.name==n?.name);if(!o)return;let i=0;for(let a of Object.values(sn))try{o.runCommand(`testfor @s[hasitem={item=${a.id},location=slot.enderchest}]`);let c=new u(a.id,1,0,{nameTag:"Note: \xA7l\xA7cThis is not the exzact item"}),m=an[i];r.setItem(m,c.setComponents()),e.slots[m]={item:c,action:g=>{g.GiveAction(),e.slots[m]=null}},i++}catch{}}new T("moderation:see",54,mn).setSlots([45,46,47,49,51,52,53],new u("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([50],new u("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),t=>{t.PageAction("home")}).setButtonAtSlot(48,C);new T("moderation:see_inventory",54,cn).setSlots([45,46,47,49,51,52,53],new u("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([50],new u("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setButtonAtSlot(48,C);new T("moderation:see_ender_chest",54,ln).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,49,51,52,53],new u("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([50],new u("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setButtonAtSlot(48,C);import{ItemStack as yn,MinecraftItemTypes as hn,world as bn}from"mojang-minecraft";import{world as fn}from"mojang-minecraft";import{world as pn}from"mojang-minecraft";var P=class{constructor(){this.data=new Map,this.events={playerLeave:pn.events.playerLeave.subscribe(e=>this.data.delete(e.playerName))}}set(e,n){this.data.set(e.name,n)}get(e){return this.data.get(e.name)}delete(e){this.data.delete(e.name)}clear(){this.data.clear()}playerNames(){return[...this.data.keys()]}};var Ge={},xt=new P;function un(t,e){if(t.length!=e.length)return[];let n=[];for(let r=0;r<e.length;r++){if(t[r]?.item?.amount<e[r]?.item?.amount||t[r]?.item?.amount>e[r]?.item?.amount&&t[r]?.item?.amount!=0){n.push({slot:r,uid:e[r].uid,oldUid:t[r].uid,item:e[r].item,oldItem:t[r].item,moveType:"fluctuation"});continue}e[r].uid!=t[r].uid&&(t[r]?.item&&e[r]?.item?n.push({slot:r,uid:e[r].uid,oldUid:t[r].uid,item:e[r].item,oldItem:t[r].item,moveType:"swap"}):e[r]?.item?e[r]?.item&&n.push({slot:r,uid:e[r].uid,item:e[r].item,moveType:"put"}):n.push({slot:r,uid:t[r].uid,item:t[r].item,moveType:"delete"}))}return n}function dn(t){if(!t)return"";let e=[];return e.push(t.id),e.push(t.nameTag),e.push(t.data),e.push(t.getLore()),e.join("")}function gn(t){let e=[];for(let n=0;n<t.size;n++){let r=t.getItem(n);e[n]={uid:dn(r),item:r}}return e}v(()=>{for(let t of fn.getPlayers()){let e=gn(t.getComponent("inventory").container),n=un(xt.get(t)??e,e);if(xt.set(t,e),n.length!=0)for(let r of n)for(let o of Object.values(Ge))o(t,r)}},5);var ue=class{static subscribe(e){let n=Date.now();return Ge[n]=e,n}static unsubscribe(e){delete Ge[e]}};var _n=64,In=new yn(hn.stick,0),kn=32,wn=["minecraft:command_block_minecart"];ue.subscribe((t,e)=>{if(!["put","swap"].includes(e.moveType))return;let n=()=>t.getComponent("inventory").container.setItem(e.slot,In);if(e.item.amount>_n||(s.config.get("banned_items")??J).includes(e.item.id)||e.item.nameTag?.length>kn)return n();let o=e.item.getComponent("enchantments").enchantments,i=s.config.get("enchantments")??D,a=[];for(let c of o){let m=i[c.type.id]??c.type.maxLevel;if(o.slot==0&&!o.canAddEnchantment(c)||c.level>m||a.includes(c.type.id))return n();a.push(c.type.id)}});bn.events.entityCreate.subscribe(t=>{let e=()=>{try{t.entity.triggerEvent("despawn"),t.entity.kill()}catch{t.entity.kill()}};if(wn.includes(t.entity.id)||t.entity.id=="minecraft:npc"&&!U.isVaild(t.entity))return e()});var Fe=1e5;_(t=>{(Math.abs(t.location.x)>Fe||Math.abs(t.location.y)>Fe||Math.abs(t.location.z)>Fe)&&new x(t,null,null,"Hacking: Crasher")});import{world as de}from"mojang-minecraft";var ge=class{constructor(e,n,r){this.player=e,this.location=e.location,this.dimension=e.dimension,this.rotation=e.rotation,this.tick=n,this.storage=r,this.events={playerLeave:de.events.playerLeave.subscribe(({playerName:o})=>{o==this.player.name&&this.expire()})},this.storage.set(e,this)}back(){this.player.teleport(this.location,this.dimension,this.rotation.x,this.rotation.y)}update(){let e=de.events.tick.subscribe(n=>{this.tick=n.currentTick,de.events.tick.unsubscribe(e)});this.location=this.player.location,this.dimension=this.player.dimension,this.rotation=this.player.rotation}expire(){this.storage.delete(this.player);for(let e in this.events)de.events[e].unsubscribe(this.events[e])}};var Rt=new P,Cn=.9,En=20,vn=!0,Sn=["gliding","riding","levitating","swimming"];function Tn(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}_((t,{currentTick:e})=>{if(t.getTags().some(o=>Sn.includes(o)))return;let n=()=>Rt.get(t)??new ge(t,e,Rt),r=Math.sqrt(t.velocity.x**2+t.velocity.z**2);if(t.hasTag("on_ground"))return n().update();if(!(r<Cn)&&Tn(t)?.id!="minecraft:trident"&&!(e-n().tick<En)&&(n().back(),vn))try{t.runCommand("damage @s 4 fly_into_wall")}catch{}},20);import{GameMode as An,world as xn}from"mojang-minecraft";var Rn=An.creative;v(()=>{for(let t of xn.getPlayers({gameMode:Rn})){if(["moderator","admin","builder"].includes(p(t)))return;try{t.runCommand("gamemode s"),t.runCommand("clear @s")}catch{}}},20);import{world as Pt}from"mojang-minecraft";var Pn=/^([\p{L}])([\p{L}\d\s#'()-_]{1,20})([\p{L}\d\)])$/isu,Nn="\xA7c\xA7k\xA7m\xA7A\xA7r\xA7cToolbox Gamer\xA7k\xA7mA\xA7r";Pt.events.playerJoin.subscribe(({player:t})=>{let e=t.name,n=()=>se(t,["\xA7cYou have been kicked!",`\xA7aReason: \xA7f'${e}' is Invalid`,"\xA7fThis Server requires you to have a valid gamertag!"]);if(e==Nn||!Pn.test(e)||[...Pt.getPlayers()].filter(r=>r.name==t.name).length>1)return n()});import{world as Mn,Location as Dn}from"mojang-minecraft";import{world as Ln}from"mojang-minecraft";var ye=class{constructor(e){this.emptySlotsCount=e.emptySlotsCount,this.size=e.size,this.items=[];for(let n=0;n<this.size;n++)this.items[n]=e.getItem(n)}load(e){for(let n=0;n<e.size;n++)!this.items[n]||e.setItem(n,this.items[n])}};var he={};v(()=>{he={};for(let t of Ln.getPlayers()){let e=lt(t.location),n=e.offset(B.x,B.y,B.z),r=e.offset(-B.x,-B.y,-B.z);for(let o of n.blocksBetween(r)){if(o.y<-64)continue;let i=t.dimension.getBlock(o);!me.includes(i.id)||(he[JSON.stringify(o)]=new ye(i.getComponent("inventory").container))}}},100);var Nt=new P,Bn=70,$n=["snow","lush_plants_replaceable","azalea_log_replaceable","minecraft:crop","fertilize_area"],On=["minecraft:water","minecraft:flowing_water","minecraft:lava","minecraft:flowing_lava","minecraft:bedrock"];Mn.events.blockBreak.subscribe(({block:t,brokenBlockPermutation:e,dimension:n,player:r})=>{if(["moderator","admin"].includes(p(r))||t.getTags().some(i=>$n.includes(i)))return;let o=Nt.get(r);if(Nt.set(r,Date.now()),!!o&&!On.includes(t.id)&&!(o<Date.now()-Bn)){if(n.getBlock(t.location).setPermutation(e.clone()),me.includes(e.type.id)){let i=he[JSON.stringify(t.location)];i&&i.load(t.getComponent("inventory").container)}Se(()=>{[...n.getEntities({maxDistance:2,type:"minecraft:item",location:new Dn(t.location.x,t.location.y,t.location.z)})].forEach(i=>i.kill())},0)}});import{world as zn,MinecraftBlockTypes as Gn}from"mojang-minecraft";zn.events.blockPlace.subscribe(({block:t,player:e})=>{if(["moderator","admin"].includes(p(e)))return;(s.config.get("banned_blocks")??W).includes(t.id)&&t.setType(Gn.air)});import{MinecraftBlockTypes as Fn,world as be}from"mojang-minecraft";var Un=7;function ee(t,e){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2+(t.z-e.z)**2)>Un}be.events.beforeItemUseOn.subscribe(t=>{!ee(t.source.location,t.blockLocation)||(t.cancel=!0)});be.events.blockBreak.subscribe(t=>{!ee(t.player.location,t.block.location)||t.dimension.getBlock(t.block.location).setPermutation(t.brokenBlockPermutation)});be.events.blockPlace.subscribe(t=>{!ee(t.player.location,t.block.location)||t.dimension.getBlock(t.block.location).setType(Fn.air)});be.events.entityHit.subscribe(t=>{if(t.hitEntity){if(!ee(t.entity.location,t.hitEntity.location))return}else if(t.hitBlock){if(!ee(t.entity.location,t.hitBlock.location))return}else return});import{Player as Yn,world as te}from"mojang-minecraft";var Vn=te.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{if(te.getDynamicProperty("roleHasBeenSet"))return te.events.beforeDataDrivenEntityTriggerEvent.unsubscribe(Vn);t.entity instanceof Yn&&t.id=="rubedo:becomeAdmin"&&(t.entity.setDynamicProperty("role","admin"),s.roles.set(t.entity.name,"admin"),te.setDynamicProperty("roleHasBeenSet",!0),te.setDynamicProperty("worldsOwner",y(t.entity)),t.entity.tell("\xA7l\xA7cYou have been given admin, the function start will not work anymore!!!!"))});import{system as Hn}from"mojang-minecraft";Hn.events.beforeWatchdogTerminate.subscribe(t=>{t.cancel=!0,console.warn(`WATCHDOG TRIED TO CRASH = ${t.terminateReason}`)});import{DynamicPropertiesDefinition as Ue,EntityTypes as jn,MinecraftEntityTypes as qn,world as Kn}from"mojang-minecraft";Kn.events.worldInitialize.subscribe(({propertyRegistry:t})=>{ct("tickingarea add 0 0 0 0 0 0 db true");let e=new Ue;e.defineString("name",30),e.defineNumber("index"),t.registerEntityTypeDynamicProperties(e,jn.get(X));let n=new Ue;n.defineString("role",30),t.registerEntityTypeDynamicProperties(n,qn.player);let r=new Ue;r.defineBoolean("roleHasBeenSet"),r.defineString("worldsOwner",100),t.registerWorldDynamicProperties(r)});console.warn("STARTING RUBEDO");var pe=[];function kt(){pe=[]}var $=new Xn(Jn.stick,0);export{$ as AIR,pe as NPC_LOCATIONS,kt as clearNpcLocations};
/**
 * Minecraft Bedrock Anti Bad Blocks
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti block place stops players from placing unwanted blocks
 * Simpliy when a player places a blocks it tests if that block is banned
 * And cancles that block from being placed, (add more blocks to list)
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti CBE
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This is a anti hacked items, meaning it checks a players inventory every
 * tick then it tests if they have any banned items, then checks if they have
 * items that have hacked enchants and clears the item from inventory
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Crasher
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti crasher works by testing if a player has reached a location
 * Horion's crasher teleports the player to 30 Million so we just test for
 * That location and if they are there we kick the player (USES: player.json)
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Fly
 * @license MIT
 * @author Smell of curry
 * @author moisesgamingtv9
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti fly works by detecting horizontal velocity, bassicly when
 * the player has reached the FLYING_VELOCITY they are considered flying And
 * if they are considered flying for 1 second they will be teleported back.
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Gamemode
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This checks every tick to test if a player has entered a gamemode that they
 * shouldnet be able to get into. If the player has the staff tag it wont
 * check the list of illegle gamemodes are below
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti NameSpoof
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This is a anti Bad gamertag it checks when a player joins if there name is
 * invaild it determins its invalid by checking the length and characters in it
 * the requirememts are from xbox gamertag requiremnts
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Nuker
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti nuker works by loging everytime a player breaks a block
 * Then the next time they break a block it tests the time from now to then
 * And if they broke a block in 50 miliseconds than we place that block back
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Reach
 * @license MIT
 * @author Smell of curry
 * @author Visual1mpact
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * Detect players who are reaching and autmaticly cancel that action
 * Works with block placing, block interacting, block destroying, and hurting
 * entitys. tests by using 7 block max reach distance
 * --------------------------------------------------------------------------
 */
