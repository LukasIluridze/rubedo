import{ItemStack as ur,MinecraftItemTypes as gr,world as yr}from"@minecraft/server";import{world as un}from"@minecraft/server";var k="-";import{Location as fn}from"@minecraft/server";import{world as dn}from"@minecraft/server";import{BlockLocation as rn}from"@minecraft/server";var et=32e3,K="rubedo:database",Se=new rn(0,-64,0);import{ItemStack as cn,MinecraftItemTypes as ln}from"@minecraft/server";function tt(t,e){return t.match(new RegExp(".{1,"+e+"}","g"))}import{world as I,Player as sn,BlockLocation as Pe,MinecraftBlockTypes as mn,MinecraftDimensionTypes as z}from"@minecraft/server";var nt={doorsAndSwitches:!0,openContainers:!0,pvp:!1,allowedEntitys:["minecraft:player","minecraft:npc","minecraft:item"]},rt=["minecraft:acacia_door","minecraft:acacia_trapdoor","minecraft:acacia_button","minecraft:birch_door","minecraft:birch_trapdoor","minecraft:birch_button","minecraft:crimson_door","minecraft:crimson_trapdoor","minecraft:crimson_button","minecraft:dark_oak_door","minecraft:dark_oak_trapdoor","minecraft:dark_oak_button","minecraft:jungle_door","minecraft:jungle_trapdoor","minecraft:jungle_button","minecraft:mangrove_door","minecraft:mangrove_trapdoor","minecraft:mangrove_button","minecraft:spruce_door","minecraft:spruce_trapdoor","minecraft:spruce_button","minecraft:warped_door","minecraft:warped_trapdoor","minecraft:warped_button","minecraft:wooden_door","minecraft:wooden_button","minecraft:trapdoor","minecraft:iron_door","minecraft:iron_trapdoor","minecraft:polished_blackstone_button","minecraft:lever"],ot=["minecraft:chest","minecraft:ender_chest","minecraft:barrel","minecraft:trapped_chest","minecraft:dispenser","minecraft:dropper","minecraft:furnace","minecraft:blast_furnace","minecraft:lit_furnace","minecraft:lit_blast_furnace","minecraft:hopper","minecraft:shulker_box","minecraft:undyed_shulker_box"];var Ee=[],on=!1,it=-64,at=320;function st(t,e,n){return n.every((r,o)=>r>=Math.min(t[o],e[o])&&r<=Math.max(t[o],e[o]))}var u=class{static getAllRegions(){if(on)return Ee;let e=a.regions.values().map(n=>new u(n.from,n.to,n.dimensionId,n.permissions,n.key));return e.forEach(n=>{Ee.push(n)}),e}static blockLocationInRegion(e,n){return this.getAllRegions().find(r=>r.dimensionId==n&&st([r.from.x,it,r.from.z],[r.to.x,at,r.to.z],[e.x,e.y,e.z]))}static removeRegionAtBlockLocation(e,n){let r=this.blockLocationInRegion(e,n);return r?a.regions.delete(r.key):!1}constructor(e,n,r,o,i){this.from=e,this.to=n,this.dimensionId=r,this.permissions=o??nt,this.key=i||Date.now().toString(),i||(this.update(),de(),Ee.push(this))}update(){a.regions.set(this.key,{key:this.key,from:this.from,dimensionId:this.dimensionId,permissions:this.permissions,to:this.to})}delete(){return a.regions.delete(this.key)}entityInRegion(e){return this.dimensionId==e.dimension.id&&st([this.from.x,it,this.from.z],[this.to.x,at,this.to.z],[e.location.x,e.location.y,e.location.z])}changePermission(e,n){this.permissions[e]=n,this.update()}};var R=class{static getTasks(){return a.tasks.get("changePlayerRole")??[]}static getPlayersRoleToSet(e){return R.getTasks().find(r=>r.playerName==e)?.role}constructor(e,n){let r=R.getTasks();r.push({playerName:e,role:n}),a.tasks.set("changePlayerRole",r)}};import{MessageFormData as an}from"@minecraft/server-ui";var F=class{constructor(e,n){this.title=e,this.body=n,this.form=new an,e&&this.form.title(e),n&&this.form.body(n),this.triedToShow=0}setButton1(e,n){return this.button1={text:e,callback:n},this.form.button1(e),this}setButton2(e,n){return this.button2={text:e,callback:n},this.form.button2(e),this}show(e){this.form.show(e).then(n=>{if(n.canceled){if(n.cancelationReason=="userBusy"){if(this.triedToShow>200)return e.tell("\xA7cForm Timeout: tried to show form, but you were busy (close chat after running command)");this.triedToShow++,this.show(e)}return}n.selection==1&&this.button1?.callback?.(),n.selection==0&&this.button2?.callback?.()})}};var _={overworld:I.getDimension(z.overworld),nether:I.getDimension(z.nether),theEnd:I.getDimension(z.theEnd),"minecraft:overworld":I.getDimension(z.overworld),"minecraft:nether":I.getDimension(z.nether),"minecraft:the_end":I.getDimension(z.theEnd)};function B(t,e=[],n){if(Ae(t))return console.warn("[WARNING]: TRIED TO KICK OWNER"),t.tell("You have been tried to kick, but you cant!"),n?.();try{t.runCommand(`kick "${t.nameTag}" \xA7r${e.join(`
`)}`),t.triggerEvent("kick")}catch(r){if(!/"statusCode":-2147352576/.test(r))return;n&&n()}}function l(t){return t instanceof sn?a.roles.get(t.name)??"member":a.roles.get(t)??"member"}function G(t,e){if(typeof t=="string"){a.roles.set(t,e);let n=[...I.getPlayers()].find(r=>r.name==t);n?n.setDynamicProperty("role",e):new R(t,e)}else a.roles.set(t.name,e),t.setDynamicProperty("role",e)}function Ae(t){return I.getDynamicProperty("worldsOwner")==t.id}function fe(){return I.getDynamicProperty("isLockDown")??!1}function xe(t){I.setDynamicProperty("isLockDown",t)}function de(){for(let t of u.getAllRegions()){let e=new Pe(t.from.x,-64,t.from.z),n=new Pe(t.to.x,-64,t.to.z);for(let r of e.blocksBetween(n))_[t.dimensionId].getBlock(r)?.setType(mn.deny)}}var mt=[];function v(t,e=0){mt.push({callback:t,delay:e,lastCall:0})}I.events.tick.subscribe(t=>{let e=[...I.getPlayers()];for(let[n,r]of e.entries())if(!["moderator","admin"].includes(l(r)))for(let o of mt)o.delay!=0&&t.currentTick-o.lastCall<o.delay||(o.callback(r,t),n==e.length-1&&(o.lastCall=t.currentTick))});function ct(t,e="overworld",n=!1){try{return n?console.warn(JSON.stringify(this.runCommand(t))):_.overworld.runCommand(t)}catch{return{error:!0}}}function J(t){let e=t.split(",");console.warn(e.length);let n=0;for(let r of e){let o=parseInt(r.match(/\D+|\d+/g)[0]),i=r.match(/\D+|\d+/g)[1];i=="y"&&(n=n+317098e-16*o),i=="w"&&(n=n+6048e5*o),i=="d"&&(n=n+864e5*o),i=="h"&&(n=n+36e5*o),i=="m"&&(n=n+6e4*o),i=="s"&&(n=n+1e3*o),i=="ms"&&(n=n+o)}return n}function j(t){return new Date(t).toString()}function lt(t){return new Pe(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))}function pe(t,e,n,r=()=>{}){new F("Confirm To Continue",e).setButton1("Confirm",n).setButton2("Never Mind",r).show(t)}var g=class{static compress(e){return e}static decompress(e){return e}static createEntity(e,n){let r=_.overworld.spawnEntity(K,Se);r.setDynamicProperty("name",e),r.setDynamicProperty("index",n);let o=r.getComponent("inventory").container,i=new cn(ln.acaciaBoat,1);return n==0&&(i.nameTag="{}"),o.setItem(0,i),r}static getInventorySlotName(e,n){return e.getComponent("inventory").container.getItem(n)?.nameTag}static setInventorySlotName(e,n,r){let o=e.getComponent("inventory").container,i=o.getItem(n);return i.nameTag=r,o.setItem(n,i)}constructor(e){this.name=e,this.savedEntitys=void 0,this.MEMORY=void 0}get entitys(){if(this.savedEntitys)return this.savedEntitys;let e=_.overworld.getEntitiesAtBlockLocation(Se).filter(n=>n.typeId==K&&n.getDynamicProperty("name")==this.name);return this.savedEntitys=e,e}data(){if(this.MEMORY)return this.MEMORY;if(this.entitys.length==0&&g.createEntity(this.name,0),this.entitys.length==1){let n=JSON.parse(g.decompress(g.getInventorySlotName(this.entitys[0],0)));return this.MEMORY=n,n}let e=new Array(this.entitys.length);for(let n of this.entitys){let r=n.getDynamicProperty("index");e[r]=g.getInventorySlotName(n,0)}try{e=JSON.parse(e.join(""))}catch{e={}}return this.MEMORY=e,e}save(e){this.MEMORY=e;let n=tt(g.compress(JSON.stringify(e)),et);if(this.entitys&&n.length==this.entitys.length)for(let r=0;r<n.length;r++)g.setInventorySlotName(this.entitys[r],0,n[r]);else{this.entitys?.forEach(r=>r?.triggerEvent("despawn")),this.savedEntitys=void 0;for(let r=0;r<n.length;r++){let o=g.createEntity(this.name,r);g.setInventorySlotName(o,0,n[r])}}}set(e,n){let r=this.data();r[e]=n,this.save(r)}get(e){return this.data()[e]}has(e){return this.keys().includes(e)}delete(e){let n=this.data(),r=delete n[e];return this.save(n),r}size(){return this.keys().length}clear(){this.save({})}keys(){return Object.keys(this.data())}values(){return Object.values(this.data())}getCollection(){return this.data()}};var a={config:new g("config"),freezes:new g("freezes"),mutes:new g("mutes"),bans:new g("bans"),regions:new g("regions"),roles:new g("roles"),tasks:new g("tasks"),npcs:new g("npcs"),ids:new g("ids")};function dt(t){return[...dn.getPlayers()].find(e=>e.name===t)}var L=class{constructor(e="literal"){this.name=e;this.typeName="literal";this.name=e}matches(e){return{success:this.name==e}}fail(e){return`${e} should be ${this.name}!`}},X=class{constructor(e="string"){this.name=e;this.typeName="string";this.name=e}matches(e){return{success:e&&e!="",value:e}}fail(e){return"Value must be of type string!"}},Z=class{constructor(e="integer"){this.name=e;this.typeName="int";this.name=e}matches(e){return{success:!isNaN(e),value:parseInt(e)}}fail(e){return"Value must be vaild number!"}},Re=class{constructor(e="float"){this.name=e;this.typeName="float";this.name=e}matches(e){return{success:Boolean(e?.match(/^\d+\.\d+$/)?.[0]),value:parseInt(e)}}fail(e){return"Value must be vaild float!"}},$=class{constructor(e="location"){this.name=e;this.typeName="location";this.name=e}matches(e){return{success:/^([~^]{0,1}(-\d)?(\d*)?(\.(\d+))?)$/.test(e),value:e}}fail(e){return"Value needs to be a vaild number, value can include: [~,^]"}},Q=class{constructor(e="boolean"){this.name=e;this.typeName="boolean";this.name=e}matches(e){return{success:Boolean(e?.match(/^(true|false)$/)?.[0]),value:e=="true"}}fail(e){return`"${e}" can be either "true" or "false"`}},Ne=class{constructor(e="player"){this.name=e;this.typeName="playerName";this.name=e}matches(e){return{success:!!dt(e),value:dt(e)}}fail(e){return`player: "${e}", is not in this world`}},Be=class{constructor(e="target"){this.name=e;this.typeName="Target";this.name=e}matches(e){return{success:Boolean(e?.match(/^(@.|"[\s\S]+")$/)?.[0]),value:e}}fail(e){return`${e} is not a vaild target`}},ee=class{constructor(e="array",n){this.name=e;this.types=n;this.typeName="string";this.name=e,this.types=n,this.typeName=n.join(" | ").replace(/(.{25})..+/,"$1...")}matches(e){return{success:this.types.includes(e),value:e}}fail(e){return`"${e}" must be one of these values: ${this.types.join(" | ")}`}},Le=class{constructor(e){this.name=e;this.typeName="Duration"}matches(e){return{success:/^(\d+[hdysmw],?)+$/.test(e),value:e}}fail(e){return`"${e}" must be a value like "10d" or "3s" the first part is the length second is unit`}},De=class{constructor(e="playerName"){this.name=e;this.typeName="playerName";this.name=e}matches(e){return{success:!!a.ids.get(e),value:e}}fail(e){return`player: "${e}" has never played this world before! Tip: if the name has spaces in it use quotes around name!`}},h={string:X,int:Z,float:Re,location:$,boolean:Q,player:Ne,target:Be,array:ee,duration:Le,playerName:De};var ue=class{constructor(e){this.data=e,this.sender=e.sender}reply(e){this.sender.tell(e)}};function ft(t,e){return t.slice(e.length).trim().match(/"[^"]+"|[^\s]+/g).map(n=>n.replace(/"(.+)"/,"$1").toString())}function pt(t,e){t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.unknown",with:[`${e}`]}]})}function Me(t,e){t.tell({rawtext:[{text:e.data.invaildPermission?e.data.invaildPermission:`\xA7cYou do not have perrmission to use "${e.data.name}"`}]})}function ut(t,e,n,r,o){if(t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.syntax",with:[`${k}${e.data.name} ${r.slice(0,o).join(" ")}`,r[o]??" ",r.slice(o+1).join(" ")]}]}),n.children.length>1||!r[o]){let i=n.children.map(m=>m.type instanceof L?m.type.name:m.type?.typeName);t.tell(`\xA7c"${r[o]??"undefined"}" is not vaild! Argument "${[...new Set(n.children.map(m=>m.type.name))][0]}" can be typeof: "${i.join('", "')}"`)}else t.tell(`\xA7c${n.children[0]?.type?.fail(r[o])}`)}function pn([t,e,n],{location:r,viewVector:o}){if(!t||!e||!t)return null;let i=[r.x,r.y,r.z],m=[o.x,o.y,o.z],s=[t,e,n].map(p=>{let f=parseInt(p.replace(/\D/g,""));return isNaN(f)?0:f}),c=[t,e,n].map((p,f)=>p.includes("~")?s[f]+i[f]:p.includes("^")?s[f]+m[f]:s[f]);return new fn(c[0],c[1],c[2])}function gt(t,e,n,r){let o=e[e.length-1]??r,i=[];for(let[m,s]of e.entries())if(!s.type.name.endsWith("*")){if(s.type instanceof $){i.push(pn([t[m],t[m+1],t[m+2]],n.sender));continue}s.type instanceof L||i.push(s.type.matches(t[m]).value??t[m])}o.callback(new ue(n),...i)}var N=[];un.events.beforeChat.subscribe(t=>{if(!t.message.startsWith(k))return;t.cancel=!0;let e=ft(t.message,k),n=N.find(i=>i.depth==0&&(i.data.name==e[0]||i.data?.aliases?.includes(e[0])));if(!n)return pt(t.sender,e[0]);if(!n.data?.requires(t.sender))return Me(t.sender,n);e.shift();let r=[],o=(i,m)=>{if(i.children.length>0){let s=i.children.find(c=>c.type.matches(e[m]).success);return!s&&!e[m]&&i.callback?void 0:s?s.data?.requires(t.sender)?(r.push(s),o(s,m+1)):(Me(t.sender,s),"fail"):(ut(t.sender,n,i,e,m),"fail")}};o(n,0)||gt(e,r,t,n)});import{Player as wn,world as ze}from"@minecraft/server";var yt="rubedo:gui",te="rubedo:inventory";import{world as ht}from"@minecraft/server";var bt=new Map,ne=class{constructor(e,n,r=!1,o=Date.now()){this.callbackTick=null,this.tickDelay=n,this.loop=r,this.callback=e,this.id=o,bt.set(o,this),this.TickCallBack=ht.events.tick.subscribe(({currentTick:i})=>{if(this.callbackTick||(this.callbackTick=i+this.tickDelay),!(this.callbackTick>i)){if(this.callback(i),!this.loop)return this.expire();this.callbackTick=i+this.tickDelay}})}expire(){ht.events.tick.unsubscribe(this.TickCallBack),bt.delete(this.id)}};var _t=t=>new Promise(e=>$e(e,t));function $e(t,e){new ne(t,e)}function E(t,e){return new ne(t,e,!0)}import{world as Ct}from"@minecraft/server";var Oe={},wt={},D={};function gn(t,e,n){if(e.length!=n.length)return[];let r=[];for(let o=0;o<n.length;o++){if(e[o]?.item?.amount<n[o]?.item?.amount||e[o]?.item?.amount>n[o]?.item?.amount&&e[o]?.item?.amount!=0){let i={slot:o,uid:n[o].uid,oldUid:e[o].uid,item:n[o].item,oldItem:e[o].item,changeType:"fluctuation"};r.push(i),D[t.id]=i;continue}if(n[o].uid!=e[o].uid)if(e[o]?.item&&n[o]?.item){let i={slot:o,uid:n[o].uid,oldUid:e[o].uid,item:n[o].item,oldItem:e[o].item,changeType:"swap"};r.push(i),D[t.id]=i}else if(n[o]?.item){if(n[o]?.item)if(D[t.id]?.changeType=="delete"&&D[t.id]?.uid==n[o].uid){let i={slot:o,uid:n[o].uid,item:n[o].item,changeType:"move"};r.push(i),D[t.id]=i;continue}else{let i={slot:o,uid:n[o].uid,item:n[o].item,changeType:"put"};r.push(i),D[t.id]=i}}else{let i={slot:o,uid:e[o].uid,item:e[o].item,changeType:"delete"};r.push(i),D[t.id]=i}}return r}function yn(t){if(!t)return"";let e=[];return e.push(t.typeId),e.push(t.nameTag),e.push(t.data),e.push(t.getLore().join("")),e.join("")}function hn(t){let e=[];for(let n=0;n<t.size;n++){let r=t.getItem(n);e[n]={uid:yn(r),item:r}}return e}E(()=>{for(let t of Object.values(Oe))for(let e of _.overworld.getEntities(t.entities)){let n=hn(e.getComponent("inventory").container),r=gn(e,wt[e.id]??n,n);if(wt[e.id]=n,r.length!=0){if(e.hasTag("skipCheck")){e.removeTag("skipCheck"),delete D[e.id];continue}for(let o of r)t.callback(e,o)}}},5);var re=class{static subscribe(e,n){let r=Date.now();return Oe[r]={callback:n,entities:e},r}static unsubscribe(e){delete Oe[e]}};import{world as bn}from"@minecraft/server";var b=class{constructor(){this.data=new Map,this.events={playerLeave:bn.events.playerLeave.subscribe(e=>this.data.delete(e.playerName))}}set(e,n){this.data.set(e.name,n)}get(e){return this.data.get(e.name)}delete(e){this.data.delete(e.name)}clear(){this.data.clear()}playerNames(){return[...this.data.keys()]}};var P={},V={},oe=new b;function kt(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}async function It(t,e){try{let n=t.getComponent("minecraft:inventory").container,r=[];for(let o=0;o<n.size;o++){let i=n.getItem(o);!i||i?.typeId==e?.typeId&&(r.push({slot:o,item:i}),n.setItem,o<9?t.runCommand(`replaceitem entity @s slot.hotbar ${o} air`):t.runCommand(`replaceitem entity @s slot.inventory ${o-9} air`))}t.runCommand(`clear @s ${e?.typeId} ${e.data} ${e.amount}`);for(let o of r)n.setItem(o.slot,o.item)}catch{[...t.dimension.getEntities({type:"minecraft:item",location:t.location,maxDistance:2,closest:1})].forEach(r=>r.kill())}}function vt(t,e){return t.getComponent("minecraft:inventory").container.getItem(e)}var ge=class{constructor(e,n,r){this.gui=e,this.slot=n,this.change=r}message(e){this.gui.player.tell(e)}getItemAdded(){return this.slot.item?null:this.gui.entity.getComponent("minecraft:inventory").container.getItem(this.change.slot)}GiveAction(e=this.slot.item.itemStack){this.gui.player.getComponent("minecraft:inventory").container.addItem(e)}TakeAction(e=null){this.gui.player.getComponent("minecraft:inventory").container.addItem(this.slot.item.itemStack),this.gui.page.slots[this.change.slot]=null,e&&e.delete(this.slot.item.components.dbKey)}PageAction(e,n){this.gui.setPage(e,n)}CloseAction(){this.gui.despawn()}SetAction(){this.gui.entity.getComponent("minecraft:inventory").container.setItem(this.change.slot,this.slot.item.itemStack)}async FormAction(e){return this.CloseAction(),await _t(5),await e.show(this.gui.player)}};var U=class{static spawnEntity(e){try{return e.dimension.spawnEntity(te,e.headLocation)}catch{return null}}constructor(e){this.player=e,this.entity=U.spawnEntity(e),this.entity&&(this.hasChestOpen=!1,this.setPage("home")),this.tickEvent=Ct.events.tick.subscribe(()=>{if(!this.entity)return this.despawn();if(oe.get(this.player))this.hasChestOpen||(this.slotChangeEvent=re.subscribe({type:te},(n,r)=>{n.id==this.entity.id&&this.onSlotChange(r)})),this.hasChestOpen=!0;else try{this.entity.teleport(this.player.headLocation,this.player.dimension,this.player.rotation.x,this.player.rotation.y,!0)}catch{this.despawn()}})}setPage(e,n){let r=this.entity.getComponent("inventory").container;for(let i=0;i<r.size;i++)r.setItem(i,A);if(!Object.keys(V).includes(e))throw new Error(`pageId ${e} does not exist!`);let o=V[e];this.page=o,o.fillType(this.entity,o,n),this.entity.nameTag="size:54"}onSlotChange(e){let n=this.page.slots[e.slot];if(!n)this.entity.getComponent("inventory").container.setItem(e.slot,A);else if(e.changeType=="delete"){if(n.item&&It(this.player,e.item),!n.item&&!vt(this.entity,e.slot))return;n.action(new ge(this,n,e))}}despawn(){try{this.entity?.triggerEvent("despawn")}catch{}try{delete P[this.player.name]}catch{}this.tickEvent&&Ct.events.tick.unsubscribe(this.tickEvent),this.slotChangeEvent&&re.unsubscribe(this.slotChangeEvent)}};import{ItemStack as _n}from"@minecraft/server";var y=class{constructor(e,n={},r){this.itemType=e,this.components=n,this.setItemStack=r}get itemStack(){if(this.setItemStack)return this.setItemStack;let e=new _n(this.itemType);if(this.components){e.amount=this.components?.amount??1,e.data=this.components?.data??0,e.nameTag=this.components?.nameTag,e.setLore(this.components?.loreList??[]);let n=e.getComponent("enchantments").enchantments;for(let r of this.components?.enchantments??[])n.addEnchantment(r);e.getComponent("enchantments").enchantments=n}return e}};function Tt(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let o=0;o<r.size;o++){let i=e.slots[o];if(!i||!i.item){r.setItem(o,A);continue}r.setItem(o,i.item.itemStack)}}var M=class{constructor(e,n=Tt){if(Object.keys(V).includes(e))throw new Error(`Page: ${e}, Already exists!`);this.id=e,this.fillType=n,this.slots=[],V[e]=this}setSlots(e,n,r){let o=n?{item:n,action:r}:null;for(let i of e)this.slots[i]=o;return this}};import{MinecraftItemTypes as Fe}from"@minecraft/server";var ei=new M("home").setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,48,50,51,52,53],new y(Fe.stainedGlassPane,{data:15,nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([22],new y(Fe.enderChest,{nameTag:"\xA7l\xA7bInventory Viewer"}),t=>{t.PageAction("moderation:see")}).setSlots([54],new y(Fe.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});ze.events.tick.subscribe(t=>{for(let e of ze.getPlayers()){if(kt(e)?.typeId!=yt){P[e.name]&&P[e.name].despawn();continue}Object.keys(P).includes(e?.name)||(P[e.name]=new U(e))}});ze.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{t.entity instanceof wn&&(t.id=="rubedo:has_container_open"?oe.set(t.entity,!0):t.id=="rubedo:dosent_have_container_open"&&oe.set(t.entity,!1))});E(()=>{let t=Object.values(P).map(e=>e.entity.id);for(let e of _.overworld.getEntities({type:te}))t.includes(e.id)||e.triggerEvent("despawn")},100);var w={"api.name":()=>"Smelly API","api.error.unknown":()=>"An unknown error has occured.","api.database.error.table_name":(t,e)=>`The display name ${t} is too long for an objective, it can be at most ${e} characters long`,"api.utilities.formatter.error.ms":t=>`${t} is not a string or a number`,"api.Providers.form.invaildtype":(t,e)=>`Type ${t} is not a vaild type to add a ${e}`,"api.Providers.form.invaildFormtype":(t,e)=>{`${t}${JSON.stringify(e)}`},"api.ChestGUI.error.pagenotfound":t=>`Page ${t} not found!`,"modules.protections.cps.clickingToFast":()=>"You are clicking to fast! Please click slower!","modules.managers.mute.isMuted":()=>"You are muted and cannot send messages please try again later","modules.commands.ban.reply":(t,e,n="")=>`\xA7cBanned \xA7f"\xA7a${t}\xA7f" \xA7cfor ${e} Because: "${n??"No reason Provided"}" \xA7aSuccessfully`,"lockdown.kick.message":()=>["\xA7cYou have been kicked!","\xA7aReason: \xA7fServer is currently under LockDown","\xA7fServer will be up soon, Try to join later"],"commands.ban.list.player":(t,e,n)=>`- "${t}" Because: ${e}, Expiry ${n}`,"commands.freeze.list.player":(t,e)=>`- "${t}" Because: ${e}`,"commands.mutes.list.player":(t,e,n)=>`- "${t}" Because: ${e}, Expiry: ${n}`,"commands.lockdown.confirm":"Are you sure you want to lockdown the server, this will kick all active players and all players who try to join who are not admin"};var d=class{constructor(e,n,r=0,o){this.data=e;this.type=n;this.depth=r;this.parent=o;e.requires||(e.requires=i=>!0),this.data=e,this.type=n??new L(this.data.name),this.children=[],this.depth=r,this.parent=o,this.callback=null,N.push(this)}argument(e){let n=new d(this.data,e,this.depth+1,this);return this.children.push(n),n}string(e){return this.argument(new X(e))}int(e){return this.argument(new Z(e))}array(e,n){return this.argument(new ee(e,n))}boolean(e){return this.argument(new Q(e))}location(e){let n=this.argument(new $(e));return e.endsWith("*")?n:n.location(e+"_y*").location(e+"_z*")}literal(e){let n=new d(e,new L(e.name),this.depth+1,this);return this.children.push(n),n}executes(e){return this.callback=e,this}};import{Player as St}from"@minecraft/server";var C=class{constructor(e,n,r="No Reason",o="Smelly Anti Cheat"){let i=e instanceof St?e.id:a.ids.get(e);if(!i)throw new Error(`"${e}" does not have a saved id!`);let m={key:i,playerName:e instanceof St?e.name:e,date:Date.now(),duration:n?J(n):null,expire:n?J(n)+Date.now():null,reason:r,by:o};a.bans.set(i,m)}};function Ge(t,e,n,r,o){if(a.bans.get(a.ids.get(e)))return t.reply(`\xA7c${e} is already banned`);t.reply("\xA7aClose chat to confirm"),pe(t.sender,`Are you sure you want to ban ${e}, for ${n??"forever"}`,()=>{new C(e,n,r,t.sender.name),t.reply(w["modules.commands.ban.reply"](e,n,r))})}var je=new d({name:"ban",description:"Manage bans",requires:t=>l(t)=="admin"});je.literal({name:"add",description:"Bans a player"}).argument(new h.playerName).executes((t,e)=>{Ge(t,e,null,null,t.sender.name)}).argument(new h.duration("duration")).executes((t,e,n)=>{Ge(t,e,n,null,t.sender.name)}).string("reason").executes((t,e,n,r)=>{Ge(t,e,n,r,t.sender.name)});je.literal({name:"remove",description:"unbans a player"}).argument(new h.playerName("playerName")).executes((t,e)=>{let n=a.bans.values().find(r=>r.playerName==e);if(!n)return t.reply(`${e} is not banned`);a.bans.delete(n.key)?t.reply(`\xA7a${e}\xA7r has been Unbanned!`):t.reply(`\xA7cFailed to unban ${e}`)});je.literal({name:"list",description:"Lists all bans"}).executes(t=>{let e=a.bans.values();if(e.length==0)return t.sender.tell("\xA7cNo one is banned!");t.sender.tell(`\xA72--- Showing Bans (${e.length}) ---`);for(let n of e)t.sender.tell(w["commands.ban.list.player"](n.playerName,n.reason,n.expire?j(n.duration):"Forever"))});var Ve=new d({name:"database",description:"Interacts with SA Database",aliases:["db"],requires:t=>l(t)=="admin"});Ve.literal({name:"get"}).string("table").string("key").executes((t,e,n)=>{try{let r=a[e].get(n);r?t.reply(r):t.reply(`No data could be found for key ${n}`)}catch(r){t.reply(r+r.stack)}});Ve.literal({name:"set"}).string("table").string("key").string("value").executes((t,e,n,r)=>{try{a[e].set(n,r),t.reply(`Set Key: "${n}", to value: "${r}" on table: "${e}"`)}catch(o){t.reply(o+o.stack)}});Ve.literal({name:"clear"}).string("table").executes((t,e)=>{try{a[e].clear(),t.reply(`Cleared Table ${e}`)}catch(n){t.reply(n+n.stack)}});new d({name:"ecwipe",description:"Clears a players ender chest",requires:t=>l(t)=="admin"}).argument(new h.player("player")).executes((t,e)=>{for(let n=0;n<27;n++)e.runCommand(`replaceitem entity @s slot.enderchest ${n} air`);t.reply(`Cleared ${e.name} Ender chest!`)});var ye=class{constructor(e,n="No Reason"){let r={player:e.name,key:e.id,reason:n,location:{x:e.location.x,y:e.location.y,z:e.location.z,dimension:e.dimension.id}};a.freezes.set(e.id,r)}};var Ue=new d({name:"freeze",description:"Manage Freezes",requires:t=>l(t)=="admin"});Ue.literal({name:"add",description:"Freezes a player"}).argument(new h.player("player")).string("reason").executes((t,e,n)=>{new ye(e,n),t.reply(`\xA7cFroze \xA7f"\xA7a${e.name}\xA7f" Because: "${n}" \xA7aSuccessfully`),t.sender.tell(`\xA7cYou have been frozen by \xA7f"\xA7a${t.sender.name}\xA7f" Because: "${n}"`)});Ue.literal({name:"remove",description:"unfreezes a player"}).argument(new h.playerName("playerName")).executes((t,e)=>{let n=a.freezes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not frozen`);a.freezes.delete(n.key),t.reply(`\xA7a${e}\xA7r has been UnFrozen!`)});Ue.literal({name:"list",description:"Lists all freezes"}).executes(t=>{let e=a.freezes.values();if(e.length==0)return t.sender.tell("\xA7cNo one is frozen!");t.sender.tell(`\xA72--- Showing Freezes (${e.length}) ---`);for(let n of e)t.sender.tell(w["commands.freeze.list.player"](n.player,n.reason))});var He=class{constructor(e){this.name=e;this.typeName="CommandName"}matches(e){return{success:Boolean(N.find(n=>n.depth==0&&n.data.name==e)),value:e}}fail(e){return`"${e}" is not a vaild command`}};function kn(t,e,n){n.tell(`${k}${t.data.name} ${e.map(r=>r.type.typeName=="literal"?r.data.name:`<${r.type.name}: ${r.type.typeName}>`).join(" ")}`)}function he(t,e,n,r){if(!!e.data?.requires(r)&&(e.callback&&kn(t,e.depth==0?n:n.concat(e),r),e.children.length>0))for(let o of e.children)he(t,o,e.depth==0?n:n.concat(e),r)}function Et(t,e,n){t.tell(`\xA72--- Showing help page ${e} of ${n} (${k}help <page: int>) ---`)}function Pt(t){let e=N.filter(n=>n.depth==0&&n.data?.requires(t));return e.length==0?0:Math.ceil(e.length/5)}var At=new d({name:"help",description:"Provides help/list of commands.",aliases:["?","h"]}).executes(t=>{let e=Pt(t.sender),n=N.filter(r=>r.depth==0&&r.data?.requires(t.sender)).slice(1*5-5,1*5);Et(t.sender,1,e);for(let r of n)he(r,r,[],t.sender)});At.int("page").executes((t,e)=>{let n=Pt(t.sender);e>n&&(e=n);let r=N.filter(o=>o.depth==0&&o.data?.requires(t.sender)).slice(e*5-5,e*5);Et(t.sender,e,n);for(let o of r)he(o,o,[],t.sender)});At.argument(new He("command")).executes((t,e)=>{let n=N.filter(r=>r.depth==0&&r.data.name==e)[0];t.sender.tell(`\xA7e${n.data.name}: ${n.data.aliases?`aliases (${n.data.aliases.join(", ")})`:""}`),t.sender.tell(`\xA7e${n.data.description}`),t.sender.tell("Usage:"),he(n,n,[],t.sender)});import{world as xt}from"@minecraft/server";new d({name:"lockdown",description:"Toggles the servers lockdown, meaning noone can join",requires:t=>l(t)=="admin"}).executes(t=>{fe()?(xe(!1),t.sender.tell("Unlocked the server!")):(t.reply("\xA7aClose chat to confirm lockdown"),pe(t.sender,w["commands.lockdown.confirm"],()=>{xe(!0);for(let e of xt.getPlayers())l(e)!="admin"&&B(e,w["lockdown.kick.message"]());xt.say("\xA7l\xA7cServer is now LOCKED!")}))});var x=class{static getMuteData(e){return a.mutes.get(e.name)}constructor(e,n,r="No Reason",o="Smelly Anti Cheat"){let i=n?J(n):null,m={player:e.name,date:Date.now(),duration:i,expire:i?i+Date.now():null,reason:r,by:o};a.mutes.set(e.name,m)}};var Ye=new d({name:"mute",description:"Manage Mutes",requires:t=>["admin","moderator"].includes(l(t))});Ye.literal({name:"add",description:"Mutes a player"}).argument(new h.player("player")).argument(new h.duration("duration")).string("reason").executes((t,e,n,r)=>{new x(e,n,r,t.sender.name),t.reply(`\xA7cMuted \xA7f"\xA7a${e.name}\xA7f" \xA7cfor ${n} Because: "${r}" \xA7aSuccessfully`),e.tell(`\xA7cYou have been muted by \xA7f"${t.sender.name}" \xA7cfor ${n} Because: "${r}"`)});Ye.literal({name:"remove",description:"unmutes a player"}).argument(new h.playerName("playerName")).executes((t,e)=>{let n=a.mutes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not muted!`);a.mutes.delete(n.player);try{t.sender.runCommand(`ability "${e}" mute false`)}catch{}t.reply(`\xA7a${e}\xA7r has been UnMuted!`)});Ye.literal({name:"list",description:"Lists all feeezes"}).executes(t=>{let e=a.mutes.values();if(e.length==0)return t.sender.tell("\xA7cNo one is muted!");t.sender.tell(`\xA72--- Showing Mutes (${e.length}) ---`);for(let n of e)t.sender.tell(w["commands.mutes.list.player"](n.player,n.reason,n.expire?j(n.expire):"Forever"))});var H=class{static isVaild(e){return e.typeId!="minecraft:npc"?!1:be.find(n=>n.equals(e.location))?!0:!!a.npcs.keys().find(n=>e.id==n)}constructor(e,n){be.push(e);let r=n.spawnEntity("minecraft:npc",e),o={dimension:r.dimension.id,x:r.location.x,y:r.location.y,z:r.location.z};a.npcs.set(r.id,o),Rt()}};new d({name:"npc",description:"Spawns a npc at your coordinates",requires:t=>l(t)=="admin"}).executes(t=>{new H(t.sender.location,t.sender.dimension),t.reply("Spawned a verifed npc at your current location")});import{world as Nt}from"@minecraft/server";new d({name:"ping",description:"Returns the current TPS of the servers ping"}).executes(t=>{let e=Nt.events.tick.subscribe(({deltaTime:n})=>{t.reply(`Pong! Current TPS: ${1/n}`),Nt.events.tick.unsubscribe(e)})});import{BlockLocation as ie}from"@minecraft/server";var ae=new d({name:"region",description:"Create a Region",requires:t=>l(t)=="admin"});ae.literal({name:"add",description:"Adds a new protection region"}).int("from_x").int("from_z").int("to_x").int("to_z").executes((t,e,n,r,o)=>{new u({x:e,z:n},{x:r,z:o},t.sender.dimension.id),t.reply(`Created Region From ${e} -64 ${n} ${r} 320 ${o}`)});ae.literal({name:"remove",description:"Removes a region at the players current postion"}).executes(t=>{let e=new ie(t.sender.location.x,t.sender.location.y,t.sender.location.z);u.removeRegionAtBlockLocation(e,t.sender.dimension.id)?t.reply(`Removed Region at ${e.x} ${e.y} ${e.z}`):t.reply(`Failed to find/remove region at ${e.x} ${e.y} ${e.z}`)});ae.literal({name:"removeAll",description:"Removes all regions"}).executes(t=>{u.getAllRegions().forEach(e=>e.delete()),t.reply("Removed All regions")});ae.literal({name:"list",description:"Lists all regions and positions"}).executes(t=>{let e=u.getAllRegions();for(let n of e)t.reply(`Region from ${n.from.x}, ${n.from.z} to ${n.to.x}, ${n.to.z} in dimension ${n.dimensionId}`);if(e.length==0)return t.reply("No regions have been made yet")});var qe=ae.literal({name:"permission",description:"Handels permissions for regions"});qe.literal({name:"set",description:"Sets a certin permission on the region the player is currently in to a value"}).array("key",["doorsAndSwitches","openContainers","pvp"]).boolean("value").executes((t,e,n)=>{let r=u.blockLocationInRegion(new ie(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!r)return t.reply("You are not in a region");r.changePermission(e,n),t.reply(`Changed permision ${e} to ${n}`)});qe.literal({name:"list",description:"Lists the permissions for the current region"}).executes(t=>{let e=u.blockLocationInRegion(new ie(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!e)return t.reply("You are not in a region");t.reply(`Current region permissions ${JSON.stringify(e.permissions)}`)});var Bt=qe.literal({name:"entities",description:"Holds the subCommands for adding or removing allowedEntitys"});Bt.literal({name:"add",description:"Adds a entity to the allowed entitys list"}).string("entity").executes((t,e)=>{let n=u.blockLocationInRegion(new ie(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;r.push(e),n.changePermission("allowedEntitys",r),t.reply(`Added entity ${e} to the allowed entitys of the region your currently standing in`)});Bt.literal({name:"remove",description:"Removes a entity from the allowed entitys in the region"}).string("entity").executes((t,e)=>{let n=u.blockLocationInRegion(new ie(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;if(!r.includes(e))return t.reply(`The entity ${e} is not allowed to enter the region`);r=r.filter(o=>o!=e),n.changePermission("allowedEntitys",r),t.reply(`Removed entity ${e} to the allowed entitys of the region your currently standing in`)});var Ke=(o=>(o[o.member=0]="member",o[o.admin=1]="admin",o[o.moderator=2]="moderator",o[o.builder=3]="builder",o))(Ke||{});var In=t=>isNaN(Number(t))===!1;function vn(t){return Object.keys(t).filter(In).map(e=>t[e])}var Lt=new d({name:"role",description:"Changes the role for a player",requires:t=>l(t)=="admin"||Ae(t)});Lt.literal({name:"set",description:"Sets the role for a player"}).argument(new h.playerName("playerName")).argument(new h.array("role",vn(Ke))).executes((t,e,n)=>{G(e,n),t.reply(`Changed role of ${e} to ${n}`)});Lt.literal({name:"get",description:"Gets the role of a player"}).argument(new h.playerName("playerName")).executes((t,e)=>{t.reply(`${e} has role: ${l(e)}`)});import{ActionFormData as Cn}from"@minecraft/server-ui";var Y=class{constructor(e,n){this.title=e,this.body=n,this.form=new Cn,e&&this.form.title(e),n&&this.form.body(n),this.buttons=[],this.triedToShow=0}addButton(e,n=null,r){return this.buttons.push({text:e,iconPath:n,callback:r}),this.form.button(e,n),this}show(e){this.form.show(e).then(n=>{if(n.canceled){if(n.cancelationReason=="userBusy"){if(this.triedToShow>200)return e.tell("\xA7cForm Timeout: tried to show form, but you were busy (close chat after running command)");this.triedToShow++,this.show(e)}return}this.buttons[n.selection].callback?.()})}};import{ItemTypes as Sn,MinecraftBlockTypes as En}from"@minecraft/server";var Dt="2.5.1-beta";var _e="https://discord.gg/dMa3A5UYKX";var se={aquaAffinity:1,baneOfArthropods:5,binding:1,blastProtection:4,channeling:1,depthStrider:3,efficiency:5,featherFalling:4,fireAspect:2,fireProtection:4,flame:1,fortune:3,frostWalker:2,impaling:5,infinity:1,knockback:2,looting:3,loyalty:4,luckOfTheSea:3,lure:3,mending:1,multishot:1,piercing:4,power:5,projectileProtection:4,protection:4,punch:2,quickCharge:3,respiration:3,riptide:3,sharpness:5,silkTouch:1,smite:5,soulSpeed:3,swiftSneak:4,thorns:3,unbreaking:3,vanishing:1};var me=["minecraft:beehive","minecraft:bee_nest","minecraft:acacia_standing_sign","minecraft:acacia_wall_sign","minecraft:agent_spawn_egg","minecraft:allay_spawn_egg","minecraft:allow","minecraft:axolotl_bucket","minecraft:axolotl_spawn_egg","minecraft:balloon","minecraft:bamboo_sapling","minecraft:barrier","minecraft:barrier","minecraft:bat_spawn_egg","minecraft:bedrock","minecraft:bee_nest","minecraft:bee_spawn_egg","minecraft:beehive","minecraft:birch_standing_sign","minecraft:birch_wall_sign","minecraft:blackstone_double_slab","minecraft:blaze_spawn_egg","minecraft:border_block","minecraft:brewingstandblock","minecraft:bubble_column","minecraft:camera","minecraft:carrots","minecraft:cat_spawn_egg","minecraft:cave_spider_spawn_egg","minecraft:cave_vines","minecraft:cave_vines_body_with_berries","minecraft:chain_command_block","minecraft:chemical_heat","minecraft:chemistry_table","minecraft:chicken_spawn_egg","minecraft:client_request_placeholder_block","minecraft:cobbled_deepslate_double_slab","minecraft:cod_bucket","minecraft:cod_spawn_egg","minecraft:colored_torch","minecraft:colored_torch_bp","minecraft:colored_torch_rg","minecraft:command_block","minecraft:command_block_minecart","minecraft:compound","minecraft:compoundcreator","minecraft:cow_spawn_egg","minecraft:creeper_spawn_egg","minecraft:crimson_double_slab","minecraft:crimson_standing_sign","minecraft:crimson_wall_sign","minecraft:darkoak_standing_sign","minecraft:darkoak_wall_sign","minecraft:daylight_detector_inverted","minecraft:debug_stick","minecraft:deepslate_brick_double_slab","minecraft:deepslate_tile_double_slab","minecraft:deny","minecraft:dolphin_spawn_egg","minecraft:donkey_spawn_egg","minecraft:double_cut_copper_slab","minecraft:double_wooden_slab","minecraft:drowned_spawn_egg","minecraft:elder_guardian_spawn_egg","minecraft:end_gateway","minecraft:end_portal","minecraft:end_portal_frame","minecraft:enderman_spawn_egg","minecraft:endermite_spawn_egg","minecraft:evoker_spawn_egg","minecraft:exposed_double_cut_copper_slab","minecraft:fire","minecraft:flowing_lava","minecraft:flowing_water","minecraft:fox_spawn_egg","minecraft:frog_spawn_egg","minecraft:frosted_ice","minecraft:ghast_spawn_egg","minecraft:glow_squid_spawn_egg","minecraft:glow_stick","minecraft:glowingobsidian","minecraft:goat_spawn_egg","minecraft:guardian_spawn_egg","minecraft:hard_glass","minecraft:hard_glass_pane","minecraft:hard_stained_glass","minecraft:hard_stained_glass_pane","minecraft:hoglin_spawn_egg","minecraft:horse_spawn_egg","minecraft:husk_spawn_egg","minecraft:ice_bomb","minecraft:info_update","minecraft:info_update2","minecraft:invisible_bedrock","minecraft:invisiblebedrock","minecraft:item.acacia_door","minecraft:item.bed","minecraft:item.beetroot","minecraft:item.birch_door","minecraft:item.cake","minecraft:item.campfire","minecraft:item.cauldron","minecraft:item.chain","minecraft:item.crimson_door","minecraft:item.dark_oak_door","minecraft:item.flower_pot","minecraft:item.frame","minecraft:item.glow_frame","minecraft:item.hopper","minecraft:item.iron_door","minecraft:item.jungle_door","minecraft:item.kelp","minecraft:item.nether_sprouts","minecraft:item.nether_wart","minecraft:item.reeds","minecraft:item.skull","minecraft:item.soul_campfire","minecraft:item.spruce_door","minecraft:item.warped_door","minecraft:item.wheat","minecraft:item.wooden_door","minecraft:jigsaw","minecraft:jungle_standing_sign","minecraft:jungle_wall_sign","minecraft:lava","minecraft:lava_cauldron","minecraft:light_block","minecraft:lit_blast_furnace","minecraft:lit_deepslate_redstone_ore","minecraft:lit_furnace","minecraft:lit_redstone_lamp","minecraft:lit_redstone_ore","minecraft:lit_smoker","minecraft:llama_spawn_egg","minecraft:magma_cube_spawn_egg","minecraft:medicine","minecraft:melon_stem","minecraft:mob_spawner","minecraft:mooshroom_spawn_egg","minecraft:movingBlock","minecraft:moving_block","minecraft:movingblock","minecraft:mule_spawn_egg","minecraft:netherreactor","minecraft:npc_spawn","minecraft:npc_spawn_egg","minecraft:ocelot_spawn_egg","minecraft:oxidized_double_cut_copper_slab","minecraft:panda_spawn_egg","minecraft:parrot_spawn_egg","minecraft:phantom_spawn_egg","minecraft:pig_spawn_egg","minecraft:piglin_brute_spawn_egg","minecraft:piglin_spawn_egg","minecraft:pillager_spawn_egg","minecraft:piston_arm_collision","minecraft:piston_arm_collision","minecraft:pistonarmcollision","minecraft:polar_bear_spawn_egg","minecraft:polished_blackstone_brick_double_slab","minecraft:polished_blackstone_double_slab","minecraft:polished_deepslate_double_slab","minecraft:portal","minecraft:potatoes","minecraft:powder_snow","minecraft:powder_snow_bucket","minecraft:powered_comparator","minecraft:powered_repeater","minecraft:pufferfish_bucket","minecraft:pufferfish_spawn_egg","minecraft:pumpkin_stem","minecraft:rabbit_spawn_egg","minecraft:rapid_fertilizer","minecraft:ravager_spawn_egg","minecraft:real_double_stone_slab","minecraft:real_double_stone_slab2","minecraft:real_double_stone_slab3","minecraft:real_double_stone_slab4","minecraft:redstone_wire","minecraft:repeating_command_block","minecraft:reserved3","minecraft:reserved4","minecraft:reserved6","minecraft:salmon_bucket","minecraft:salmon_spawn_egg","minecraft:sea_turtle_spawn_egg","minecraft:sheep_spawn_egg","minecraft:shulker_spawn_egg","minecraft:silverfish_spawn_egg","minecraft:skeleton_horse_spawn_egg","minecraft:skeleton_spawn_egg","minecraft:slime_spawn_egg","minecraft:soul_fire","minecraft:soul_fire","minecraft:sparkler","minecraft:spawn_egg","minecraft:spawn_egg","minecraft:spawner","minecraft:spider_spawn_egg","minecraft:spruce_standing_sign","minecraft:spruce_wall_sign","minecraft:squid_spawn_egg","minecraft:standing_banner","minecraft:standing_sign","minecraft:stickyPistonArmCollision","minecraft:sticky_piston_arm_collision","minecraft:stonecutter","minecraft:stray_spawn_egg","minecraft:strider_spawn_egg","minecraft:structure_block","minecraft:structure_void","minecraft:tadpole_bucket","minecraft:tadpole_spawn_egg","minecraft:tripwire","minecraft:tropical_fish_bucket","minecraft:tropical_fish_spawn_egg","minecraft:underwater_torch","minecraft:unknown","minecraft:unlit_redstone_ore","minecraft:unpowered_comparator","minecraft:unpowered_repeater","minecraft:vex_spawn_egg","minecraft:villager_spawn_egg","minecraft:vindicator_spawn_egg","minecraft:wall_banner","minecraft:wall_sign","minecraft:wandering_trader_spawn_egg","minecraft:warden_spawn_egg","minecraft:warped_double_slab","minecraft:warped_standing_sign","minecraft:warped_wall_sign","minecraft:water","minecraft:waxed_double_cut_copper_slab","minecraft:waxed_exposed_double_cut_copper_slab","minecraft:waxed_oxidized_double_cut_copper_slab","minecraft:waxed_weathered_double_cut_copper_slab","minecraft:weathered_double_cut_copper_slab","minecraft:witch_spawn_egg","minecraft:wither_spawn_egg","minecraft:wolf_spawn_egg","minecraft:zoglin_spawn_egg","minecraft:zombie_horse_spawn_egg","minecraft:zombie_spawn_egg","minecraft:zombie_villager_spawn_egg","minecraft:zombified_piglin_spawn_egg"],ce=["minecraft:moving_block","minecraft:beehive","minecraft:beenest"],we=["minecraft:chest","minecraft:trapped_chest"],O={x:7,y:7,z:7};import{ModalFormData as Tn}from"@minecraft/server-ui";var ke=class{constructor(e,n,r){this.form=e,this.player=n,this.callback=r}error(e){new F("Error",e).setButton1("Return to form",()=>{this.form.show(this.player,this.callback)}).setButton2("Cancel",null).show(this.player)}};var T=class{constructor(e){this.title=e,this.form=new Tn,e&&this.form.title(e),this.args=[],this.triedToShow=0}addDropdown(e,n,r){return this.args.push({type:"dropdown",options:n}),this.form.dropdown(e,n,r),this}addSlider(e,n,r,o,i){return this.args.push({type:"slider"}),this.form.slider(e,n,r,o,i),this}addToggle(e,n){return this.args.push({type:"toggle"}),this.form.toggle(e,n),this}addTextField(e,n,r){return this.args.push({type:"textField"}),this.form.textField(e,n,r),this}show(e,n){this.form.show(e).then(r=>{if(r.canceled){if(r.cancelationReason=="userBusy"){if(this.triedToShow>200)return e.tell("\xA7cForm Timeout: tried to show form, but you were busy (close chat after running command)");this.triedToShow++,this.show(e,n)}return}n(new ke(this,e,n),...r.formValues.map((o,i)=>this.args[i].type=="dropdown"?this.args[i].options[o]:o))})}};function Mt(t){new T("Manage Banned Items").addDropdown("Add/Remove Item",["add","remove"],0).addTextField("Item Id","minecraft:string").show(t,(e,n,r)=>{if(!Sn.get(r)?.id)return e.error(`\xA7c"${r}" is not a vaild item id, note: this item must be either a item in a behavior pack or a default minecraft item`);if(n=="add"){let o=a.config.get("banned_items")??me;if(o.includes(r))return e.error(`\xA7cItem "${r}" is already banned`);o.push(r),a.config.set("banned_items",o),t.tell(`Banned the item "${r}"`)}else{let o=a.config.get("banned_items")??me;if(!o.includes(r))return e.error(`\xA7cItem: "${r}" is not banned`);o=o.filter(i=>i!=r),a.config.set("banned_items",o),t.tell(`Removed Banned item "${r}"`)}})}function $t(t){new T("Manage Banned Blocks").addDropdown("Add/Remove Block",["add","remove"],0).addTextField("Block Id","minecraft:barrier").show(t,(e,n,r)=>{if(!En.get(r)?.id)return e.error(`\xA7c"${r}" is not a vaild block id, note: this item must be either a block in a behavior pack or a default minecraft block`);if(n=="add"){let o=a.config.get("banned_blocks")??ce;if(o.includes(r))return e.error(`\xA7cBlock "${r}" is already banned`);o.push(r),a.config.set("banned_blocks",r),t.tell(`Banned the block "${r}"`)}else{let o=a.config.get("banned_blocks")??ce;if(!o.includes(r))return e.error(`block: "${r}" is not banned`);o=o.filter(i=>i!=r),a.config.set("banned_blocks",r),t.tell(`Removed Banned block "${r}"`)}})}function Ot(t){new T("Manage Enchantment Levels").addDropdown("Enchantment to change",Object.keys(se),0).addTextField("Level (number)","5").show(t,(e,n,r)=>{if(isNaN(r))return e.error(`\xA7c"${r}" is not a number, please enter a value like, "3", "9", etc.`);let o=parseInt(r),i=a.config.get("enchantments")??se;i[n]=o,a.config.set("enchantments",i),t.tell(`Set max level for ${n} to ${o}`)})}function Ft(t){new T("Manage Appeal Link").addTextField("Appeal Link",_e).show(t,(e,n)=>{a.config.set("appealLink",n),t.tell(`Changed the servers appeal link to ${n}`)})}function zt(t){new Y("Rubedo Settings").addButton("Anti Spam","textures/ui/permissions_op_crown.png",()=>{An(t)}).addButton("Cbe","textures/blocks/sculk_shrieker_top.png",()=>{xn(t)}).addButton("Gamemode","textures/blocks/barrier.png",()=>{Rn(t)}).addButton("Nuker","textures/ui/Feedback.png",()=>{Nn(t)}).show(t)}function An(t){let e=a.config.get("spam_config")??{repeatedMessages:!0,zalgo:!0,violationCount:0,permMutePlayer:!1};new T("Manage Spam Protection").addToggle("Ban Repeated Messages",e.repeatedMessages).addToggle("Ban Zalgo",e.zalgo).addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Perm Mute Player",e.permMutePlayer).show(t,(n,r,o,i,m)=>{a.config.set("spam_config",{repeatedMessages:r,zalgo:o,violationCount:i,permMutePlayer:m}),t.tell("Updated Spam Protection settings!")})}function xn(t){let e=a.config.get("cbe_config")??{clearItem:!0,violationCount:0,banPlayer:!1};new T("Manage CBE Protection").addToggle("Clear Item",e.clearItem).addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Ban Player",e.banPlayer).show(t,(n,r,o,i)=>{a.config.set("cbe_config",{clearItem:r,violationCount:o,banPlayer:i}),t.tell("Updated CBE Protection settings!")})}function Rn(t){let e=a.config.get("gamemode_config")??{setToSurvival:!0,clearPlayer:!0,violationCount:0,banPlayer:!1};new T("Manage Gamemode Protection").addToggle("Set to survival",e.setToSurvival).addToggle("Clear Player (Once this players gamemode has been switched back to survival should it clear the inventory?)",e.clearPlayer).addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Ban Player",e.banPlayer).show(t,(n,r,o,i,m)=>{a.config.set("gamemode_config",{setToSurvival:r,clearPlayer:o,violationCount:i,banPlayer:m}),t.tell("Updated Gamemode Protection settings!")})}function Nn(t){let e=a.config.get("nuker_data")??{violationCount:0,banPlayer:!1};new T("Manage Gamemode Protection").addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Ban Player",e.banPlayer).show(t,(n,r,o)=>{a.config.set("nuker_data",{violationCount:r,banPlayer:o}),t.tell("Updated Nuker Protection settings!")})}function Gt(t){new Y("Rubedo Settings").addButton("Auto Mod","textures/ui/permissions_op_crown.png",()=>{zt(t)}).addButton("Banned items","textures/blocks/sculk_shrieker_top.png",()=>{Mt(t)}).addButton("Banned blocks","textures/blocks/barrier.png",()=>{$t(t)}).addButton("Enchantments","textures/items/book_enchanted.png",()=>{Ot(t)}).addButton("Appeal Link","textures/ui/Feedback.png",()=>{Ft(t)}).show(t)}new d({name:"settings",description:"Opens up the settings menu for the player",requires:t=>["admin","moderator"].includes(l(t))}).executes(t=>{Gt(t.sender),t.sender.tell("\xA7aForm request sent, close chat to continue!")});import{world as jt}from"@minecraft/server";new d({name:"vanish",description:"Toggles Vanish Mode on the sender",requires:t=>l(t)=="admin"}).boolean("say").executes((t,e)=>{if(t.sender.hasTag("spectator")){if(t.sender.runCommand("gamemode c"),t.sender.runCommand("event entity @s removeSpectator"),t.sender.removeTag("spectator"),!e)return;jt.say({rawtext:[{translate:"multiplayer.player.joined",with:[`\xA7e${t.sender.name}`]}]})}else{if(t.sender.runCommand("gamemode spectator"),t.sender.runCommand("event entity @s addSpectator"),t.sender.addTag("spectator"),!e)return;jt.say({rawtext:[{translate:"multiplayer.player.left",with:[`\xA7e${t.sender.name}`]}]})}});new d({name:"version",description:"Get Current Version",aliases:["v"]}).executes(t=>{t.reply(`Current Rubedo Version: ${Dt}`)});v(t=>{try{let e=a.bans.get(t.id);if(!e)return;if(console.warn(t.name),e.expire&&e.expire<Date.now())return a.bans.delete(t.id);B(t,["\xA7cYou have been banned!",`\xA7aReason: \xA7f${e.reason}`,`\xA7fExpiry: \xA7b${e.expire?j(e.duration):"Forever"}`,`\xA7fAppeal at: \xA7b${a.config.get("appealLink")??_e}`],()=>{console.warn(new Error("Failed to kick player")),a.bans.delete(t.id)})}catch(e){console.warn(e+e.stack)}},20);import{Location as Ln}from"@minecraft/server";v(t=>{let e=a.freezes.get(t.id);!e||t.teleport(new Ln(e.location.x,e.location.y,e.location.z),_[e.location.dimension],0,0)},20);import{world as Dn}from"@minecraft/server";Dn.events.beforeChat.subscribe(t=>{if(t.message.startsWith(k))return;let e=x.getMuteData(t.sender);if(!!e){if(e.expire&&e.expire<Date.now())return a.mutes.delete(t.sender.name);t.cancel=!0,t.sender.tell(w["modules.managers.mute.isMuted"]())}});import{BlockLocation as Mn,world as We}from"@minecraft/server";E(()=>{de()},6e3);We.events.beforeItemUseOn.subscribe(t=>{if(["moderator","admin"].includes(l(t.source)))return;let e=u.blockLocationInRegion(t.blockLocation,t.source.dimension.id);if(!e)return;let n=t.source.dimension.getBlock(t.blockLocation);rt.includes(n.typeId)&&e.permissions.doorsAndSwitches||ot.includes(n.typeId)&&e.permissions.openContainers||(t.cancel=!0)});We.events.beforeExplosion.subscribe(t=>{for(let e=0;e<t.impactedBlocks.length;e++){let n=t.impactedBlocks[e];if(u.blockLocationInRegion(n,t.dimension.id))return t.cancel=!0}});We.events.entityCreate.subscribe(t=>{let e=u.blockLocationInRegion(new Mn(t.entity.location.x,t.entity.location.y,t.entity.location.z),t.entity.dimension.id);!e||e.permissions.allowedEntitys.includes(t.entity.typeId)||(t.entity.teleport({x:0,y:-64,z:0},t.entity.dimension,0,0),t.entity.kill())});E(()=>{for(let t of u.getAllRegions())for(let e of _[t.dimensionId].getEntities({excludeTypes:t.permissions.allowedEntitys}))!t.entityInRegion(e)||(e.teleport({x:0,y:-64,z:0},e.dimension,0,0),e.kill())},100);v(t=>{for(let e of u.getAllRegions())e.entityInRegion(t)?(t.addTag("inRegion"),e.permissions.pvp||t.addTag("region-protected")):(t.removeTag("inRegion"),t.removeTag("region-protected"))},5);import{world as Je}from"@minecraft/server";Je.events.playerJoin.subscribe(({player:t})=>{if(fe()&&l(t)!="admin")return B(t,w["lockdown.kick.message"]());let e=Je.events.tick.subscribe(n=>{try{_.overworld.runCommand(`testfor @a[name="${t.name}"]`),Je.events.tick.unsubscribe(e),x.getMuteData(t)&&t.runCommand("ability @s mute true"),t.hasTag("old")?t.addTag("old"):a.ids.set(t.name,t.id);let r=R.getPlayersRoleToSet(t.name);r&&G(t,r)}catch{}})});import{Items as $n,MinecraftItemTypes as S,world as Xe}from"@minecraft/server";var Vt=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],On=[10,11,12,13,14,15,16,19,20,21,22,23,24,25,28,29,30,31,32,33,34,37,38,39,40,41,42,43];function Fn(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let o=0;o<r.size;o++){let i=e.slots[o];if(!i||!i.item){r.setItem(o,A);continue}r.setItem(o,i.item.itemStack)}for(let[o,i]of[...Xe.getPlayers()].entries()){let m=Vt[o],s=new y(S.skull,{nameTag:i.name,data:3});r.setItem(m,s.itemStack),e.slots[m]={item:s,action:c=>{c.PageAction("moderation:see_inventory",{name:i.name})}}}}function zn(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let c=0;c<r.size;c++){let p=e.slots[c];if(!p||!p.item){r.setItem(c,A);continue}r.setItem(c,p.item.itemStack)}let o=new y(S.enderChest,{nameTag:`\xA7eView \xA7f${n?.name}\xA7e Ender Chest
\xA7fNote: \xA7cThis will not grab \xA7lANY NBT!\xA7r`});r.setItem(49,o.itemStack),e.slots[49]={item:o,action:c=>{c.PageAction("moderation:see_ender_chest",{name:n.name})}};let i=[...Xe.getPlayers()].find(c=>c.name==n.name);i||(Object.values(P).find(p=>p.entity.id==t.id).despawn(),i.tell(`"${n.name}" Could not be found, Gui Crashed`));let m=i.getComponent("inventory").container,s=0;for(let c=0;c<m.size;c++){let p=m.getItem(c),f=Vt[s];if(s++,!p){r.setItem(f,A);continue}r.setItem(f,p),e.slots[f]={item:new y($n.get(p.typeId),{amount:p.amount,data:p.data},p),action:Te=>{c<9?i.runCommand(`replaceitem entity @s slot.hotbar ${c} air`):i.runCommand(`replaceitem entity @s slot.inventory ${c-9} air`),Te.GiveAction(),e.slots[f]={item:null,action:nn=>{m.addItem(nn.getItemAdded())}}}}}}function Gn(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let s=0;s<r.size;s++){let c=e.slots[s];if(!c||!c.item){r.setItem(s,A);continue}r.setItem(s,c.item.itemStack)}let o=[...Xe.getPlayers()].find(s=>s.name==n?.name);o||(Object.values(P).find(c=>c.entity.id==t.id).despawn(),o.tell(`"${n.name}" Could not be found, Gui Crashed`));let i=0,m=Object.values(S);for(let s of m)try{o.runCommand(`testfor @s[hasitem={item=${s.id},location=slot.enderchest}]`),console.warn(`found ${s.id}`);let c=new y(s,{nameTag:"Note: \xA7l\xA7cThis is not the exzact item"}),p=On[i];r.setItem(p,c.itemStack),e.slots[p]={item:c,action:f=>{f.GiveAction(),e.slots[p]=null}},i++}catch{}}new M("moderation:see",Fn).setSlots([45,46,47,49,51,52,53],new y(S.stainedGlassPane,{nameTag:"\xA7r",data:15}),t=>{t.SetAction()}).setSlots([50],new y(S.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("home")}).setSlots([48],new y(S.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});new M("moderation:see_inventory",zn).setSlots([45,46,47,49,51,52,53],new y(S.stainedGlassPane,{nameTag:"\xA7r",data:15}),t=>{t.SetAction()}).setSlots([50],new y(S.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setSlots([48],new y(S.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});new M("moderation:see_ender_chest",Gn).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,49,51,52,53],new y(S.stainedGlassPane,{nameTag:"\xA7r",data:15}),t=>{t.SetAction()}).setSlots([50],new y(S.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setSlots([48],new y(S.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});import{ItemStack as jn,MinecraftBlockTypes as Vn,MinecraftItemTypes as Un,world as Ht}from"@minecraft/server";var Hn=new jn(Un.stick,0),Yn=["minecraft:command_block_minecart"],Ut=new b;v(t=>{let e=a.config.get("cbe_config")??{clearItem:!0,violationCount:0,banPlayer:!1},n=t.getComponent("inventory").container;for(let r=0;r<n.size;r++){let o=n.getItem(r);if(!o)continue;let i=()=>{console.warn(`[Protection: CBE]: ${t.name} Has a CBE item!`),e.clearItem&&t.getComponent("inventory").container.setItem(r,Hn);let f=(Ut.get(t)??0)+1;Ut.set(t,f),e.banPlayer&&f>=e.violationCount&&new C(t,null,null,"Cbe Detection")};if((a.config.get("banned_items")??me).includes(o.typeId))return i();let s=o.getComponent("enchantments").enchantments,c=a.config.get("enchantments")??se,p=[];for(let f of s){let Te=c[f.type.id]??f.type.maxLevel;if(s.slot==0&&!s.canAddEnchantment(f)||f.level>Te||p.includes(f.type.id))return i();p.push(f.type.id)}}});Ht.events.beforeDataDrivenEntityTriggerEvent.subscribe(({id:t,entity:e})=>{if(t!="minecraft:entity_spawned")return;let n=()=>{try{e.triggerEvent("despawn"),e.kill()}catch{e.kill()}};if(Yn.includes(e.typeId)||e.typeId=="minecraft:npc"&&!H.isVaild(e))return n()});Ht.events.blockPlace.subscribe(({block:t,player:e})=>{if(["moderator","admin"].includes(l(e)))return;(a.config.get("banned_blocks")??ce).includes(t.typeId)&&t.setType(Vn.air)});var Ze=32e4;v(t=>{(Math.abs(t.location.x)>Ze||Math.abs(t.location.y)>Ze||Math.abs(t.location.z)>Ze)&&new C(t,null,null,"Hacking: Crasher")});import{world as Yt}from"@minecraft/server";var Ie=class{constructor(e,n,r){this.player=e,this.location=e.location,this.dimension=e.dimension,this.rotation=e.rotation,this.tick=n,this.storage=r,this.events={playerLeave:Yt.events.playerLeave.subscribe(({playerName:o})=>{o==this.player.name&&this.expire()})},this.storage.set(e,this)}back(){this.player.teleport(this.location,this.dimension,this.rotation.x,this.rotation.y)}update(){this.tick=q,this.location=this.player.location,this.dimension=this.player.dimension,this.rotation=this.player.rotation}expire(){this.storage.delete(this.player);for(let e in this.events)Yt.events[e].unsubscribe(this.events[e])}};var qt=new b,qn=.9,Kn=20,Wn=!0,Jn=["gliding","riding","levitating","swimming"];function Xn(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}v((t,{currentTick:e})=>{if(t.getTags().some(o=>Jn.includes(o)))return;let n=()=>qt.get(t)??new Ie(t,e,qt),r=Math.sqrt(t.velocity.x**2+t.velocity.z**2);if(t.hasTag("on_ground"))return n().update();if(!(r<qn)&&Xn(t)?.typeId!="minecraft:trident"&&!(e-n().tick<Kn)&&(n().back(),Wn))try{t.runCommand("damage @s 4 fly_into_wall")}catch{}},20);import{GameMode as Zn,world as Qn}from"@minecraft/server";var er=Zn.creative,Kt=new b;E(()=>{let t=a.config.get("gamemode_config")??{setToSurvival:!0,clearPlayer:!0,violationCount:0,banPlayer:!1};for(let e of Qn.getPlayers({gameMode:er})){if(["moderator","admin","builder"].includes(l(e)))continue;try{t.setToSurvival&&e.runCommand("gamemode s"),t.clearPlayer&&e.runCommand("clear @s")}catch{}let n=(Kt.get(e)??0)+1;Kt.set(e,n),t.banPlayer&&n>=t.violationCount&&new C(e,null,null,"Invaild Gamemode")}},20);import{world as Wt}from"@minecraft/server";var tr="\xA7c\xA7k\xA7m\xA7A\xA7r\xA7cToolbox Gamer\xA7k\xA7mA\xA7r";Wt.events.playerJoin.subscribe(({player:t})=>{let e=()=>B(t,["\xA7cYou have been kicked!",`\xA7aReason: \xA7f'${t.name}' is Detected for nameSpoof`,"\xA7fThis Server requires you to have a valid gamertag!"]);if(t.name==tr||[...Wt.getPlayers()].filter(n=>n.name==t.name).length>1||(a.ids.get(t.name)??t.id)!=t.id)return e()});import{world as rr,Location as or}from"@minecraft/server";import{world as nr}from"@minecraft/server";var ve=class{constructor(e){this.emptySlotsCount=e.emptySlotsCount,this.size=e.size,this.items=[];for(let n=0;n<this.size;n++)this.items[n]=e.getItem(n)}load(e){for(let n=0;n<e.size;n++)!this.items[n]||e.setItem(n,this.items[n])}};var Ce={};E(()=>{Ce={};for(let t of nr.getPlayers()){let e=lt(t.location),n=e.offset(O.x,O.y,O.z),r=e.offset(-O.x,-O.y,-O.z);for(let o of n.blocksBetween(r)){if(o.y<-64)continue;let i=t.dimension.getBlock(o);!we.includes(i.typeId)||(Ce[JSON.stringify(o)]=new ve(i.getComponent("inventory").container))}}},100);var Jt=new b,ir=70,ar=["snow","lush_plants_replaceable","azalea_log_replaceable","minecraft:crop","fertilize_area"],sr=["minecraft:water","minecraft:flowing_water","minecraft:lava","minecraft:flowing_lava","minecraft:bedrock"],Xt=new b;rr.events.blockBreak.subscribe(({block:t,brokenBlockPermutation:e,dimension:n,player:r})=>{if(["moderator","admin"].includes(l(r))||t.getTags().some(s=>ar.includes(s)))return;let o=Jt.get(r);if(Jt.set(r,Date.now()),!o||sr.includes(t.typeId)||o<Date.now()-ir)return;let i=a.config.get("nuker_data")??{violationCount:0,banPlayer:!1},m=(Xt.get(r)??0)+1;if(Xt.set(r,m),i.banPlayer&&m>=i.violationCount&&new C(r,null,null,"Using Nuker"),n.getBlock(t.location).setPermutation(e.clone()),we.includes(e.type.id)){let s=Ce[JSON.stringify(t.location)];s&&s.load(t.getComponent("inventory").container)}$e(()=>{[...n.getEntities({maxDistance:2,type:"minecraft:item",location:new or(t.location.x,t.location.y,t.location.z)})].forEach(s=>s.kill())},0)});import{world as mr}from"@minecraft/server";var Zt=new b,Qt=new b;mr.events.beforeChat.subscribe(t=>{if(t.message.startsWith(k)||["admin","moderator"].includes(l(t.sender)))return;let e=a.config.get("spam_config")??{repeatedMessages:!0,zalgo:!0,violationCount:0,permMutePlayer:!1},n=()=>{let r=(Qt.get(t.sender)??0)+1;Qt.set(t.sender,r),e.permMutePlayer&&r>=e.violationCount&&new x(t.sender,null,null,"Reached Violation count")};if(e.repeatedMessages&&Zt.get(t.sender)==t.message)return t.cancel=!0,n(),t.sender.tell("\xA7cRepeated message detected!");if(e.zalgo&&/%CC%/g.test(encodeURIComponent(t.message)))return t.cancel=!0,n(),t.sender.tell("\xA7cYou message contains some type of zalgo and cannot be sent!");Zt.set(t.sender,t.message)});import{Player as cr,world as le}from"@minecraft/server";var lr=le.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{if(le.getDynamicProperty("roleHasBeenSet"))return le.events.beforeDataDrivenEntityTriggerEvent.unsubscribe(lr);t.entity instanceof cr&&t.id=="rubedo:becomeAdmin"&&(G(t.entity,"admin"),le.setDynamicProperty("roleHasBeenSet",!0),le.setDynamicProperty("worldsOwner",t.entity.id),t.entity.tell("\xA7l\xA7cYou have been given admin, the function start will not work anymore!!!!"))});import{system as dr}from"@minecraft/server";dr.events.beforeWatchdogTerminate.subscribe(t=>{t.cancel=!0,console.warn(`WATCHDOG TRIED TO CRASH = ${t.terminateReason}`)});import{DynamicPropertiesDefinition as Qe,EntityTypes as fr,MinecraftEntityTypes as pr,world as tn}from"@minecraft/server";var en=[];tn.events.worldInitialize.subscribe(({propertyRegistry:t})=>{ct("tickingarea add 0 0 0 0 0 0 db true");let e=new Qe;e.defineString("name",30),e.defineNumber("index"),t.registerEntityTypeDynamicProperties(e,fr.get(K));let n=new Qe;n.defineString("role",30),t.registerEntityTypeDynamicProperties(n,pr.player);let r=new Qe;r.defineBoolean("roleHasBeenSet"),r.defineString("worldsOwner",100),r.defineBoolean("isLockDown"),t.registerWorldDynamicProperties(r);for(let o of en)tn.scoreboard.addObjective(o.objective,o.displayName??"")});console.warn("---- STARTING RUBEDO ----");var be=[];function Rt(){be=[]}var q=null,A=new ur(gr.stick,0);yr.events.tick.subscribe(t=>{q?q=q+1:q=t.currentTick});export{A as AIR,q as CURRENT_TICK,be as NPC_LOCATIONS,Rt as clearNpcLocations};
//# sourceMappingURL=index.js.map
