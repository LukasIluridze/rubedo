import{ItemStack as zn,MinecraftItemTypes as Fn,world as Gn}from"mojang-minecraft";import{world as $t}from"mojang-minecraft";var C="-";import{Location as Dt}from"mojang-minecraft";import{world as Lt}from"mojang-minecraft";function Be(t){return[...Lt.getPlayers()].find(e=>e.name===t)}var D=class{constructor(e="literal"){this.name=e;this.typeName="literal";this.name=e}matches(e){return{success:this.name==e}}},U=class{constructor(e="string"){this.name=e;this.typeName="string";this.name=e}matches(e){return{success:e&&e!="",value:e}}},H=class{constructor(e="integer"){this.name=e;this.typeName="int";this.name=e}matches(e){return{success:!isNaN(e),value:parseInt(e)}}},ye=class{constructor(e="float"){this.name=e;this.typeName="float";this.name=e}matches(e){return{success:Boolean(e?.match(/^\d+\.\d+$/)?.[0]),value:parseInt(e)}}},M=class{constructor(e="location"){this.name=e;this.typeName="location";this.name=e}matches(e){return{success:!isNaN(e),value:e}}},q=class{constructor(e="boolean"){this.name=e;this.typeName="boolean";this.name=e}matches(e){return{success:Boolean(e?.match(/^(true|false)$/)?.[0]),value:e=="true"}}},he=class{constructor(e="player"){this.name=e;this.typeName="playerName";this.name=e}matches(e){return{success:!!Be(e),value:Be(e)}}},be=class{constructor(e="target"){this.name=e;this.typeName="Target";this.name=e}matches(e){return{success:Boolean(e?.match(/^(@.|"[\s\S]+")$/)?.[0]),value:e}}},K=class{constructor(e="array",n){this.name=e;this.types=n;this.typeName="string";this.name=e,this.types=n,this.typeName=n.join(" | ").replace(/(.{25})..+/,"$1...")}matches(e){return{success:this.types.includes(e),value:e}}},_e=class{constructor(e){this.name=e;this.typeName="UnitValueType"}matches(e){return["years","yrs","weeks","days","hours","hrs","minutes","mins","seconds","secs","milliseconds","msecs","ms"].includes(e)?{success:e&&e!="",value:e}:{success:!1}}},h={string:U,int:H,float:ye,location:M,boolean:q,player:he,target:be,array:K,unit:_e};var ie=class{constructor(e){this.data=e,this.sender=e.sender}reply(e){this.sender.tell(e)}};function ze(t,e){return t.slice(e.length).trim().match(/"[^"]+"|[^\s]+/g).map(n=>n.replace(/"(.+)"/,"$1").toString())}function Fe(t,e){t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.unknown",with:[`${e}`]}]})}function Ie(t,e){t.tell({rawtext:[{text:e.data.invaildPermission?e.data.invaildPermission:`\xA7cYou do not have perrmission to use "${e.data.name}"`}]})}function Ge(t,e,n,r){t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.syntax",with:[`${C}${e.data.name} ${n.slice(0,r).join(" ")}`,n[r]??" ",n.slice(r+1).join(" ")]}]})}function Mt([t,e,n],{location:r,viewVector:o}){if(!t||!e||!t)return null;let i=[r.x,r.y,r.z],s=[o.x,o.y,o.z],p=[t,e,n].map(f=>{let _=parseInt(f.replace(/\D/g,""));return isNaN(_)?0:_}),m=[t,e,n].map((f,_)=>f.includes("~")?p[_]+i[_]:f.includes("^")?p[_]+s[_]:p[_]);return new Dt(m[0],m[1],m[2])}function Ve(t,e,n,r){let o=e[e.length-1]??r,i=[];for(let[s,p]of e.entries())if(!p.type.name.endsWith("*")){if(p.type instanceof M){i.push(Mt([t[s],t[s+1],t[s+2]],n.sender));continue}p.type instanceof D||i.push(p.type.matches(t[s]).value??t[s])}o.callback(new ie(n),...i)}var E=[];$t.events.beforeChat.subscribe(t=>{if(!t.message.startsWith(C))return;t.cancel=!0;let e=ze(t.message,C),n=E.find(i=>i.depth==0&&(i.data.name==e[0]||i.data?.aliases?.includes(e[0])));if(!n)return Fe(t.sender,e[0]);if(!n.data?.requires(t.sender))return Ie(t.sender,n);e.shift();let r=[],o=(i,s)=>{if(i.children.length>0){let p=i.children.find(m=>m.type.matches(e[s]).success);return!p&&!e[s]&&i.callback?void 0:p?p.data?.requires(t.sender)?(r.push(p),o(p,s+1)):(Ie(t.sender,p),"fail"):(Ge(t.sender,n,e,s),"fail")}};o(n,0)||Ve(e,r,t,n)});import{Player as Xt,world as ve}from"mojang-minecraft";var je="rubedo:gui",J="rubedo:inventory";import{world as v,Player as Gt,BlockLocation as Ce,MinecraftBlockTypes as Vt,MinecraftDimensionTypes as B}from"mojang-minecraft";var S={"api.name":()=>"Smelly API","api.error.unknown":()=>"An unknown error has occured.","api.database.error.table_name":(t,e)=>`The display name ${t} is too long for an objective, it can be at most ${e} characters long`,"api.utilities.formatter.error.ms":t=>`${t} is not a string or a number`,"api.Providers.form.invaildtype":(t,e)=>`Type ${t} is not a vaild type to add a ${e}`,"api.Providers.form.invaildFormtype":(t,e)=>{`${t}${JSON.stringify(e)}`},"api.ChestGUI.error.pagenotfound":t=>`Page ${t} not found!`,"modules.protections.cps.clickingToFast":()=>"You are clicking to fast! Please click slower!","modules.managers.mute.isMuted":()=>"You are muted and cannot send messages please try again later","modules.commands.ban.reply":(t,e=0,n="",r="")=>`\xA7cBanned \xA7f"\xA7a${t}\xA7f" \xA7cfor ${e} ${n} Because: "${r??"No reason Provided"}" \xA7aSuccessfully`};import{BlockLocation as Ot}from"mojang-minecraft";var Ye=32e3,W="rubedo:database",we=new Ot(0,-64,0);import{ItemStack as Bt,MinecraftItemTypes as zt}from"mojang-minecraft";function Ue(t,e){return t.match(new RegExp(".{1,"+e+"}","g"))}var g=class{static compress(e){return e}static decompress(e){return e}static createEntity(e,n){let r=b.overworld.spawnEntity(W,we);r.setDynamicProperty("name",e),r.setDynamicProperty("index",n);let o=r.getComponent("inventory").container,i=new Bt(zt.acaciaBoat,1);return n==0&&(i.nameTag="{}"),o.setItem(0,i),r}static getInventorySlotName(e,n){return e.getComponent("inventory").container.getItem(n)?.nameTag}static setInventorySlotName(e,n,r){let o=e.getComponent("inventory").container,i=o.getItem(n);return i.nameTag=r,o.setItem(n,i)}constructor(e){this.name=e,this.savedEntitys=void 0,this.MEMORY=void 0}get entitys(){if(this.savedEntitys)return this.savedEntitys;let e=b.overworld.getEntitiesAtBlockLocation(we).filter(n=>n.id==W&&n.getDynamicProperty("name")==this.name);return this.savedEntitys=e,e}data(){if(this.MEMORY)return this.MEMORY;if(this.entitys.length==0&&g.createEntity(this.name,0),this.entitys.length==1){let n=JSON.parse(g.decompress(g.getInventorySlotName(this.entitys[0],0)));return this.MEMORY=n,n}let e=new Array(this.entitys.length);for(let n of this.entitys){let r=n.getDynamicProperty("index");e[r]=g.getInventorySlotName(n,0)}try{e=JSON.parse(e.join(""))}catch{e={}}return this.MEMORY=e,e}save(e){this.MEMORY=e;let n=Ue(g.compress(JSON.stringify(e)),Ye);if(this.entitys&&n.length==this.entitys.length)for(let r=0;r<n.length;r++)g.setInventorySlotName(this.entitys[r],0,n[r]);else{this.entitys?.forEach(r=>r?.triggerEvent("despawn")),this.savedEntitys=void 0;for(let r=0;r<n.length;r++){let o=g.createEntity(this.name,r);g.setInventorySlotName(o,0,n[r])}}}set(e,n){let r=this.data();r[e]=n,this.save(r)}get(e){return this.data()[e]}has(e){return this.keys().includes(e)}delete(e){let n=this.data(),r=delete n[e];return this.save(n),r}size(){return this.keys().length}clear(){this.save({})}keys(){return Object.keys(this.data())}values(){return Object.values(this.data())}getCollection(){return this.data()}};var a={config:new g("config"),freezes:new g("freezes"),mutes:new g("mutes"),bans:new g("bans"),regions:new g("regions"),roles:new g("roles"),tasks:new g("tasks"),npcs:new g("npcs")};var He={doorsAndSwitches:!0,openContainers:!0,pvp:!1,allowedEntitys:["minecraft:player","minecraft:npc","minecraft:item"]},qe=["minecraft:acacia_door","minecraft:acacia_trapdoor","minecraft:acacia_button","minecraft:birch_door","minecraft:birch_trapdoor","minecraft:birch_button","minecraft:crimson_door","minecraft:crimson_trapdoor","minecraft:crimson_button","minecraft:dark_oak_door","minecraft:dark_oak_trapdoor","minecraft:dark_oak_button","minecraft:jungle_door","minecraft:jungle_trapdoor","minecraft:jungle_button","minecraft:mangrove_door","minecraft:mangrove_trapdoor","minecraft:mangrove_button","minecraft:spruce_door","minecraft:spruce_trapdoor","minecraft:spruce_button","minecraft:warped_door","minecraft:warped_trapdoor","minecraft:warped_button","minecraft:wooden_door","minecraft:wooden_button","minecraft:trapdoor","minecraft:iron_door","minecraft:iron_trapdoor","minecraft:polished_blackstone_button","minecraft:lever"],Ke=["minecraft:chest","minecraft:ender_chest","minecraft:barrel","minecraft:trapped_chest","minecraft:dispenser","minecraft:dropper","minecraft:furnace","minecraft:blast_furnace","minecraft:lit_furnace","minecraft:lit_blast_furnace","minecraft:hopper","minecraft:shulker_box","minecraft:undyed_shulker_box"];var ke=[],Ft=!1,Je=-64,We=320;function Xe(t,e,n){return n.every((r,o)=>r>=Math.min(t[o],e[o])&&r<=Math.max(t[o],e[o]))}var u=class{static getAllRegions(){if(Ft)return ke;let e=a.regions.values().map(n=>new u(n.from,n.to,n.dimensionId,n.permissions,n.key));return e.forEach(n=>{ke.push(n)}),e}static blockLocationInRegion(e,n){return this.getAllRegions().find(r=>r.dimensionId==n&&Xe([r.from.x,Je,r.from.z],[r.to.x,We,r.to.z],[e.x,e.y,e.z]))}static removeRegionAtBlockLocation(e,n){let r=this.blockLocationInRegion(e,n);return r?a.regions.delete(r.key):!1}constructor(e,n,r,o,i){this.from=e,this.to=n,this.dimensionId=r,this.permissions=o??He,this.key=i||Date.now().toString(),i||(this.update(),ae(),ke.push(this))}update(){a.regions.set(this.key,{key:this.key,from:this.from,dimensionId:this.dimensionId,permissions:this.permissions,to:this.to})}delete(){return a.regions.delete(this.key)}entityInRegion(e){return this.dimensionId==e.dimension.id&&Xe([this.from.x,Je,this.from.z],[this.to.x,We,this.to.z],[e.location.x,e.location.y,e.location.z])}changePermission(e,n){this.permissions[e]=n,this.update()}};var T=class{static getTasks(){return a.tasks.get("changePlayerRole")??[]}static getPlayersRoleToSet(e){return T.getTasks().find(r=>r.playerName==e)?.role}constructor(e,n){let r=T.getTasks();r.push({playerName:e,role:n}),a.tasks.set("changePlayerRole",r)}};var b={overworld:v.getDimension(B.overworld),nether:v.getDimension(B.nether),theEnd:v.getDimension(B.theEnd),"minecraft:overworld":v.getDimension(B.overworld),"minecraft:nether":v.getDimension(B.nether),"minecraft:the_end":v.getDimension(B.theEnd)};function se(t,e=[],n){try{t.runCommand(`kick "${t.nameTag}" \xA7r${e.join(`
`)}`),t.triggerEvent("kick")}catch(r){if(!/"statusCode":-2147352576/.test(r))return;n&&n()}}function l(t){return t instanceof Gt?a.roles.get(t.name)??"member":a.roles.get(t)??"member"}function z(t,e){if(typeof t=="string"){a.roles.set(t,e);let n=[...v.getPlayers()].find(r=>r.name==t);n?n.setDynamicProperty("role",e):new T(t,e)}else a.roles.set(t.name,e),t.setDynamicProperty("role",e)}function ae(){for(let t of u.getAllRegions()){let e=new Ce(t.from.x,-64,t.from.z),n=new Ce(t.to.x,-64,t.to.z);for(let r of e.blocksBetween(n))b[t.dimensionId].getBlock(r)?.setType(Vt.deny)}}var Qe=[];function I(t,e=0){Qe.push({callback:t,delay:e,lastCall:0})}v.events.tick.subscribe(t=>{let e=[...v.getPlayers()];for(let[n,r]of e.entries()){if(["moderator","admin"].includes(l(r)))return;for(let o of Qe)o.delay!=0&&t.currentTick-o.lastCall<o.delay||(o.callback(r,t),n==e.length-1&&(o.lastCall=t.currentTick))}});function Ze(t,e="overworld",n=!1){try{return n?console.warn(JSON.stringify(this.runCommand(t))):b.overworld.runCommand(t)}catch{return{error:!0}}}function d(t){try{return t.scoreboard.id.toString()}catch{try{try{t.runCommand("scoreboard objectives add test dummy")}catch{}try{t.runCommand("scoreboard players add @s test 0")}catch{}return t.scoreboard.id.toString()}catch{let r=t.getTags().find(i=>i.startsWith("id:"));if(r)return r.replace("id:","");let o=Date.now();return t.addTag(`id:${o}`),o.toString()}}}function F(t,{compactDuration:e,fullDuration:n,avoidDuration:r}={}){try{if(typeof t=="string"){if(/^\d+$/.test(t))return Number(t);let o=t.match(/-?\d*\.?\d+\s*?(years?|yrs?|weeks?|days?|hours?|hrs?|minutes?|mins?|seconds?|secs?|milliseconds?|msecs?|ms|[smhdwy])/gi);return o?o.reduce((i,s)=>i+jt(s),0):null}if(typeof t=="number")return Yt(t,{compactDuration:e,fullDuration:n,avoidDuration:r});throw new Error(S["api.utilities.formatter.error.ms"](t))}catch(o){let i=Ut(o)?`${o.message}. Value = ${JSON.stringify(t)}`:S["api.error.unknown"]();throw new Error(i)}}function jt(t){let e=Number(t.replace(/[^-.0-9]+/g,""));return t=t.replace(/\s+/g,""),/\d+(?=y)/i.test(t)?e*3154e7:/\d+(?=w)/i.test(t)?e*6048e5:/\d+(?=d)/i.test(t)?e*864e5:/\d+(?=h)/i.test(t)?e*36e5:/\d+(?=m)/i.test(t)?e*6e4:/\d+(?=s)/i.test(t)?e*1e3:/\d+(?=ms|milliseconds?)/i.test(t)?e:0}function Yt(t,{compactDuration:e,fullDuration:n,avoidDuration:r}={}){let o=Math.abs(t),s=[{short:"w",long:"week",duration:Math.floor(o/6048e5)},{short:"d",long:"day",duration:Math.floor(o/864e5)%7},{short:"h",long:"hour",duration:Math.floor(o/36e5)%24},{short:"m",long:"minute",duration:Math.floor(o/6e4)%60},{short:"s",long:"second",duration:Math.floor(o/1e3)%60},{short:"ms",long:"millisecond",duration:o%1e3}].filter(m=>m.duration!==0&&r?n&&!r.map(f=>f.toLowerCase()).includes(m.short):m.duration).map(m=>`${Math.sign(t)===-1?"-":""}${e?`${Math.floor(m.duration)}${m.short}`:`${Math.floor(m.duration)} ${m.long}${m.duration===1?"":"s"}`}`);return(n?s.join(e?" ":", "):s[0])||`${o}`}function Ut(t){return typeof t=="object"&&t!==null&&"message"in t}function et(t){return new Ce(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))}import{world as tt}from"mojang-minecraft";var nt=new Map,X=class{constructor(e,n,r=!1,o=Date.now()){this.callbackTick=null,this.tickDelay=n,this.loop=r,this.callback=e,this.id=o,nt.set(o,this),this.TickCallBack=tt.events.tick.subscribe(({currentTick:i})=>{if(this.callbackTick||(this.callbackTick=i+this.tickDelay),!(this.callbackTick>i)){if(this.callback(i),!this.loop)return this.expire();this.callbackTick=i+this.tickDelay}})}expire(){tt.events.tick.unsubscribe(this.TickCallBack),nt.delete(this.id)}};var rt=t=>new Promise(e=>Ee(e,t));function Ee(t,e){new X(t,e)}function k(t,e){return new X(t,e,!0)}import{world as mt}from"mojang-minecraft";var Se={},ot={};function Ht(t,e){if(t.length!=e.length)return[];let n=[];for(let r=0;r<e.length;r++){if(t[r]?.item?.amount<e[r]?.item?.amount||t[r]?.item?.amount>e[r]?.item?.amount&&t[r]?.item?.amount!=0){n.push({slot:r,uid:e[r].uid,oldUid:t[r].uid,item:e[r].item,oldItem:t[r].item,moveType:"fluctuation"});continue}e[r].uid!=t[r].uid&&(t[r]?.item&&e[r]?.item?n.push({slot:r,uid:e[r].uid,oldUid:t[r].uid,item:e[r].item,oldItem:t[r].item,moveType:"swap"}):e[r]?.item?e[r]?.item&&n.push({slot:r,uid:e[r].uid,item:e[r].item,moveType:"put"}):n.push({slot:r,uid:t[r].uid,item:t[r].item,moveType:"delete"}))}return n}function qt(t){if(!t)return"";let e=[];return e.push(t.id),e.push(t.nameTag),e.push(t.data),e.join("")}function Kt(t){let e=[];for(let n=0;n<t.size;n++){let r=t.getItem(n);e[n]={uid:qt(r),item:r}}return e}k(()=>{for(let t of Object.values(Se))for(let e of b.overworld.getEntities(t.entities)){let n=Kt(e.getComponent("inventory").container),r=Ht(ot[d(e)]??n,n);if(ot[d(e)]=n,r.length!=0)for(let o of r)t.callback(e,o)}},5);var Q=class{static subscribe(e,n){let r=Date.now();return Se[r]={callback:n,entities:e},r}static unsubscribe(e){delete Se[e]}};import{world as Jt}from"mojang-minecraft";var A=class{constructor(){this.data=new Map,this.events={playerLeave:Jt.events.playerLeave.subscribe(e=>this.data.delete(e.playerName))}}set(e,n){this.data.set(e.name,n)}get(e){return this.data.get(e.name)}delete(e){this.data.delete(e.name)}clear(){this.data.clear()}playerNames(){return[...this.data.keys()]}};var x={},G={},Z=new A;function it(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}async function at(t,e){try{let n=t.getComponent("minecraft:inventory").container,r=[];for(let o=0;o<n.size;o++){let i=n.getItem(o);!i||i?.id==e?.id&&(r.push({slot:o,item:i}),n.setItem,o<9?t.runCommand(`replaceitem entity @s slot.hotbar ${o} air`):t.runCommand(`replaceitem entity @s slot.inventory ${o-9} air`))}t.runCommand(`clear @s ${e?.id} ${e.data} ${e.amount}`);for(let o of r)n.setItem(o.slot,o.item)}catch{[...t.dimension.getEntities({type:"minecraft:item",location:t.location,maxDistance:2,closest:1})].forEach(r=>r.kill())}}function st(t,e){return t.getComponent("minecraft:inventory").container.getItem(e)}var me=class{constructor(e,n,r){this.gui=e,this.slot=n,this.change=r}message(e){this.gui.player.tell(e)}getItemAdded(){return this.slot.item?null:this.gui.entity.getComponent("minecraft:inventory").container.getItem(this.change.slot)}GiveAction(e=this.slot.item.itemStack){this.gui.player.getComponent("minecraft:inventory").container.addItem(e)}TakeAction(e=null){this.gui.player.getComponent("minecraft:inventory").container.addItem(this.slot.item.itemStack),this.gui.page.slots[this.change.slot]=null,e&&e.delete(this.slot.item.components.dbKey)}PageAction(e,n){this.gui.setPage(e,n)}CloseAction(){this.gui.despawn()}SetAction(){this.gui.entity.getComponent("minecraft:inventory").container.setItem(this.change.slot,this.slot.item.itemStack)}async FormAction(e){return this.CloseAction(),await rt(5),await e.show(this.gui.player)}};var V=class{static spawnEntity(e){try{return e.dimension.spawnEntity(J,e.headLocation)}catch{return null}}constructor(e){this.player=e,this.entity=V.spawnEntity(e),this.entity&&(this.id=d(this.entity),this.hasChestOpen=!1,this.setPage("home")),this.tickEvent=mt.events.tick.subscribe(()=>{if(!this.entity)return this.despawn();if(Z.get(this.player))this.hasChestOpen||(this.slotChangeEvent=Q.subscribe({type:J},(n,r)=>{d(n)==this.id&&this.onSlotChange(r)})),this.hasChestOpen=!0;else try{this.entity.teleport(this.player.headLocation,this.player.dimension,0,0)}catch{this.despawn()}})}setPage(e,n){if(!Object.keys(G).includes(e))throw new Error(`pageId ${e} does not exist!`);let r=G[e];this.page=r,r.fillType(this.entity,r,n),this.entity.nameTag="size:54"}onSlotChange(e){let n=this.page.slots[e.slot];if(!n)this.entity.getComponent("inventory").container.setItem(e.slot,R);else if(e.moveType=="delete"){if(n.item&&at(this.player,e.item),!n.item&&!st(this.entity,e.slot))return;n.action(new me(this,n,e))}}despawn(){try{this.entity?.triggerEvent("despawn")}catch{}try{delete x[this.player.name]}catch{}this.tickEvent&&mt.events.tick.unsubscribe(this.tickEvent),this.slotChangeEvent&&Q.unsubscribe(this.slotChangeEvent)}};import{ItemStack as Wt}from"mojang-minecraft";var y=class{constructor(e,n={},r){this.itemType=e,this.components=n,this.setItemStack=r}get itemStack(){if(this.setItemStack)return this.setItemStack;let e=new Wt(this.itemType);if(this.components){e.amount=this.components?.amount??1,e.data=this.components?.data??0,e.nameTag=this.components?.nameTag,e.setLore(this.components?.loreList??[]);let n=e.getComponent("enchantments").enchantments;for(let r of this.components?.enchantments??[])n.addEnchantment(r);e.getComponent("enchantments").enchantments=n}return e}};function ct(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let o=0;o<r.size;o++){let i=e.slots[o];if(!i||!i.item){r.setItem(o,R);continue}r.setItem(o,i.item.itemStack)}}var P=class{constructor(e,n=ct){if(Object.keys(G).includes(e))throw new Error(`Page: ${e}, Already exists!`);this.id=e,this.fillType=n,this.slots=[],G[e]=this}setSlots(e,n,r){let o=n?{item:n,action:r}:null;for(let i of e)this.slots[i]=o;return this}};import{MinecraftItemTypes as Te}from"mojang-minecraft";var ko=new P("home").setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,48,50,51,52,53],new y(Te.stainedGlassPane,{data:15,nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([22],new y(Te.enderChest,{nameTag:"\xA7l\xA7bInventory Viewer"}),t=>{t.PageAction("moderation:see")}).setSlots([54],new y(Te.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});ve.events.tick.subscribe(t=>{for(let e of ve.getPlayers()){if(it(e)?.id!=je){x[e.name]&&x[e.name].despawn();continue}Object.keys(x).includes(e?.name)||(x[e.name]=new V(e))}});ve.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{t.entity instanceof Xt&&(t.id=="rubedo:has_container_open"?Z.set(t.entity,!0):t.id=="rubedo:dosent_have_container_open"&&Z.set(t.entity,!1))});k(()=>{let t=Object.values(x).map(e=>e.id);for(let e of b.overworld.getEntities({type:J}))t.includes(d(e))||e.triggerEvent("despawn")},100);var c=class{constructor(e,n,r=0,o){this.data=e;this.type=n;this.depth=r;this.parent=o;e.requires||(e.requires=i=>!0),this.data=e,this.type=n??new D(this.data.name),this.children=[],this.depth=r,this.parent=o,this.callback=null,E.push(this)}argument(e){let n=new c(this.data,e,this.depth+1,this);return this.children.push(n),n}string(e){return this.argument(new U(e))}int(e){return this.argument(new H(e))}array(e,n){return this.argument(new K(e,n))}boolean(e){return this.argument(new q(e))}location(e){let n=this.argument(new M(e));return e.endsWith("*")?n:n.location(e+"_y*").location(e+"_z*")}literal(e){let n=new c(e,new D(e.name),this.depth+1,this);return this.children.push(n),n}executes(e){return this.callback=e,this}};var N=class{constructor(e,n,r,o="No Reason",i="Smelly Anti Cheat"){n=n?F(`${n} ${r}`):null;let s={key:d(e),player:e.name,date:Date.now(),length:n,expire:n?n+Date.now():null,reason:o,by:i};a.bans.set(d(e),s)}};new c({name:"ban",description:"Bans a player for lengths",requires:t=>l(t)=="admin"}).argument(new h.player("player")).executes((t,e)=>{new N(e,null,null,t.sender.name),t.reply(S["modules.commands.ban.reply"](e.name,0,"Forever","No Reason"))}).argument(new h.int("length")).argument(new h.unit("unit")).executes((t,e,n,r)=>{new N(e,n,r,null,t.sender.name),t.reply(S["modules.commands.ban.reply"](e.name,n,r,"No Reason"))}).string("reason").executes((t,e,n,r,o)=>{new N(e,n,r,o,t.sender.name),t.reply(S["modules.commands.ban.reply"](e.name,n,r,o))});var $={aquaAffinity:1,baneOfArthropods:5,binding:1,blastProtection:4,channeling:1,depthStrider:3,efficiency:5,featherFalling:4,fireAspect:2,fireProtection:4,flame:1,fortune:3,frostWalker:2,impaling:5,infinity:1,knockback:2,looting:3,loyalty:4,luckOfTheSea:3,lure:3,mending:1,multishot:1,piercing:4,power:5,projectileProtection:4,protection:4,punch:2,quickCharge:3,respiration:3,riptide:3,sharpness:5,silkTouch:1,smite:5,soulSpeed:3,swiftSneak:4,thorns:3,unbreaking:3,vanishing:1};var ee=["minecraft:beehive","minecraft:bee_nest","minecraft:acacia_standing_sign","minecraft:acacia_wall_sign","minecraft:agent_spawn_egg","minecraft:allay_spawn_egg","minecraft:allow","minecraft:axolotl_bucket","minecraft:axolotl_spawn_egg","minecraft:balloon","minecraft:bamboo_sapling","minecraft:barrier","minecraft:barrier","minecraft:bat_spawn_egg","minecraft:bedrock","minecraft:bee_nest","minecraft:bee_spawn_egg","minecraft:beehive","minecraft:birch_standing_sign","minecraft:birch_wall_sign","minecraft:blackstone_double_slab","minecraft:blaze_spawn_egg","minecraft:border_block","minecraft:brewingstandblock","minecraft:bubble_column","minecraft:camera","minecraft:carrots","minecraft:cat_spawn_egg","minecraft:cave_spider_spawn_egg","minecraft:cave_vines","minecraft:cave_vines_body_with_berries","minecraft:chain_command_block","minecraft:chemical_heat","minecraft:chemistry_table","minecraft:chicken_spawn_egg","minecraft:client_request_placeholder_block","minecraft:cobbled_deepslate_double_slab","minecraft:cod_bucket","minecraft:cod_spawn_egg","minecraft:colored_torch","minecraft:colored_torch_bp","minecraft:colored_torch_rg","minecraft:command_block","minecraft:command_block_minecart","minecraft:compound","minecraft:compoundcreator","minecraft:cow_spawn_egg","minecraft:creeper_spawn_egg","minecraft:crimson_double_slab","minecraft:crimson_standing_sign","minecraft:crimson_wall_sign","minecraft:darkoak_standing_sign","minecraft:darkoak_wall_sign","minecraft:daylight_detector_inverted","minecraft:debug_stick","minecraft:deepslate_brick_double_slab","minecraft:deepslate_tile_double_slab","minecraft:deny","minecraft:dolphin_spawn_egg","minecraft:donkey_spawn_egg","minecraft:double_cut_copper_slab","minecraft:double_wooden_slab","minecraft:drowned_spawn_egg","minecraft:elder_guardian_spawn_egg","minecraft:end_gateway","minecraft:end_portal","minecraft:end_portal_frame","minecraft:enderman_spawn_egg","minecraft:endermite_spawn_egg","minecraft:evoker_spawn_egg","minecraft:exposed_double_cut_copper_slab","minecraft:fire","minecraft:flowing_lava","minecraft:flowing_water","minecraft:fox_spawn_egg","minecraft:frog_spawn_egg","minecraft:frosted_ice","minecraft:ghast_spawn_egg","minecraft:glow_squid_spawn_egg","minecraft:glow_stick","minecraft:glowingobsidian","minecraft:goat_spawn_egg","minecraft:guardian_spawn_egg","minecraft:hard_glass","minecraft:hard_glass_pane","minecraft:hard_stained_glass","minecraft:hard_stained_glass_pane","minecraft:hoglin_spawn_egg","minecraft:horse_spawn_egg","minecraft:husk_spawn_egg","minecraft:ice_bomb","minecraft:info_update","minecraft:info_update2","minecraft:invisible_bedrock","minecraft:invisiblebedrock","minecraft:item.acacia_door","minecraft:item.bed","minecraft:item.beetroot","minecraft:item.birch_door","minecraft:item.cake","minecraft:item.campfire","minecraft:item.cauldron","minecraft:item.chain","minecraft:item.crimson_door","minecraft:item.dark_oak_door","minecraft:item.flower_pot","minecraft:item.frame","minecraft:item.glow_frame","minecraft:item.hopper","minecraft:item.iron_door","minecraft:item.jungle_door","minecraft:item.kelp","minecraft:item.nether_sprouts","minecraft:item.nether_wart","minecraft:item.reeds","minecraft:item.skull","minecraft:item.soul_campfire","minecraft:item.spruce_door","minecraft:item.warped_door","minecraft:item.wheat","minecraft:item.wooden_door","minecraft:jigsaw","minecraft:jungle_standing_sign","minecraft:jungle_wall_sign","minecraft:lava","minecraft:lava_cauldron","minecraft:light_block","minecraft:lit_blast_furnace","minecraft:lit_deepslate_redstone_ore","minecraft:lit_furnace","minecraft:lit_redstone_lamp","minecraft:lit_redstone_ore","minecraft:lit_smoker","minecraft:llama_spawn_egg","minecraft:magma_cube_spawn_egg","minecraft:medicine","minecraft:melon_stem","minecraft:mob_spawner","minecraft:mooshroom_spawn_egg","minecraft:movingBlock","minecraft:moving_block","minecraft:movingblock","minecraft:mule_spawn_egg","minecraft:netherreactor","minecraft:npc_spawn","minecraft:npc_spawn_egg","minecraft:ocelot_spawn_egg","minecraft:oxidized_double_cut_copper_slab","minecraft:panda_spawn_egg","minecraft:parrot_spawn_egg","minecraft:phantom_spawn_egg","minecraft:pig_spawn_egg","minecraft:piglin_brute_spawn_egg","minecraft:piglin_spawn_egg","minecraft:pillager_spawn_egg","minecraft:piston_arm_collision","minecraft:piston_arm_collision","minecraft:pistonarmcollision","minecraft:polar_bear_spawn_egg","minecraft:polished_blackstone_brick_double_slab","minecraft:polished_blackstone_double_slab","minecraft:polished_deepslate_double_slab","minecraft:portal","minecraft:potatoes","minecraft:powder_snow","minecraft:powder_snow_bucket","minecraft:powered_comparator","minecraft:powered_repeater","minecraft:pufferfish_bucket","minecraft:pufferfish_spawn_egg","minecraft:pumpkin_stem","minecraft:rabbit_spawn_egg","minecraft:rapid_fertilizer","minecraft:ravager_spawn_egg","minecraft:real_double_stone_slab","minecraft:real_double_stone_slab2","minecraft:real_double_stone_slab3","minecraft:real_double_stone_slab4","minecraft:redstone_wire","minecraft:repeating_command_block","minecraft:reserved3","minecraft:reserved4","minecraft:reserved6","minecraft:salmon_bucket","minecraft:salmon_spawn_egg","minecraft:sea_turtle_spawn_egg","minecraft:sheep_spawn_egg","minecraft:shulker_spawn_egg","minecraft:silverfish_spawn_egg","minecraft:skeleton_horse_spawn_egg","minecraft:skeleton_spawn_egg","minecraft:slime_spawn_egg","minecraft:soul_fire","minecraft:soul_fire","minecraft:sparkler","minecraft:spawn_egg","minecraft:spawn_egg","minecraft:spawner","minecraft:spider_spawn_egg","minecraft:spruce_standing_sign","minecraft:spruce_wall_sign","minecraft:squid_spawn_egg","minecraft:standing_banner","minecraft:standing_sign","minecraft:stickyPistonArmCollision","minecraft:sticky_piston_arm_collision","minecraft:stonecutter","minecraft:stray_spawn_egg","minecraft:strider_spawn_egg","minecraft:structure_block","minecraft:structure_void","minecraft:tadpole_bucket","minecraft:tadpole_spawn_egg","minecraft:tripwire","minecraft:tropical_fish_bucket","minecraft:tropical_fish_spawn_egg","minecraft:underwater_torch","minecraft:unknown","minecraft:unlit_redstone_ore","minecraft:unpowered_comparator","minecraft:unpowered_repeater","minecraft:vex_spawn_egg","minecraft:villager_spawn_egg","minecraft:vindicator_spawn_egg","minecraft:wall_banner","minecraft:wall_sign","minecraft:wandering_trader_spawn_egg","minecraft:warden_spawn_egg","minecraft:warped_double_slab","minecraft:warped_standing_sign","minecraft:warped_wall_sign","minecraft:water","minecraft:waxed_double_cut_copper_slab","minecraft:waxed_exposed_double_cut_copper_slab","minecraft:waxed_oxidized_double_cut_copper_slab","minecraft:waxed_weathered_double_cut_copper_slab","minecraft:weathered_double_cut_copper_slab","minecraft:witch_spawn_egg","minecraft:wither_spawn_egg","minecraft:wolf_spawn_egg","minecraft:zoglin_spawn_egg","minecraft:zombie_horse_spawn_egg","minecraft:zombie_spawn_egg","minecraft:zombie_villager_spawn_egg","minecraft:zombified_piglin_spawn_egg"],te=["minecraft:moving_block","minecraft:beehive","minecraft:beenest"],ce=["minecraft:chest","minecraft:trapped_chest"],O={x:7,y:7,z:7};var Ae=new c({name:"config",description:"Opens up a form to configure rubedo",requires:t=>l(t)=="admin"}),lt=Ae.literal({name:"banned",description:"Manages banned items/blocks on this server"}),pt=lt.literal({name:"items",description:"Manages the banned items on this server"});pt.literal({name:"add",description:"Adds a item to the banned items list"}).string("item").executes((t,e)=>{let n=a.config.get("banned_items")??ee;n.includes(e)||n.push(e),a.config.set("banned_items",n),t.reply(`Banned the item "${e}"`)});pt.literal({name:"remove",description:"Removes a item from the banned items list"}).string("item").executes((t,e)=>{let n=a.config.get("banned_items")??ee;if(!n.includes(e))return t.reply(`item: "${e}" is not banned`);n=n.filter(r=>r!=e),a.config.set("banned_items",n),t.reply(`Removed Banned item "${e}"`)});var ft=lt.literal({name:"blocks",description:"Manages the banned blocks on this server"});ft.literal({name:"add",description:"Adds a block to the banned blocks list"}).string("block").executes((t,e)=>{let n=a.config.get("banned_blocks")??te;n.includes(e)||n.push(e),a.config.set("banned_blocks",e),t.reply(`Banned the block "${e}"`)});ft.literal({name:"remove",description:"Removes a block from the banned blocks list"}).string("block").executes((t,e)=>{let n=a.config.get("banned_blocks")??te;if(!n.includes(e))return t.reply(`block: "${e}" is not banned`);n=n.filter(r=>r!=e),a.config.set("banned_blocks",e),t.reply(`Removed Banned block "${e}"`)});var dt=Ae.literal({name:"enchantments",description:"Manages the maxEnchants on this srrver"});dt.literal({name:"set",description:"Sets a enchantment to a level"}).array("enchantment",Object.keys($)).int("level").executes((t,e,n)=>{let r=a.config.get("enchantments")??$;r[e]=n,a.config.set("enchantments",r),t.reply(`Set max level for ${e} to ${n}`)});dt.literal({name:"get",description:"Gets the max level for a enchantment"}).array("enchantment",Object.keys($)).executes((t,e)=>{let n=a.config.get("enchantments")??$;t.reply(`Max level for ${e} is ${n[e]}`)});Ae.literal({name:"setAppealLink",description:"Sets the appeal link for this server"}).string("link").executes((t,e)=>{a.config.set("appealLink",e),t.reply(`Changed the servers appeal link to ${e}`)});var xe=new c({name:"database",description:"Interacts with SA Database",aliases:["db"],requires:t=>l(t)=="admin"});xe.literal({name:"get"}).string("table").string("key").executes((t,e,n)=>{try{let r=a[e].get(n);r?t.reply(r):t.reply(`No data could be found for key ${n}`)}catch(r){t.reply(r+r.stack)}});xe.literal({name:"set"}).string("table").string("key").string("value").executes((t,e,n,r)=>{try{a[e].set(n,r),t.reply(`Set Key: "${n}", to value: "${r}" on table: "${e}"`)}catch(o){t.reply(o+o.stack)}});xe.literal({name:"clear"}).string("table").executes((t,e)=>{try{a[e].clear(),t.reply(`Cleared Table ${e}`)}catch(n){t.reply(n+n.stack)}});new c({name:"ecwipe",description:"Clears a players ender chest",requires:t=>l(t)=="admin"}).argument(new h.player("player")).executes((t,e)=>{for(let n=0;n<27;n++)e.runCommand(`replaceitem entity @s slot.enderchest ${n} air`);t.reply(`Cleared ${e.name} Ender chest!`)});var le=class{constructor(e,n="No Reason"){let r={player:e.name,key:d(e),reason:n,location:{x:e.location.x,y:e.location.y,z:e.location.z,dimension:e.dimension.id}};a.freezes.set(d(e),r)}};new c({name:"freeze",description:"Freeze a player",requires:t=>l(t)=="admin"}).argument(new h.player("player")).string("reason").executes((t,e,n)=>{new le(e,n),t.reply(`\xA7cFroze \xA7f"\xA7a${e.name}\xA7f" Because: "${n}" \xA7aSuccessfully`),t.sender.tell(`\xA7cYou have been frozen by \xA7f"\xA7a${t.sender.name}\xA7f" Because: "${n}"`)});var Re=class{constructor(e){this.name=e;this.typeName="CommandName"}matches(e){return{success:Boolean(E.find(n=>n.depth==0&&n.data.name==e)),value:e}}};function Qt(t,e,n){n.tell(`${C}${t.data.name} ${e.map(r=>r.type.typeName=="literal"?r.data.name:`<${r.type.name}: ${r.type.typeName}>`).join(" ")}`)}function pe(t,e,n,r){if(!e.data?.requires(r))return console.warn(`no perm ${e.data.name}`);if(e.callback&&Qt(t,e.depth==0?n:n.concat(e),r),e.children.length>0)for(let o of e.children)pe(t,o,e.depth==0?n:n.concat(e),r)}function ut(t,e,n){t.tell({rawtext:[{text:`\xA72--- Showing help page ${e} of ${n} (${C}help <page: int>) ---`}]})}function gt(t){let e=E.filter(n=>n.depth==0&&n.data?.requires(t));return e.length==0?0:Math.ceil(e.length/5)}var yt=new c({name:"help",description:"Provides help/list of commands.",aliases:["?","h"]}).executes(t=>{let e=gt(t.sender),n=E.filter(r=>r.depth==0&&r.data?.requires(t.sender)).slice(1*5-5,1*5);ut(t.sender,1,e);for(let r of n)pe(r,r,[],t.sender)});yt.int("page").executes((t,e)=>{let n=gt(t.sender);e>n&&(e=n);let r=E.filter(o=>o.depth==0&&o.data?.requires(t.sender)).slice(e*5-5,e*5);ut(t.sender,e,n);for(let o of r)pe(o,o,[],t.sender)});yt.argument(new Re("command")).executes((t,e)=>{let n=E.filter(r=>r.depth==0&&r.data.name==e)[0];pe(n,n,[],t.sender)});var L=class{static getMuteData(e){return a.mutes.get(e.name)}constructor(e,n,r,o="No Reason",i="Smelly Anti Cheat"){e.runCommand("ability @s mute true");let s=n?F(`${n} ${r}`):null,p={player:e.name,date:Date.now(),length:s,expire:s?s+Date.now():null,reason:o,by:i};a.mutes.set(e.name,p)}};new c({name:"mute",description:"Mute a player for lengths",requires:t=>["admin","moderator"].includes(l(t))}).argument(new h.player("player")).argument(new h.int("length")).argument(new h.unit("unit")).string("reason").executes((t,e,n,r,o)=>{new L(e,n,r,o,t.sender.name),t.reply(`\xA7cMuted \xA7f"\xA7a${e.name}\xA7f" \xA7cfor ${n} ${r} Because: "${o}" \xA7aSuccessfully`),e.tell(`\xA7cYou have been muted by \xA7f"${t.sender.name}" \xA7cfor ${n} ${r} Because: "${o}"`)});var j=class{static isVaild(e){if(e.id!="minecraft:npc")return!1;if(fe.find(r=>r.equals(e.location)))return!0;let n=d(e);return!!a.npcs.keys().find(r=>n==r)}constructor(e,n){fe.push(e);let r=n.spawnEntity("minecraft:npc",e),o={dimension:r.dimension.id,x:r.location.x,y:r.location.y,z:r.location.z};a.npcs.set(d(r),o),ht()}};new c({name:"npc",description:"Spawns a npc at your coordinates",requires:t=>l(t)=="admin"}).executes(t=>{new j(t.sender.location,t.sender.dimension),t.reply("Spawned a verifed npc at your current location")});import{world as bt}from"mojang-minecraft";new c({name:"ping",description:"Returns the current TPS of the servers ping"}).executes(t=>{let e=bt.events.tick.subscribe(({deltaTime:n})=>{t.reply(`Pong! Current TPS: ${1/n}`),bt.events.tick.unsubscribe(e)})});import{BlockLocation as ne}from"mojang-minecraft";var re=new c({name:"region",description:"Create a Region",requires:t=>l(t)=="admin"});re.literal({name:"add",description:"Adds a new protection region"}).int("from_x").int("from_z").int("to_x").int("to_z").executes((t,e,n,r,o)=>{new u({x:e,z:n},{x:r,z:o},t.sender.dimension.id),t.reply(`Created Region From ${e} -64 ${n} ${r} 320 ${o}`)});re.literal({name:"remove",description:"Removes a region at the players current postion"}).executes(t=>{let e=new ne(t.sender.location.x,t.sender.location.y,t.sender.location.z);u.removeRegionAtBlockLocation(e,t.sender.dimension.id)?t.reply(`Removed Region at ${e.x} ${e.y} ${e.z}`):t.reply(`Failed to find/remove region at ${e.x} ${e.y} ${e.z}`)});re.literal({name:"removeAll",description:"Removes all regions"}).executes(t=>{u.getAllRegions().forEach(e=>e.delete()),t.reply("Removed All regions")});re.literal({name:"list",description:"Lists all regions and positions"}).executes(t=>{let e=u.getAllRegions();for(let n of e)t.reply(`Region from ${n.from.x}, ${n.from.z} to ${n.to.x}, ${n.to.z} in dimension ${n.dimensionId}`);if(e.length==0)return t.reply("No regions have been made yet")});var Pe=re.literal({name:"permission",description:"Handels permissions for regions"});Pe.literal({name:"set",description:"Sets a certin permission on the region the player is currently in to a value"}).array("key",["doorsAndSwitches","openContainers","pvp"]).boolean("value").executes((t,e,n)=>{let r=u.blockLocationInRegion(new ne(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!r)return t.reply("You are not in a region");r.changePermission(e,n),t.reply(`Changed permision ${e} to ${n}`)});Pe.literal({name:"list",description:"Lists the permissions for the current region"}).executes(t=>{let e=u.blockLocationInRegion(new ne(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!e)return t.reply("You are not in a region");t.reply(`Current region permissions ${JSON.stringify(e.permissions)}`)});var _t=Pe.literal({name:"entities",description:"Holds the subCommands for adding or removing allowedEntitys"});_t.literal({name:"add",description:"Adds a entity to the allowed entitys list"}).string("entity").executes((t,e)=>{let n=u.blockLocationInRegion(new ne(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;r.push(e),n.changePermission("allowedEntitys",r),t.reply(`Added entity ${e} to the allowed entitys of the region your currently standing in`)});_t.literal({name:"remove",description:"Removes a entity from the allowed entitys in the region"}).string("entity").executes((t,e)=>{let n=u.blockLocationInRegion(new ne(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;if(!r.includes(e))return t.reply(`The entity ${e} is not allowed to enter the region`);r=r.filter(o=>o!=e),n.changePermission("allowedEntitys",r),t.reply(`Removed entity ${e} to the allowed entitys of the region your currently standing in`)});import{world as Zt}from"mojang-minecraft";var Ne=(o=>(o[o.member=0]="member",o[o.admin=1]="admin",o[o.moderator=2]="moderator",o[o.builder=3]="builder",o))(Ne||{});var en=t=>isNaN(Number(t))===!1;function tn(t){return Object.keys(t).filter(en).map(e=>t[e])}var It=new c({name:"role",description:"Changes the role for a player",requires:t=>l(t)=="admin"||Zt.getDynamicProperty("worldsOwner")==d(t)});It.literal({name:"set",description:"Sets the role for a player"}).string("playerName").argument(new h.array("role",tn(Ne))).executes((t,e,n)=>{z(e,n),t.reply(`Changed role of ${e} to ${n}`)});It.literal({name:"get",description:"Gets the role of a player"}).string("playerName").executes((t,e)=>{t.reply(`${e} has role: ${l(e)}`)});import{world as wt}from"mojang-minecraft";new c({name:"vanish",description:"Toggles Vanish Mode on the sender",requires:t=>l(t)=="admin"}).boolean("say").executes((t,e)=>{if(t.sender.hasTag("spectator")){if(t.sender.runCommand("gamemode c"),t.sender.runCommand("event entity @s removeSpectator"),t.sender.removeTag("spectator"),!e)return;wt.say({rawtext:[{translate:"multiplayer.player.joined",with:[`\xA7e${t.sender.name}`]}]})}else{if(t.sender.runCommand("gamemode spectator"),t.sender.runCommand("event entity @s addSpectator"),t.sender.addTag("spectator"),!e)return;wt.say({rawtext:[{translate:"multiplayer.player.left",with:[`\xA7e${t.sender.name}`]}]})}});new c({name:"unban",description:"Unban a banned player",requires:t=>l(t)=="admin"}).string("playerName").executes((t,e)=>{let n=a.bans.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not banned`);a.bans.delete(n.key),t.reply(`\xA7a${e}\xA7r has been Unbanned!`)});new c({name:"unfreeze",description:"Unfreeze a frozen player",requires:t=>l(t)=="admin"}).string("playerName").executes((t,e)=>{let n=a.freezes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not frozen`);a.freezes.delete(n.key),t.reply(`\xA7a${e}\xA7r has been UnFrozen!`)});new c({name:"unmute",description:"Unmutes a muted player",requires:t=>["admin","moderator"].includes(l(t))}).string("playerName").executes((t,e)=>{let n=a.mutes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not muted!`);a.mutes.delete(n.player);try{t.sender.runCommand(`ability "${e}" mute false`)}catch{}t.reply(`\xA7a${e}\xA7r has been UnMuted!`)});var kt="2.4.4-beta";var Ct="https://discord.gg/dMa3A5UYKX";new c({name:"version",description:"Get Current Version",aliases:["v"]}).executes(t=>{t.reply(`Current Rubedo Version: ${kt}`)});I(t=>{try{let e=d(t),n=a.bans.get(e);if(!n)return;if(n.expire&&n.expire<Date.now())return a.bans.delete(e);se(t,["\xA7cYou have been banned!",`\xA7aReason: \xA7f${n.reason}`,`\xA7fExpiry: \xA7b${n.expire?F(n.length):"Forever"}`,`\xA7fAppeal at: \xA7b${a.config.get("appealLink")??Ct}`],()=>{a.bans.delete(e)})}catch(e){console.warn(e+e.stack)}},20);import{Location as nn}from"mojang-minecraft";I(t=>{let e=a.freezes.get(d(t));!e||t.teleport(new nn(e.location.x,e.location.y,e.location.z),b[e.location.dimension],0,0)},20);import{world as rn}from"mojang-minecraft";rn.events.beforeChat.subscribe(t=>{if(t.message.startsWith(C))return;let e=L.getMuteData(t.sender);if(!!e){if(e.expire&&e.expire<Date.now())return a.mutes.delete(t.sender.name);t.cancel=!0,t.sender.tell(S["modules.managers.mute.isMuted"]())}});import{BlockLocation as on,world as Le}from"mojang-minecraft";k(()=>{ae()},6e3);Le.events.beforeItemUseOn.subscribe(t=>{if(["moderator","admin"].includes(l(t.source)))return;let e=u.blockLocationInRegion(t.blockLocation,t.source.dimension.id);if(!e)return;let n=t.source.dimension.getBlock(t.blockLocation);qe.includes(n.id)&&e.permissions.doorsAndSwitches||Ke.includes(n.id)&&e.permissions.openContainers||(t.cancel=!0)});Le.events.beforeExplosion.subscribe(t=>{for(let e=0;e<t.impactedBlocks.length;e++){let n=t.impactedBlocks[e];if(u.blockLocationInRegion(n,t.dimension.id))return t.cancel=!0}});Le.events.entityCreate.subscribe(t=>{let e=u.blockLocationInRegion(new on(t.entity.location.x,t.entity.location.y,t.entity.location.z),t.entity.dimension.id);!e||e.permissions.allowedEntitys.includes(t.entity.id)||(t.entity.teleport({x:0,y:-64,z:0},t.entity.dimension,0,0),t.entity.kill())});k(()=>{for(let t of u.getAllRegions())for(let e of b[t.dimensionId].getEntities({excludeTypes:t.permissions.allowedEntitys}))!t.entityInRegion(e)||(e.teleport({x:0,y:-64,z:0},e.dimension,0,0),e.kill())},100);I(t=>{for(let e of u.getAllRegions())e.entityInRegion(t)?(t.addTag("inRegion"),e.permissions.pvp||t.addTag("region-protected")):(t.removeTag("inRegion"),t.removeTag("region-protected"))},5);import{world as De}from"mojang-minecraft";De.events.playerJoin.subscribe(({player:t})=>{let e=De.events.tick.subscribe(n=>{try{b.overworld.runCommand(`testfor @a[name="${t.name}"]`),De.events.tick.unsubscribe(e),L.getMuteData(t)&&t.runCommand("ability @s mute true");let r=T.getPlayersRoleToSet(t.name);r&&z(t,r)}catch{}})});import{Items as an,MinecraftItemTypes as w,world as Me}from"mojang-minecraft";var Et=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],sn=[10,11,12,13,14,15,16,19,20,21,22,23,24,25,28,29,30,31,32,33,34,37,38,39,40,41,42,43];function mn(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let o=0;o<r.size;o++){let i=e.slots[o];if(!i||!i.item){r.setItem(o,R);continue}r.setItem(o,i.item.itemStack)}for(let[o,i]of[...Me.getPlayers()].entries()){let s=Et[o],p=new y(w.skull,{nameTag:i.name,data:3});r.setItem(s,p.itemStack),e.slots[s]={item:p,action:m=>{m.PageAction("moderation:see_inventory",{name:i.name})}}}}function cn(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let m=0;m<r.size;m++){let f=e.slots[m];if(!f||!f.item){r.setItem(m,R);continue}r.setItem(m,f.item.itemStack)}let o=new y(w.enderChest,{nameTag:`\xA7eView \xA7f${n?.name}\xA7e Ender Chest
\xA7fNote: \xA7cThis will not grab \xA7lANY NBT!\xA7r`});r.setItem(49,o.itemStack),e.slots[49]={item:o,action:m=>{m.PageAction("moderation:see_ender_chest",{name:n.name})}};let i=[...Me.getPlayers()].find(m=>m.name==n.name);if(!i)return;let s=i.getComponent("inventory").container,p=0;for(let m=0;m<s.size;m++){let f=s.getItem(m);if(!f)continue;let _=Et[p];p++,r.setItem(_,f),e.slots[_]={item:new y(an.get(f.id),{amount:f.amount,data:f.data},f),action:Pt=>{m<9?i.runCommand(`replaceitem entity @s slot.hotbar ${m} air`):i.runCommand(`replaceitem entity @s slot.inventory ${m-9} air`),Pt.GiveAction(),e.slots[_]={item:null,action:Nt=>{s.addItem(Nt.getItemAdded())}}}}}}function ln(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let s=0;s<r.size;s++){let p=e.slots[s];if(!p||!p.item){r.setItem(s,R);continue}r.setItem(s,p.item.itemStack)}let o=[...Me.getPlayers()].find(s=>s.name==n?.name);if(!o)return;let i=0;for(let s of Object.values(w))try{o.runCommand(`testfor @s[hasitem={item=${s.id},location=slot.enderchest}]`);let p=new y(s.id,{nameTag:"Note: \xA7l\xA7cThis is not the exzact item"}),m=sn[i];r.setItem(m,p.itemStack),e.slots[m]={item:p,action:f=>{f.GiveAction(),e.slots[m]=null}},i++}catch{}}new P("moderation:see",mn).setSlots([45,46,47,49,51,52,53],new y(w.stainedGlassPane,{nameTag:"\xA7r",data:15}),t=>{t.SetAction()}).setSlots([50],new y(w.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("home")}).setSlots([48],new y(w.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});new P("moderation:see_inventory",cn).setSlots([45,46,47,49,51,52,53],new y(w.stainedGlassPane,{nameTag:"\xA7r",data:15}),t=>{t.SetAction()}).setSlots([50],new y(w.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setSlots([48],new y(w.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});new P("moderation:see_ender_chest",ln).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,49,51,52,53],new y(w.stainedGlassPane,{nameTag:"\xA7r",data:15}),t=>{t.SetAction()}).setSlots([50],new y(w.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setSlots([48],new y(w.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});import{ItemStack as pn,MinecraftItemTypes as fn,world as dn}from"mojang-minecraft";var un=new pn(fn.stick,0),gn=["minecraft:command_block_minecart"];I(t=>{let e=t.getComponent("inventory").container;for(let n=0;n<e.size;n++){let r=e.getItem(n);if(!r)continue;let o=()=>t.getComponent("inventory").container.setItem(n,un);if((a.config.get("banned_items")??ee).includes(r.id))return o();let s=r.getComponent("enchantments").enchantments,p=a.config.get("enchantments")??$,m=[];for(let f of s){let _=p[f.type.id]??f.type.maxLevel;if(s.slot==0&&!s.canAddEnchantment(f)||f.level>_||m.includes(f.type.id))return o();m.push(f.type.id)}}});dn.events.entityCreate.subscribe(t=>{let e=()=>{try{t.entity.triggerEvent("despawn"),t.entity.kill()}catch{t.entity.kill()}};if(gn.includes(t.entity.id)||t.entity.id=="minecraft:npc"&&!j.isVaild(t.entity))return e()});var $e=1e5;I(t=>{(Math.abs(t.location.x)>$e||Math.abs(t.location.y)>$e||Math.abs(t.location.z)>$e)&&new N(t,null,null,"Hacking: Crasher")});import{world as St}from"mojang-minecraft";var de=class{constructor(e,n,r){this.player=e,this.location=e.location,this.dimension=e.dimension,this.rotation=e.rotation,this.tick=n,this.storage=r,this.events={playerLeave:St.events.playerLeave.subscribe(({playerName:o})=>{o==this.player.name&&this.expire()})},this.storage.set(e,this)}back(){this.player.teleport(this.location,this.dimension,this.rotation.x,this.rotation.y)}update(){this.tick=Y,this.location=this.player.location,this.dimension=this.player.dimension,this.rotation=this.player.rotation}expire(){this.storage.delete(this.player);for(let e in this.events)St.events[e].unsubscribe(this.events[e])}};var Tt=new A,yn=.9,hn=20,bn=!0,_n=["gliding","riding","levitating","swimming"];function In(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}I((t,{currentTick:e})=>{if(t.getTags().some(o=>_n.includes(o)))return;let n=()=>Tt.get(t)??new de(t,e,Tt),r=Math.sqrt(t.velocity.x**2+t.velocity.z**2);if(t.hasTag("on_ground"))return n().update();if(!(r<yn)&&In(t)?.id!="minecraft:trident"&&!(e-n().tick<hn)&&(n().back(),bn))try{t.runCommand("damage @s 4 fly_into_wall")}catch{}},20);import{GameMode as wn,world as kn}from"mojang-minecraft";var Cn=wn.creative;k(()=>{for(let t of kn.getPlayers({gameMode:Cn})){if(["moderator","admin","builder"].includes(l(t)))return;try{t.runCommand("gamemode s"),t.runCommand("clear @s")}catch{}}},20);import{world as vt}from"mojang-minecraft";var En=/^([\p{L}])([\p{L}\d\s#'()-_]{1,20})([\p{L}\d\)])$/isu,Sn="\xA7c\xA7k\xA7m\xA7A\xA7r\xA7cToolbox Gamer\xA7k\xA7mA\xA7r";vt.events.playerJoin.subscribe(({player:t})=>{let e=t.name,n=()=>se(t,["\xA7cYou have been kicked!",`\xA7aReason: \xA7f'${e}' is Invalid`,"\xA7fThis Server requires you to have a valid gamertag!"]);if(e==Sn||!En.test(e)||[...vt.getPlayers()].filter(r=>r.name==t.name).length>1)return n()});import{world as vn,Location as An}from"mojang-minecraft";import{world as Tn}from"mojang-minecraft";var ue=class{constructor(e){this.emptySlotsCount=e.emptySlotsCount,this.size=e.size,this.items=[];for(let n=0;n<this.size;n++)this.items[n]=e.getItem(n)}load(e){for(let n=0;n<e.size;n++)!this.items[n]||e.setItem(n,this.items[n])}};var ge={};k(()=>{ge={};for(let t of Tn.getPlayers()){let e=et(t.location),n=e.offset(O.x,O.y,O.z),r=e.offset(-O.x,-O.y,-O.z);for(let o of n.blocksBetween(r)){if(o.y<-64)continue;let i=t.dimension.getBlock(o);!ce.includes(i.id)||(ge[JSON.stringify(o)]=new ue(i.getComponent("inventory").container))}}},100);var At=new A,xn=70,Rn=["snow","lush_plants_replaceable","azalea_log_replaceable","minecraft:crop","fertilize_area"],Pn=["minecraft:water","minecraft:flowing_water","minecraft:lava","minecraft:flowing_lava","minecraft:bedrock"];vn.events.blockBreak.subscribe(({block:t,brokenBlockPermutation:e,dimension:n,player:r})=>{if(["moderator","admin"].includes(l(r))||t.getTags().some(i=>Rn.includes(i)))return;let o=At.get(r);if(At.set(r,Date.now()),!!o&&!Pn.includes(t.id)&&!(o<Date.now()-xn)){if(n.getBlock(t.location).setPermutation(e.clone()),ce.includes(e.type.id)){let i=ge[JSON.stringify(t.location)];i&&i.load(t.getComponent("inventory").container)}Ee(()=>{[...n.getEntities({maxDistance:2,type:"minecraft:item",location:new An(t.location.x,t.location.y,t.location.z)})].forEach(i=>i.kill())},0)}});import{world as Nn,MinecraftBlockTypes as Ln}from"mojang-minecraft";Nn.events.blockPlace.subscribe(({block:t,player:e})=>{if(["moderator","admin"].includes(l(e)))return;(a.config.get("banned_blocks")??te).includes(t.id)&&t.setType(Ln.air)});import{Player as Dn,world as oe}from"mojang-minecraft";var Mn=oe.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{if(oe.getDynamicProperty("roleHasBeenSet"))return oe.events.beforeDataDrivenEntityTriggerEvent.unsubscribe(Mn);t.entity instanceof Dn&&t.id=="rubedo:becomeAdmin"&&(z(t.entity,"admin"),oe.setDynamicProperty("roleHasBeenSet",!0),oe.setDynamicProperty("worldsOwner",d(t.entity)),t.entity.tell("\xA7l\xA7cYou have been given admin, the function start will not work anymore!!!!"))});import{system as $n}from"mojang-minecraft";$n.events.beforeWatchdogTerminate.subscribe(t=>{t.cancel=!0,console.warn(`WATCHDOG TRIED TO CRASH = ${t.terminateReason}`)});import{DynamicPropertiesDefinition as Oe,EntityTypes as On,MinecraftEntityTypes as Bn,world as Rt}from"mojang-minecraft";var xt=[];Rt.events.worldInitialize.subscribe(({propertyRegistry:t})=>{Ze("tickingarea add 0 0 0 0 0 0 db true");let e=new Oe;e.defineString("name",30),e.defineNumber("index"),t.registerEntityTypeDynamicProperties(e,On.get(W));let n=new Oe;n.defineString("role",30),t.registerEntityTypeDynamicProperties(n,Bn.player);let r=new Oe;r.defineBoolean("roleHasBeenSet"),r.defineString("worldsOwner",100),t.registerWorldDynamicProperties(r);for(let o of xt)Rt.scoreboard.addObjective(o.objective,o.displayName??"")});console.warn("---- STARTING RUBEDO ----");var fe=[];function ht(){fe=[]}var Y=null,R=new zn(Fn.stick,0);Gn.events.tick.subscribe(t=>{Y?Y=Y+1:Y=t.currentTick});export{R as AIR,Y as CURRENT_TICK,fe as NPC_LOCATIONS,ht as clearNpcLocations};
