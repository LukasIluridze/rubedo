var se=["minecraft:beehive","minecraft:beenest","minecraft:acacia_standing_sign","minecraft:acacia_wall_sign","minecraft:agent_spawn_egg","minecraft:allay_spawn_egg","minecraft:allow","minecraft:axolotl_bucket","minecraft:axolotl_spawn_egg","minecraft:balloon","minecraft:bamboo_sapling","minecraft:barrier","minecraft:barrier","minecraft:bat_spawn_egg","minecraft:bedrock","minecraft:bee_nest","minecraft:bee_spawn_egg","minecraft:beehive","minecraft:birch_standing_sign","minecraft:birch_wall_sign","minecraft:blackstone_double_slab","minecraft:blaze_spawn_egg","minecraft:border_block","minecraft:brewingstandblock","minecraft:bubble_column","minecraft:camera","minecraft:carrots","minecraft:cat_spawn_egg","minecraft:cave_spider_spawn_egg","minecraft:cave_vines","minecraft:cave_vines_body_with_berries","minecraft:chain_command_block","minecraft:chemical_heat","minecraft:chemistry_table","minecraft:chicken_spawn_egg","minecraft:client_request_placeholder_block","minecraft:cobbled_deepslate_double_slab","minecraft:cod_bucket","minecraft:cod_spawn_egg","minecraft:colored_torch","minecraft:colored_torch_bp","minecraft:colored_torch_rg","minecraft:command_block","minecraft:command_block_minecart","minecraft:compound","minecraft:compoundcreator","minecraft:cow_spawn_egg","minecraft:creeper_spawn_egg","minecraft:crimson_double_slab","minecraft:crimson_standing_sign","minecraft:crimson_wall_sign","minecraft:darkoak_standing_sign","minecraft:darkoak_wall_sign","minecraft:daylight_detector_inverted","minecraft:debug_stick","minecraft:deepslate_brick_double_slab","minecraft:deepslate_tile_double_slab","minecraft:deny","minecraft:dolphin_spawn_egg","minecraft:donkey_spawn_egg","minecraft:double_cut_copper_slab","minecraft:double_wooden_slab","minecraft:drowned_spawn_egg","minecraft:elder_guardian_spawn_egg","minecraft:end_gateway","minecraft:end_portal","minecraft:end_portal_frame","minecraft:enderman_spawn_egg","minecraft:endermite_spawn_egg","minecraft:evoker_spawn_egg","minecraft:exposed_double_cut_copper_slab","minecraft:fire","minecraft:flowing_lava","minecraft:flowing_water","minecraft:fox_spawn_egg","minecraft:frog_spawn_egg","minecraft:frosted_ice","minecraft:ghast_spawn_egg","minecraft:glow_squid_spawn_egg","minecraft:glow_stick","minecraft:glowingobsidian","minecraft:goat_spawn_egg","minecraft:guardian_spawn_egg","minecraft:hard_glass","minecraft:hard_glass_pane","minecraft:hard_stained_glass","minecraft:hard_stained_glass_pane","minecraft:hoglin_spawn_egg","minecraft:horse_spawn_egg","minecraft:husk_spawn_egg","minecraft:ice_bomb","minecraft:info_update","minecraft:info_update2","minecraft:invisible_bedrock","minecraft:invisiblebedrock","minecraft:item.acacia_door","minecraft:item.bed","minecraft:item.beetroot","minecraft:item.birch_door","minecraft:item.cake","minecraft:item.campfire","minecraft:item.cauldron","minecraft:item.chain","minecraft:item.crimson_door","minecraft:item.dark_oak_door","minecraft:item.flower_pot","minecraft:item.frame","minecraft:item.glow_frame","minecraft:item.hopper","minecraft:item.iron_door","minecraft:item.jungle_door","minecraft:item.kelp","minecraft:item.nether_sprouts","minecraft:item.nether_wart","minecraft:item.reeds","minecraft:item.skull","minecraft:item.soul_campfire","minecraft:item.spruce_door","minecraft:item.warped_door","minecraft:item.wheat","minecraft:item.wooden_door","minecraft:jigsaw","minecraft:jungle_standing_sign","minecraft:jungle_wall_sign","minecraft:lava","minecraft:lava_cauldron","minecraft:light_block","minecraft:lit_blast_furnace","minecraft:lit_deepslate_redstone_ore","minecraft:lit_furnace","minecraft:lit_redstone_lamp","minecraft:lit_redstone_ore","minecraft:lit_smoker","minecraft:llama_spawn_egg","minecraft:magma_cube_spawn_egg","minecraft:medicine","minecraft:melon_stem","minecraft:mob_spawner","minecraft:mooshroom_spawn_egg","minecraft:movingBlock","minecraft:moving_block","minecraft:movingblock","minecraft:mule_spawn_egg","minecraft:netherreactor","minecraft:npc_spawn","minecraft:npc_spawn_egg","minecraft:ocelot_spawn_egg","minecraft:oxidized_double_cut_copper_slab","minecraft:panda_spawn_egg","minecraft:parrot_spawn_egg","minecraft:phantom_spawn_egg","minecraft:pig_spawn_egg","minecraft:piglin_brute_spawn_egg","minecraft:piglin_spawn_egg","minecraft:pillager_spawn_egg","minecraft:piston_arm_collision","minecraft:piston_arm_collision","minecraft:pistonarmcollision","minecraft:polar_bear_spawn_egg","minecraft:polished_blackstone_brick_double_slab","minecraft:polished_blackstone_double_slab","minecraft:polished_deepslate_double_slab","minecraft:portal","minecraft:potatoes","minecraft:powder_snow","minecraft:powder_snow_bucket","minecraft:powered_comparator","minecraft:powered_repeater","minecraft:pufferfish_bucket","minecraft:pufferfish_spawn_egg","minecraft:pumpkin_stem","minecraft:rabbit_spawn_egg","minecraft:rapid_fertilizer","minecraft:ravager_spawn_egg","minecraft:real_double_stone_slab","minecraft:real_double_stone_slab2","minecraft:real_double_stone_slab3","minecraft:real_double_stone_slab4","minecraft:redstone_wire","minecraft:repeating_command_block","minecraft:reserved3","minecraft:reserved4","minecraft:reserved6","minecraft:salmon_bucket","minecraft:salmon_spawn_egg","minecraft:sea_turtle_spawn_egg","minecraft:sheep_spawn_egg","minecraft:shulker_spawn_egg","minecraft:silverfish_spawn_egg","minecraft:skeleton_horse_spawn_egg","minecraft:skeleton_spawn_egg","minecraft:slime_spawn_egg","minecraft:soul_fire","minecraft:soul_fire","minecraft:sparkler","minecraft:spawn_egg","minecraft:spawn_egg","minecraft:spawner","minecraft:spider_spawn_egg","minecraft:spruce_standing_sign","minecraft:spruce_wall_sign","minecraft:squid_spawn_egg","minecraft:standing_banner","minecraft:standing_sign","minecraft:stickyPistonArmCollision","minecraft:sticky_piston_arm_collision","minecraft:stonecutter","minecraft:stray_spawn_egg","minecraft:strider_spawn_egg","minecraft:structure_block","minecraft:structure_void","minecraft:tadpole_bucket","minecraft:tadpole_spawn_egg","minecraft:tripwire","minecraft:tropical_fish_bucket","minecraft:tropical_fish_spawn_egg","minecraft:underwater_torch","minecraft:unknown","minecraft:unlit_redstone_ore","minecraft:unpowered_comparator","minecraft:unpowered_repeater","minecraft:vex_spawn_egg","minecraft:villager_spawn_egg","minecraft:vindicator_spawn_egg","minecraft:wall_banner","minecraft:wall_sign","minecraft:wandering_trader_spawn_egg","minecraft:warden_spawn_egg","minecraft:warped_double_slab","minecraft:warped_standing_sign","minecraft:warped_wall_sign","minecraft:water","minecraft:waxed_double_cut_copper_slab","minecraft:waxed_exposed_double_cut_copper_slab","minecraft:waxed_oxidized_double_cut_copper_slab","minecraft:waxed_weathered_double_cut_copper_slab","minecraft:weathered_double_cut_copper_slab","minecraft:witch_spawn_egg","minecraft:wither_spawn_egg","minecraft:wolf_spawn_egg","minecraft:zoglin_spawn_egg","minecraft:zombie_horse_spawn_egg","minecraft:zombie_spawn_egg","minecraft:zombie_villager_spawn_egg","minecraft:zombified_piglin_spawn_egg"],me=["minecraft:moving_block","minecraft:beehive","minecraft:beenest"],Pe=["minecraft:chest","minecraft:trapped_chest"],S={x:7,y:7,z:7};var X=class{constructor(e){this.emptySlotsCount=e.emptySlotsCount,this.size=e.size,this.items=[];for(let n=0;n<this.size;n++)this.items[n]=e.getItem(n)}load(e){for(let n=0;n<e.size;n++)!this.items[n]||e.setItem(n,this.items[n])}};import{DynamicPropertiesDefinition as Ee,EntityTypes as Lt,ItemStack as Bt,MinecraftEntityTypes as Dt,MinecraftItemTypes as zt,system as Ft,world as j}from"mojang-minecraft";import{BlockLocation as yt}from"mojang-minecraft";import{world as C,BlockLocation as de,MinecraftBlockTypes as pt,MinecraftDimensionTypes as le}from"mojang-minecraft";var _={"api.name":()=>"Smelly API","api.error.unknown":()=>"An unknown error has occured.","api.database.error.table_name":(t,e)=>`The display name ${t} is too long for an objective, it can be at most ${e} characters long`,"api.utilities.formatter.error.ms":t=>`${t} is not a string or a number`,"api.Providers.form.invaildtype":(t,e)=>`Type ${t} is not a vaild type to add a ${e}`,"api.Providers.form.invaildFormtype":(t,e)=>{`${t}${JSON.stringify(e)}`},"api.ChestGUI.error.pagenotfound":t=>`Page ${t} not found!`,"modules.protections.cps.clickingToFast":()=>"You are clicking to fast! Please click slower!","modules.managers.mute.isMuted":()=>"You are muted and cannot send messages please try again later","modules.commands.ban.reply":(t,e,n,r)=>`\xA7cBanned \xA7f"\xA7a${t}\xA7f" \xA7cfor ${e} ${n} Because: "${r??"No reason Provided"}" \xA7aSuccessfully`};var Te={doorsAndSwitches:!0,openContainers:!0,pvp:!1,allowedEntitys:["minecraft:player","minecraft:npc","minecraft:item"]},Ae=["minecraft:acacia_door","minecraft:acacia_trapdoor","minecraft:acacia_button","minecraft:birch_door","minecraft:birch_trapdoor","minecraft:birch_button","minecraft:crimson_door","minecraft:crimson_trapdoor","minecraft:crimson_button","minecraft:dark_oak_door","minecraft:dark_oak_trapdoor","minecraft:dark_oak_button","minecraft:jungle_door","minecraft:jungle_trapdoor","minecraft:jungle_button","minecraft:mangrove_door","minecraft:mangrove_trapdoor","minecraft:mangrove_button","minecraft:spruce_door","minecraft:spruce_trapdoor","minecraft:spruce_button","minecraft:warped_door","minecraft:warped_trapdoor","minecraft:warped_button","minecraft:wooden_door","minecraft:wooden_button","minecraft:trapdoor","minecraft:iron_door","minecraft:iron_trapdoor","minecraft:polished_blackstone_button","minecraft:lever"],Re=["minecraft:chest","minecraft:ender_chest","minecraft:barrel","minecraft:trapped_chest","minecraft:dispenser","minecraft:dropper","minecraft:furnace","minecraft:blast_furnace","minecraft:lit_furnace","minecraft:lit_blast_furnace","minecraft:hopper","minecraft:shulker_box","minecraft:undyed_shulker_box"];var ce=[],ft=!1,xe=-64,Ne=320;function $e(t,e,n){return n.every((r,i)=>r>=Math.min(t[i],e[i])&&r<=Math.max(t[i],e[i]))}var f=class{static getAllRegions(){if(ft)return ce;let e=s.regions.values().map(n=>new f(n.from,n.to,n.dimensionId,n.permissions,n.key));return e.forEach(n=>{ce.push(n)}),e}static blockLocationInRegion(e,n){return this.getAllRegions().find(r=>r.dimensionId==n&&$e([r.from.x,xe,r.from.z],[r.to.x,Ne,r.to.z],[e.x,e.y,e.z]))}static removeRegionAtBlockLocation(e,n){let r=this.blockLocationInRegion(e,n);return r?s.regions.delete(r.key):!1}constructor(e,n,r,i,o){this.from=e,this.to=n,this.dimensionId=r,this.permissions=i??Te,this.key=o||Date.now().toString(),o||(this.update(),q(),ce.push(this))}update(){s.regions.set(this.key,{key:this.key,from:this.from,dimensionId:this.dimensionId,permissions:this.permissions,to:this.to})}delete(){return s.regions.delete(this.key)}entityInRegion(e){return this.dimensionId==e.dimension.id&&$e([this.from.x,xe,this.from.z],[this.to.x,Ne,this.to.z],[e.location.x,e.location.y,e.location.z])}changePermission(e,n){this.permissions[e]=n,this.update()}};var k=class{static getTasks(){return s.tasks.get("changePlayerRole")??[]}static getPlayersRoleToSet(e){return k.getTasks().find(r=>r.playerName==e)?.role}constructor(e,n){let r=k.getTasks();r.push({playerName:e,role:n}),s.tasks.set("changePlayerRole",r)}};var y={overworld:C.getDimension(le.overworld),nether:C.getDimension(le.nether),theEnd:C.getDimension(le.theEnd)};function Oe(t,e=[],n){try{t.runCommand(`kick "${t.nameTag}" \xA7r${e.join(`
`)}`),t.triggerEvent("kick")}catch(r){if(!/"statusCode":-2147352576/.test(r))return;n&&n()}}function a(t){if(typeof t=="string"){let e=[...C.getPlayers()].find(n=>n.name==t);return e?e.getDynamicProperty("role"):s.roles.get(t)??"member"}else return t.getDynamicProperty("role")}function Me(t,e){if(typeof t=="string"){s.roles.set(t,e);let n=[...C.getPlayers()].find(r=>r.name==t);n?n.setDynamicProperty("role",e):new k(t,e)}else s.roles.set(t.name,e),t.setDynamicProperty("role",e)}function q(){for(let t of f.getAllRegions()){let e=new de(t.from.x,-64,t.from.z),n=new de(t.to.x,-64,t.to.z);for(let r of e.blocksBetween(n))y[t.dimensionId].getBlock(r)?.setType(pt.deny)}}var Le={};function R(t,e=0){let n=Date.now();return Le[n]={callback:t,delay:e,lastCall:0},n}C.events.tick.subscribe(t=>{let e=[...C.getPlayers()];for(let[n,r]of e.entries()){if(["moderator","admin"].includes(a(r)))return;for(let i of Object.values(Le))i.delay!=0&&t.currentTick-i.lastCall<i.delay||(i.callback(r,t),n==e.length-1&&(i.lastCall=t.currentTick))}});function Be(t,e="overworld",n=!1){try{return n?console.warn(JSON.stringify(this.runCommand(t))):y.overworld.runCommand(t)}catch{return{error:!0}}}function u(t){try{return t.scoreboard.id.toString()}catch{try{t.runCommand("scoreboard objectives add test dummy")}catch{}try{t.runCommand("scoreboard players add @s test 0")}catch{}return t.scoreboard.id.toString()}}function x(t,{compactDuration:e,fullDuration:n,avoidDuration:r}={}){try{if(typeof t=="string"){if(/^\d+$/.test(t))return Number(t);let i=t.match(/-?\d*\.?\d+\s*?(years?|yrs?|weeks?|days?|hours?|hrs?|minutes?|mins?|seconds?|secs?|milliseconds?|msecs?|ms|[smhdwy])/gi);return i?i.reduce((o,c)=>o+gt(c),0):null}if(typeof t=="number")return ut(t,{compactDuration:e,fullDuration:n,avoidDuration:r});throw new Error(_["api.utilities.formatter.error.ms"](t))}catch(i){let o=ht(i)?`${i.message}. Value = ${JSON.stringify(t)}`:_["api.error.unknown"]();throw new Error(o)}}function gt(t){let e=Number(t.replace(/[^-.0-9]+/g,""));return t=t.replace(/\s+/g,""),/\d+(?=y)/i.test(t)?e*3154e7:/\d+(?=w)/i.test(t)?e*6048e5:/\d+(?=d)/i.test(t)?e*864e5:/\d+(?=h)/i.test(t)?e*36e5:/\d+(?=m)/i.test(t)?e*6e4:/\d+(?=s)/i.test(t)?e*1e3:/\d+(?=ms|milliseconds?)/i.test(t)?e:0}function ut(t,{compactDuration:e,fullDuration:n,avoidDuration:r}={}){let i=Math.abs(t),c=[{short:"w",long:"week",duration:Math.floor(i/6048e5)},{short:"d",long:"day",duration:Math.floor(i/864e5)%7},{short:"h",long:"hour",duration:Math.floor(i/36e5)%24},{short:"m",long:"minute",duration:Math.floor(i/6e4)%60},{short:"s",long:"second",duration:Math.floor(i/1e3)%60},{short:"ms",long:"millisecond",duration:i%1e3}].filter(m=>m.duration!==0&&r?n&&!r.map(h=>h.toLowerCase()).includes(m.short):m.duration).map(m=>`${Math.sign(t)===-1?"-":""}${e?`${Math.floor(m.duration)}${m.short}`:`${Math.floor(m.duration)} ${m.long}${m.duration===1?"":"s"}`}`);return(n?c.join(e?" ":", "):c[0])||`${i}`}function ht(t){return typeof t=="object"&&t!==null&&"message"in t}function De(t){return new de(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))}var ze=32e3,U="rubedo:database",fe=y.overworld,pe=new yt(0,-64,0);import{ItemStack as bt,MinecraftItemTypes as _t}from"mojang-minecraft";function Fe(t,e){return t.match(new RegExp(".{1,"+e+"}","g"))}var g=class{static compress(e){return e}static decompress(e){return e}static createEntity(e,n){let r=fe.spawnEntity(U,pe);r.setDynamicProperty("name",e),r.setDynamicProperty("index",n);let i=r.getComponent("inventory").container,o=new bt(_t.acaciaBoat,1);return n==0&&(o.nameTag="{}"),i.setItem(0,o),r}static getInventorySlotName(e,n){return e.getComponent("inventory").container.getItem(n)?.nameTag}static setInventorySlotName(e,n,r){let i=e.getComponent("inventory").container,o=i.getItem(n);return o.nameTag=r,i.setItem(n,o)}constructor(e){this.name=e,this.savedEntitys=void 0,this.MEMORY=void 0}get entitys(){if(this.savedEntitys)return this.savedEntitys;let e=fe.getEntitiesAtBlockLocation(pe).filter(n=>n.id==U&&n.getDynamicProperty("name")==this.name);return this.savedEntitys=e,e}data(){if(this.MEMORY)return this.MEMORY;if(this.entitys.length==0&&g.createEntity(this.name,0),this.entitys.length==1){let n=JSON.parse(g.decompress(g.getInventorySlotName(this.entitys[0],0)));return this.MEMORY=n,n}let e=new Array(this.entitys.length);for(let n of this.entitys){let r=n.getDynamicProperty("index");e[r]=g.getInventorySlotName(n,0)}try{e=JSON.parse(e.join(""))}catch{e={}}return this.MEMORY=e,e}save(e){this.MEMORY=e;let n=Fe(g.compress(JSON.stringify(e)),ze);if(this.entitys&&n.length==this.entitys.length)for(let r=0;r<n.length;r++)g.setInventorySlotName(this.entitys[r],0,n[r]);else{this.entitys?.forEach(r=>r?.triggerEvent("despawn")),this.savedEntitys=void 0;for(let r=0;r<n.length;r++){let i=g.createEntity(this.name,r);g.setInventorySlotName(i,0,n[r])}}}set(e,n){let r=this.data();r[e]=n,this.save(r)}get(e){return this.data()[e]}has(e){return this.keys().includes(e)}delete(e){let n=this.data(),r=delete n[e];return this.save(n),r}size(){return this.keys().length}clear(){this.save({})}keys(){return Object.keys(this.data())}values(){return Object.values(this.data())}getCollection(){return this.data()}};import{world as Ge}from"mojang-minecraft";var je=new Map,H=class{constructor(e,n,r=!1,i=Date.now()){this.callbackTick=null,this.tickDelay=n,this.loop=r,this.callback=e,this.id=i,je.set(i,this),this.TickCallBack=Ge.events.tick.subscribe(({currentTick:o})=>{if(this.callbackTick||(this.callbackTick=o+this.tickDelay),!(this.callbackTick>o)){if(this.callback(o),!this.loop)return this.expire();this.callbackTick=o+this.tickDelay}})}expire(){Ge.events.tick.unsubscribe(this.TickCallBack),je.delete(this.id)}};var Ue=t=>new Promise(e=>kt(e,t));function kt(t,e){new H(t,e)}function Y(t,e){return new H(t,e,!0)}import{world as St}from"mojang-minecraft";var E="-";var Z=class{constructor(e,n){this.data=e,this.args=n,this.sender=e.sender}reply(e){this.sender.tell(e)}run(e){try{this.sender.runCommand(e)}catch{}}invalidArg(e){this.sender.tell({translate:"commands.generic.parameter.invalid",with:[e]})}invalidPermission(){this.sender.tell({translate:"commands.generic.permission.selector"})}give(e){this.sender.getComponent("minecraft:inventory").container.addItem(e)}};import{BlockLocation as wt,world as It}from"mojang-minecraft";function He([t,e,n],{location:r,viewVector:i}){if(!t||!e||!t)return null;let o=[t,e,n].map(l=>{let m=parseInt(l.replace(/\D/g,""));return isNaN(m)?0:m}),c=[t,e,n].map((l,m)=>l.includes("~")?o[m]+r[m]:l.includes("^")?o[m]+i[m]:o[m]);return new wt(c[0],c[1],c[2])}function ge(t){return[...It.getPlayers()].find(e=>e.name===t)}var N=class{};N.fail="commands.generic.parameter.invalid",N.validate=e=>e&&e!="",N.parse=e=>e;var w=class{};w.fail="commands.generic.num.invalid",w.validate=e=>!isNaN(e),w.parse=e=>parseInt(e);var $=class{};$.fail=w.fail,$.validate=e=>e?.match(/^\d+\.\d+$/)?.[0],$.parse=e=>parseFloat(e);var O=class{};O.fail=w.fail,O.validate=e=>e?.match(/^([\~\^]{1})?([-]?\d*)$/)?.[0],O.parse=e=>e;var M=class{};M.fail="commands.generic.boolean.invalid",M.validate=e=>e?.match(/^(true|false)$/)?.[0],M.parse=e=>e=="true";var L=class{};L.fail="commands.generic.player.notFound",L.validate=e=>!!ge(e),L.parse=e=>ge(e);var B=class{};B.fail="commands.generic.player.notFound",B.validate=e=>e?.match(/^(@.|"[\s\S]+")$/)?.[0],B.parse=e=>e;var D=class{};D.fail="commands.generic.parameter.invalid",D.validate=(e,n)=>n.includes(e),D.parse=e=>e;var Q={string:N,int:w,float:$,location:O,boolean:M,player:L,target:B,array:D};var P=class{constructor(e,n,r,i=!1){this.name=e,this.type=n,this.description=r,this.optional=i}verify(e){return Array.isArray(this.type)?Q.array.validate(e,this.type):Q[this.type].validate(e)}validate(e){return Array.isArray(this.type)?e:Q[this.type].parse(e)}};var vt=t=>!0;function Ye(t){let e=ue(t),n=(o,c)=>c.every((l,m)=>l===o[m]),r=null,i={};for(let o of T){i[o.path.toString()]=o;for(let c of o.aliases){let l=[...o.path];l[0]=c,i[l.toString()]=o}if(o.path.length>1){let c=T.find(l=>l.name==o.path[0]);for(let l of c.aliases){let m=[...o.path];m[0]=l,i[m.toString()]=o}}}for(let[o,c]of Object.entries(i)){let l=o.split(",");n(e,l)&&(r=c)}return r}function ue(t){return t.message.slice(E.length).trim().match(/"[^"]+"|[^\s]+/g).map(e=>e.replace(/"(.+)"/,"$1").toString())}var d=class{constructor(e,n){this.name=e.name.toString().toLowerCase(),this.description=e.description,this.aliases=e.aliases??[],this.tags=e.tags??[],this.hasPermission=e.hasPermission??vt,this.path=e.path??[this.name],this.permissions=e.permissions??[],this.options=[],this.callback=n,T.push(this)}addSubCommand(e,n){let r=[...this.path];return r.push(e.name),new d({name:e.name,description:e.description,tags:e.tags,hasPermission:e.hasPermission,path:r},n)}addOption(e,n,r,i=!1){return n=="location"?(this.options.push({name:e,type:"location",description:r,optional:i,x:new P(`x${Date.now()}`,n,r,i),y:new P(`y${Date.now()}`,n,r,i),z:new P(`z${Date.now()}`,n,r,i)}),this):(this.options.push(new P(e,n,r,i)),this)}getName(){return this.name}sendCallback(e,n){if(!this.callback)return;let r={};for(let[i,o]of this.options.entries()){if(o.type=="location"){r[o.name]=He([n[i],n[i+1],n[i+2]],{location:[e.sender.location.x,e.sender.location.y,e.sender.location.z],viewVector:[e.sender.viewVector.x,e.sender.viewVector.y,e.sender.viewVector.z]});continue}r[o.name]=o.validate(n[i])}this.callback(new Z(e,n),r)}executes(e){return this.callback=e,this}};var T=[];St.events.beforeChat.subscribe(t=>{try{if(!t.message.startsWith(E))return;t.cancel=!0;let e=ue(t),n=Ye(t);if(!n||!n.callback)return t.sender.tell({translate:"commands.generic.unknown",with:[`\xA7f${e[0]}\xA7c`]});if(!n.tags.every(r=>t.sender.hasTag(r))||!n.hasPermission(t.sender))return t.sender.tell("You do not have permission to use this command");e.shift(),e=e.filter(r=>!n.path.includes(r));for(let[r,i]of n.options.entries()){if(i.type=="location"){if(i.x.verify(e[r]))if(e?.[r+1]&&i.y.verify(e[r+1])){if(e?.[r+2]&&i.z.verify(e[r+2]))continue;r+=2}else r+=1}else if(i.verify(e[r]))continue;if(i.optional)break;return t.sender.tell({translate:"commands.generic.syntax",with:[`${E}${n.path.join(" ")} ${e.slice(0,r).join(" ")}`,e[r],e.slice(r+1).join(" ")]})}n.sendCallback(t,e)}catch(e){console.warn(`${e} : ${e.stack}`),t.cancel=!1}});import{world as ke}from"mojang-minecraft";var he="rubedo:gui",ye="rubedo:inventory",Ve="home";import{world as F}from"mojang-minecraft";var V={};function ee(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let i=0;i<r.size;i++){let o=e.slots[i];if(!o||!o.item){r.setItem(i,z);continue}r.setItem(i,o.item.setComponents())}}function Ke(t){let e="";if(t){let{id:n,nameTag:r,amount:i,data:o}=t;e=[n,r,i,o].join("")}return e}var I=class{constructor(e,n,r=ee){if(n%9!=0)throw new Error("Size needs to be in a increment of 9");if(V[e])throw new Error(`Id of ${e} Already exsists`);this.id=e,this.size=n,this.slots=Array(this.size),this.fillType=r,V[e]=this}setSlots(e,n,r){let i=n?{item:n,action:r}:null;for(let o of e)this.slots[o]=i;return this}setButtonAtSlot(e,n){return this.slots[e]={item:n.Item,action:n.Action},this}};var te=class{constructor(e,n,r){this.gui=e,this.slot=n,this.change=r}message(e){this.gui.player.tell(e)}getItemAdded(){return this.slot.item?null:this.gui.entity.getComponent("minecraft:inventory").container.getItem(this.change.slot)}GiveAction(e=this.slot.item.itemStack){this.gui.player.getComponent("minecraft:inventory").container.addItem(e)}TakeAction(e=null){this.gui.player.getComponent("minecraft:inventory").container.addItem(this.slot.item.itemStack),this.gui.page.slots[this.change.slot]=null,e&&e.delete(this.slot.item.components.dbKey)}PageAction(e,n){this.gui.setPage(e,n)}BackAction(e=1){if(this.gui.pageHistory.length<e)return new Error("Tried to Go back to a page number that doesnt exist");console.warn(JSON.stringify(this.gui.pageHistory));let n=this.gui.pageHistory.splice(-1-e)[0];console.warn(JSON.stringify(this.gui.page.extras)),this.PageAction(n,this.gui.page.extras)}CloseAction(){this.gui.kill()}SetAction(){this.gui.entity.getComponent("minecraft:inventory").container.setItem(this.change.slot,this.slot.item.itemStack)}async FormAction(e){return this.CloseAction(),await Ue(5),await e.show(this.gui.player)}};import{MinecraftDimensionTypes as Ct}from"mojang-minecraft";async function Je(t,e){try{let n=t.getComponent("minecraft:inventory").container,r=[];for(let i=0;i<n.size;i++){let o=n.getItem(i);!o||o?.id==e?.id&&(r.push({slot:i,item:o}),n.setItem,i<9?t.runCommand(`replaceitem entity @s slot.hotbar ${i} air`):t.runCommand(`replaceitem entity @s slot.inventory ${i-9} air`))}t.runCommand(`clear @s ${e?.id} ${e.data} ${e.amount}`);for(let i of r)n.setItem(i.slot,i.item)}catch(n){console.warn(n+n.stack),[...t.dimension.getEntities({type:"minecraft:item",location:t.location,maxDistance:2,closest:1})].forEach(r=>r.kill())}}function We(t,e){return t.getComponent("minecraft:inventory").container.getItem(e)}function Xe(t){let e=[];for(let n of Object.keys(Ct))[...y[n].getEntities()].forEach(r=>e.push(r));return t?e.filter(n=>n?.id==t):e}function be(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}var A={},G=class{static getEntitysGuiInstance(e){return Object.values(A).find(n=>n.entity==e)}static getSlotChange(e,n){if(e.length!=n.length)return null;for(let r=0;r<e.length;r++)if(e[r].uid!=n[r].uid)return{slot:r,item:e[r].item};return null}constructor(e,n){this.player=e,this.playersName=e.name,this.entity=n,this.previousMap=null,this.HAS_CONTAINER_OPEN=!1,this.pageHistory=[],this.extras=null,this.page=null,this.loops=[],this.entity||this.summon(),this.events={tick:F.events.tick.subscribe(()=>{try{if(!this.HAS_CONTAINER_OPEN||!this.previousMap)return;for(let i of this.loops)i();let r=G.getSlotChange(this.previousMap,this.mapInventory);if(r==null)return;this.onSlotChange(r)}catch(r){console.warn(r+r.stack)}}),playerLeave:F.events.playerLeave.subscribe(({playerName:r})=>{r==this.playersName&&this.kill()}),beforeDataDrivenEntityTriggerEvent:F.events.beforeDataDrivenEntityTriggerEvent.subscribe(r=>{if(!!["rubedo:has_container_open","rubedo:dosent_have_container_open"].includes(r.id)&&r.entity.nameTag==this.player.nameTag){if(r.id=="rubedo:has_container_open")return this.HAS_CONTAINER_OPEN=!0;this.HAS_CONTAINER_OPEN=!1}})},A[this.playersName]=this}summon(){try{Xe(ye)?.find(n=>n.getTags().includes(`id:${this.playersName}`))?.triggerEvent("despawn");let e=F.events.entityCreate.subscribe(n=>{n.entity?.id==ye&&(this.entity=n.entity,this.entity.addTag(`id:${this.playersName}`),this.setPage(Ve)),F.events.entityCreate.unsubscribe(e)});this.player.triggerEvent("rubedo:spawn_inventory")}catch(e){console.warn(e+e.stack)}}reload(){this.entity.triggerEvent("despawn"),this.summon()}kill(){try{this.entity?.triggerEvent("despawn")}catch{}for(let e in this.events)F.events[e].unsubscribe(this.events[e]);delete A[this.playersName]}setPage(e,n){this.extras=n,this.pageHistory.push(e),this.loops=[];let r=V[e];if(!r)return new Error(_["api.ChestGUI.error.pagenotfound"](e??"Undefined"));r.fillType(this.entity,r,n),this.page=r,this.previousMap=this.mapInventory,this.entity.nameTag=`size:${r.size}`??"size:27"}get mapInventory(){let e=this.entity.getComponent("inventory").container,n=[];for(let r=0;r<e.size;r++){let i=e.getItem(r);n.push({uid:Ke(i),item:i})}return this.previousMap=n,n}onSlotChange(e){let n=this.page.slots[e.slot];if(!n)this.entity.runCommand(`replaceitem entity @s slot.inventory ${e.slot} air`);else{if(n.item&&Je(this.player,n.item),!n.item&&!We(this.entity,e.slot))return;this.runItemAction(n,e)}this.previousMap=this.mapInventory}runItemAction(e,n){!e.action||e.action(new te(this,e,n))}registerLoop(e){this.loops.push(e)}};import{Items as Et,ItemStack as Pt,MinecraftEnchantmentTypes as _e}from"mojang-minecraft";var p=class{static itemStackToItem(e,n={}){let r=e.getComponent("enchantments").enchantments,i=[];for(let o in _e)!r.getEnchantment(_e[o])||i.push(_e[o]);return new p(e.id,e.amount,e.data,{nameTag:e.nameTag,lore:e.getLore(),enchantments:i})}constructor(e,n=1,r=0,i={},o){this.id=e,this.amount=n,this.data=r,this.components=i,this.itemStack=o||new Pt(Et.get(this.id),n,r)}setComponents(e=this.components){if(this.components=e,e?.nameTag&&(this.itemStack.nameTag=e.nameTag),this.components?.lore&&this.itemStack.setLore(this.components.lore),e?.enchantments?.length>0){let n=this.itemStack.getComponent("enchantments").enchantments;for(let r of e.enchantments)n.addEnchantment(r);this.itemStack.getComponent("enchantments").enchantments=n}return this.itemStack}};var ne=class{};ne.Item=new p("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),ne.Action=e=>{e.BackAction()};var b=class{};b.Item=new p("minecraft:barrier",1,0,{nameTag:"\xA7cClose GUI"}),b.Action=e=>{e.CloseAction()};var xr=new I("home",54,ee).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,48,50,51,52,53],new p("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([22],new p("minecraft:ender_chest",1,0,{nameTag:"\xA7l\xA7bInventory Viewer"}),t=>{t.PageAction("moderation:see")}).setButtonAtSlot(49,b);ke.events.tick.subscribe(()=>{for(let t of ke.getPlayers()){if(a(t)!="admin")continue;if(be(t)?.id!=he)return;A[t.name]||(A[t.name]=new G(t))}});ke.events.tick.subscribe(()=>{for(let t of Object.values(A))if(!!t.entity?.id){try{if(t.entity.getComponent("minecraft:health").current<=0)return t.kill()}catch{t.kill()}if(be(t.player)?.id!=he||!t.player)return t.kill();t.entity.teleport(t.player.location,t.player.dimension,0,0)}});var re=class{constructor(e,n,r,i="No Reason",o="Smelly Anti Cheat"){n=n?x(`${n} ${r}`):null;let c={key:u(e),player:e.name,date:Date.now(),length:n,expire:n?n+Date.now():null,reason:i,by:o};s.bans.set(u(e),c)}};new d({name:"ban",description:"Ban players for lengths",hasPermission:t=>a(t)=="admin"}).addOption("player","player","Player to ban").addOption("length","int","Time ammount to ban").addOption("unit","string","The unit for the time").addOption("reason","string","reason for ban",!0).executes((t,{player:e,length:n,unit:r,reason:i})=>{new re(e,n,r,i,t.sender.name),t.reply(_["modules.commands.ban.reply"](e.name,n,r,i))});var K={aquaAffinity:1,baneOfArthropods:5,binding:1,blastProtection:4,channeling:1,depthStrider:3,efficiency:5,featherFalling:4,fireAspect:2,fireProtection:4,flame:1,fortune:3,frostWalker:2,impaling:5,infinity:1,knockback:2,looting:3,loyalty:4,luckOfTheSea:3,lure:3,mending:1,multishot:1,piercing:4,power:5,projectileProtection:4,protection:4,punch:2,quickCharge:3,respiration:3,riptide:3,sharpness:5,silkTouch:1,smite:5,soulSpeed:3,swiftSneak:4,thorns:3,unbreaking:3,vanishing:1};var we=new d({name:"config",description:"Opens up a form to configure rubedo",hasPermission:t=>a(t)=="admin"}),qe=we.addSubCommand({name:"banned",description:"Manages banned items/blocks on this server",hasPermission:t=>a(t)=="admin"}),Ze=qe.addSubCommand({name:"items",description:"Manages the banned items on this server",hasPermission:t=>a(t)=="admin"});Ze.addSubCommand({name:"add",description:"Adds a item to the banned items list",hasPermission:t=>a(t)=="admin"}).addOption("item","string","item to add make sure it is prefix:item").executes((t,{item:e})=>{let n=s.config.get("banned_items")??se;n.includes(e)||n.push(e),s.config.set("banned_items",n),t.reply(`Banned the item "${e}"`)});Ze.addSubCommand({name:"remove",description:"Removes a item from the banned items list",hasPermission:t=>a(t)=="admin"}).addOption("item","string","item to remove make sure it is prefix:item").executes((t,{item:e})=>{let n=s.config.get("banned_items")??se;if(!n.includes(e))return t.reply(`item: "${e}" is not banned`);n=n.filter(r=>r!=e),s.config.set("banned_items",n),t.reply(`Removed Banned item "${e}"`)});var Qe=qe.addSubCommand({name:"blocks",description:"Manages the banned blocks on this server",hasPermission:t=>a(t)=="admin"});Qe.addSubCommand({name:"add",description:"Adds a block to the banned blocks list",hasPermission:t=>a(t)=="admin"}).addOption("block","string","item to add make sure it is prefix:block").executes((t,{block:e})=>{let n=s.config.get("banned_blocks")??me;n.includes(e)||n.push(e),s.config.set("banned_blocks",e),t.reply(`Banned the block "${e}"`)});Qe.addSubCommand({name:"remove",description:"Removes a block from the banned blocks list",hasPermission:t=>a(t)=="admin"}).addOption("block","string","block to remove make sure it is prefix:block").executes((t,{block:e})=>{let n=s.config.get("banned_blocks")??me;if(!n.includes(e))return t.reply(`block: "${e}" is not banned`);n=n.filter(r=>r!=e),s.config.set("banned_blocks",e),t.reply(`Removed Banned block "${e}"`)});var et=we.addSubCommand({name:"enchantments",description:"Manages the maxEnchants on this srrver",hasPermission:t=>a(t)=="admin"});et.addSubCommand({name:"set",description:"Sets a enchantment to a level",hasPermission:t=>a(t)=="admin"}).addOption("enchantment",Object.keys(K),"enchantment to change").addOption("level","int","Max level to change the enchantment to").executes((t,{enchantment:e,level:n})=>{let r=s.config.get("enchantments")??K;r[e]=n,s.config.set("enchantments",r),t.reply(`Set max level for ${e} to ${n}`)});et.addSubCommand({name:"get",description:"Gets the max level for a enchantment",hasPermission:t=>a(t)=="admin"}).addOption("enchantment",Object.keys(K),"enchantment to change").executes((t,{enchantment:e})=>{let n=s.config.get("enchantments")??K;t.reply(`Max level for ${e} is ${n[e]}`)});we.addSubCommand({name:"setAppealLink",description:"Sets the appeal link for this server",hasPermission:t=>a(t)=="admin"}).addOption("link","string","the link to have people go to, to appeal").executes((t,{link:e})=>{s.config.set("appealLink",e),t.reply(`Changed the servers appeal link to ${e}`)});var Ie=new d({name:"database",description:"Interacts with SA Database",aliases:["db"],hasPermission:t=>a(t)=="admin"});Ie.addSubCommand({name:"get",hasPermission:t=>a(t)=="admin"}).addOption("table","string","Table to grab from").addOption("key","string","Key to grab").executes((t,{table:e,key:n})=>{try{let r=s[e].get(n);r?t.reply(r):t.reply(`No data could be found for key ${n}`)}catch(r){t.reply(r+r.stack)}});Ie.addSubCommand({name:"set",hasPermission:t=>a(t)=="admin"}).addOption("table","string","Table to set to").addOption("key","string","Key to set").addOption("value","string","Value to assign to the key").executes((t,{table:e,key:n,value:r})=>{try{s[e].set(n,r),t.reply(`Set Key: "${n}", to value: "${r}" on table: "${e}"`)}catch(i){t.reply(i+i.stack)}});Ie.addSubCommand({name:"clear",hasPermission:t=>a(t)=="admin"}).addOption("table","string","Table to set to").executes((t,{table:e})=>{try{s[e].clear(),t.reply(`Cleared Table ${e}`)}catch(n){t.reply(n+n.stack)}});new d({name:"ecwipe",description:"Clears a players ender chest",hasPermission:t=>a(t)=="admin"}).addOption("player","player","Player to clear").executes((t,{player:e})=>{for(let n=0;n<27;n++)e.runCommand(`replaceitem entity @s slot.enderchest ${n} air`);t.reply(`Cleared ${e.name} Ender chest!`)});var ie=class{constructor(e,n="No Reason"){let r={player:e.name,key:u(e),reason:n,location:{x:e.location.x,y:e.location.y,z:e.location.z,dimension:e.dimension.id}};s.freezes.set(u(e),r)}};new d({name:"freeze",description:"Freeze a player",hasPermission:t=>a(t)=="admin"}).addOption("player","player","Player to ban").addOption("reason","string","reason for ban",!0).executes((t,{player:e,reason:n})=>{new ie(e,n),t.reply(`\xA7cFroze \xA7f"\xA7a${e.name}\xA7f" Because: "${n??"No reason Provided"}" \xA7aSuccessfully`),t.sender.tell(`\xA7cYou have been frozen by \xA7f"\xA7a${t.sender.nameTag}\xA7f" Because: "${n??"No reason Provided"}"`)});new d({name:"help",description:"Provides help/list of commands.",aliases:["?","h"]},t=>{if(T.length==0)return t.reply("No Commands Found");let e=T.filter(o=>o.callback&&o.hasPermission(t.sender)),n=1,r=Math.ceil(e.length/10),i=t.args[0];if(i)if(!isNaN(parseInt(i)))n=parseInt(i);else{let o=e.find(c=>c.path.includes(i));if(!o)return t.reply(`The command ${i} does not exist`);t.sender.tell({rawtext:[{translate:"commands.help.command.aliases",with:[o.name,o.aliases.join(", ")]}]}),t.reply(o.description),t.reply(`Usage: 
`);for(let c of e.filter(l=>l.path[0]==t.args[0])){let l=c.options.map(m=>`${m.optional?"[":"<"}${m.name}: ${m.type}${m.optional?"]":">"}`);t.reply(`-${c.path.join(" ")} ${l.join(" ")}`)}return}n>r&&(n=r),t.sender.tell({rawtext:[{translate:"commands.help.header",with:[n.toString(),r.toString()]}]});for(let o of e.slice(n*10-10,n*10)){let c=o.options.map(l=>`${l.optional?"[":"<"}${l.name}: ${l.type}${l.optional?"]":">"}`);t.reply(`-${o.path.join(" ")} ${c.join(" ")}`)}});var v=class{static getMuteData(e){return s.mutes.get(u(e))}constructor(e,n,r,i="No Reason",o="Smelly Anti Cheat"){e.runCommand("ability @s mute true");let c=n?x(`${n} ${r}`):null,l={player:u(e),date:Date.now(),length:c,expire:c?c+Date.now():null,reason:i,by:o};s.mutes.set(u(e),l)}};new d({name:"mute",description:"Mute a player for lengths",hasPermission:t=>["admin","moderator"].includes(a(t))}).addOption("player","player","Player to mute").addOption("length","int","Time ammount of mute",!0).addOption("unit","string","The unit for the time",!0).addOption("reason","string","reason for mute",!0).executes((t,{player:e,length:n,unit:r,reason:i})=>{new v(e,n,r,i,t.sender.nameTag),t.reply(`\xA7cMuted \xA7f"\xA7a${e.name}\xA7f" \xA7cfor ${n} ${r} Because: "${i??"No reason Provided"}" \xA7aSuccessfully`),e.tell(`\xA7cYou have been muted by \xA7f"${t.sender.name}" \xA7cfor ${n} ${r} Because: "${i??"No reason Provided"}"`)});new d({name:"npc",description:"Spawns a npc at your coordinates",hasPermission:t=>a(t)=="admin"},t=>{tt.push(t.sender.location),t.sender.dimension.spawnEntity("minecraft:npc",t.sender.location),t.reply("Spawned a verifed npc at your current location")});import{world as nt}from"mojang-minecraft";new d({name:"ping",description:"Returns the current TPS of the servers ping"},t=>{let e=nt.events.tick.subscribe(({deltaTime:n})=>{t.reply(`Pong! Current TPS: ${1/n}`),nt.events.tick.unsubscribe(e)})});import{BlockLocation as J}from"mojang-minecraft";var W=new d({name:"region",description:"Create a Region",hasPermission:t=>a(t)=="admin"});W.addSubCommand({name:"add",description:"Adds a new protection region",hasPermission:t=>a(t)=="admin"}).addOption("from_x","int","The starting x of the region").addOption("from_z","int","The starting z of the region").addOption("to_x","int","The ending x of the region").addOption("to_z","int","The ending z of the region").executes((t,{from_x:e,from_z:n,to_x:r,to_z:i})=>{new f({x:e,z:n},{x:r,z:i},t.sender.dimension.id),t.reply(`Created Region From ${e} -64 ${n} ${r} 320 ${i}`)});W.addSubCommand({name:"remove",description:"Removes a region at the players current postion",hasPermission:t=>a(t)=="admin"},t=>{let e=new J(t.sender.location.x,t.sender.location.y,t.sender.location.z);f.removeRegionAtBlockLocation(e,t.sender.dimension.id)?t.reply(`Removed Region at ${e.x} ${e.y} ${e.z}`):t.reply(`Failed to find/remove region at ${e.x} ${e.y} ${e.z}`)});W.addSubCommand({name:"removeAll",description:"Removes all regions",hasPermission:t=>a(t)=="admin"},t=>{f.getAllRegions().forEach(e=>e.delete()),t.reply("Removed All regions")});W.addSubCommand({name:"list",description:"Lists all regions and positions",hasPermission:t=>a(t)=="admin"},t=>{let e=f.getAllRegions();for(let n of e)t.reply(`Region from ${n.from.x}, ${n.from.z} to ${n.to.x}, ${n.to.z} in dimension ${n.dimensionId}`);if(e.length==0)return t.reply("No regions have been made yet")});var ve=W.addSubCommand({name:"permission",description:"Handels permissions for regions",hasPermission:t=>a(t)=="admin"});ve.addSubCommand({name:"set",description:"Sets a certin permission on the region the player is currently in to a value",hasPermission:t=>a(t)=="admin"}).addOption("key",["doorsAndSwitches","openContainers","pvp"],"The region permission to change").addOption("value","boolean","If this permission should be on or off").executes((t,{key:e,value:n})=>{let r=f.blockLocationInRegion(new J(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!r)return t.reply("You are not in a region");r.changePermission(e,n),t.reply(`Changed permision ${e} to ${n}`)});ve.addSubCommand({name:"list",description:"Lists the permissions for the current region",hasPermission:t=>a(t)=="admin"},t=>{let e=f.blockLocationInRegion(new J(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!e)return t.reply("You are not in a region");t.reply(`Current region permissions ${JSON.stringify(e.permissions)}`)});var rt=ve.addSubCommand({name:"entities",description:"Holds the subCommands for adding or removing allowedEntitys",hasPermission:t=>a(t)=="admin"});rt.addSubCommand({name:"add",description:"Adds a entity to the allowed entitys list",hasPermission:t=>a(t)=="admin"}).addOption("entity","string","the entity id to add").executes((t,{entity:e})=>{let n=f.blockLocationInRegion(new J(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;r.push(e),n.changePermission("allowedEntitys",r),t.reply(`Added entity ${e} to the allowed entitys of the region your currently standing in`)});rt.addSubCommand({name:"remove",description:"Removes a entity from the allowed entitys in the region",hasPermission:t=>a(t)=="admin"}).addOption("entity","string","the entity id to add").executes((t,{entity:e})=>{let n=f.blockLocationInRegion(new J(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let r=n.permissions.allowedEntitys;if(!r.includes(e))return t.reply(`The entity ${e} is not allowed to enter the region`);r=r.filter(i=>i!=e),n.changePermission("allowedEntitys",r),t.reply(`Removed entity ${e} to the allowed entitys of the region your currently standing in`)});var it=new d({name:"role",description:"Changes role for a player",hasPermission:t=>a(t)=="admin"});it.addSubCommand({name:"set",description:"Sets the role for a player",hasPermission:t=>a(t)=="admin"}).addOption("playerName","string","player to set").addOption("role",["member","moderator","admin"],"Role to set this player to").executes((t,{playerName:e,role:n})=>{Me(e,n),t.reply(`Changed role of ${e} to ${n}`)});it.addSubCommand({name:"get",description:"Gets the role of a player",hasPermission:t=>a(t)=="admin"}).addOption("playerName","string","player to set").executes((t,{playerName:e})=>{t.reply(`${e} has role: ${a(e)}`)});import{world as ot}from"mojang-minecraft";new d({name:"vanish",description:"Toggles Vanish Mode on the sender",hasPermission:t=>a(t)=="admin"}).addOption("say","boolean","if say you left/joined",!0).executes((t,{say:e})=>{if(t.sender.hasTag("spectator")){if(t.sender.runCommand("gamemode c"),t.sender.runCommand("event entity @s removeSpectator"),t.sender.removeTag("spectator"),!e)return;ot.say({rawtext:[{translate:"multiplayer.player.joined",with:[`\xA7e${t.sender.name}`]}]})}else{if(t.sender.runCommand("gamemode spectator"),t.sender.runCommand("event entity @s addSpectator"),t.sender.addTag("spectator"),!e)return;ot.say({rawtext:[{translate:"multiplayer.player.left",with:[`\xA7e${t.sender.name}`]}]})}});new d({name:"unban",description:"Unban a banned player",hasPermission:t=>a(t)=="admin"}).addOption("playerName","string","Player to ban").executes((t,{playerName:e})=>{let n=s.bans.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not banned`);s.bans.delete(n.key),t.reply(`\xA7a${e}\xA7r has been Unbanned!`)});new d({name:"unfreeze",description:"Unfreeze a frozen player",hasPermission:t=>a(t)=="admin"}).addOption("playerName","string","Player to unfreeze").executes((t,{playerName:e})=>{let n=s.freezes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not frozen`);s.freezes.delete(n.key),t.reply(`\xA7a${e}\xA7r has been UnFrozen!`)});new d({name:"unmute",description:"Unmutes a muted player",hasPermission:t=>["admin","moderator"].includes(a(t))}).addOption("playerName","string","Player to unfreeze").executes((t,{playerName:e})=>{let n=s.mutes.values().find(r=>r.player==e);if(!n)return t.reply(`${e} is not muted!`);s.mutes.delete(n.player);try{t.sender.runCommand(`ability "${e}" mute false`)}catch{}t.reply(`\xA7a${e}\xA7r has been UnMuted!`)});var at="2.4.0-beta";var st="https://discord.gg/dMa3A5UYKX";new d({name:"version",description:"Get Current Version",aliases:["v"]},t=>{t.reply(`Current Rubedo Version: ${at}`)});R(t=>{let e=u(t),n=s.bans.get(e);if(!!n){if(n.expire&&n.expire<Date.now())return s.bans.delete(e);Oe(t,["\xA7cYou have been banned!",`\xA7aReason: \xA7f${n.reason}`,`\xA7fExpiry: \xA7b${n.expire?x(n.length):"Forever"}`,`\xA7fAppeal at: \xA7b${s.config.get("appealLink")??st}`],()=>{s.bans.delete(e)})}},20);import{Location as Tt}from"mojang-minecraft";R(t=>{let e=s.freezes.get(u(t));!e||t.teleport(new Tt(e.location.x,e.location.y,e.location.z),y[e.location.dimension],0,0)},20);import{world as At}from"mojang-minecraft";At.events.beforeChat.subscribe(t=>{if(t.message.startsWith(E))return;let e=v.getMuteData(t.sender);if(!!e){if(e.expire&&e.expire<Date.now())return s.mutes.delete(u(t.sender));t.cancel=!0,t.sender.tell(_["modules.managers.mute.isMuted"]())}});import{BlockLocation as Rt,world as oe}from"mojang-minecraft";Y(()=>{q()},6e3);oe.events.beforeItemUseOn.subscribe(t=>{if(["moderator","admin"].includes(a(t.source)))return;let e=f.blockLocationInRegion(t.blockLocation,t.source.dimension.id);if(!e)return;let n=t.source.dimension.getBlock(t.blockLocation);Ae.includes(n.id)&&e.permissions.doorsAndSwitches||Re.includes(n.id)&&e.permissions.openContainers||(t.cancel=!0)});oe.events.beforeExplosion.subscribe(t=>{for(let e=0;e<t.impactedBlocks.length;e++){let n=t.impactedBlocks[e];if(f.blockLocationInRegion(n,t.dimension.id))return t.cancel=!0}});oe.events.entityCreate.subscribe(t=>{let e=f.blockLocationInRegion(new Rt(t.entity.location.x,t.entity.location.y,t.entity.location.z),t.entity.dimension.id);!e||e.permissions.allowedEntitys.includes(t.entity.id)||(t.entity.teleport({x:0,y:-64,z:0},t.entity.dimension,0,0),t.entity.kill())});Y(()=>{for(let t of f.getAllRegions())for(let e of oe.getDimension(t.dimensionId).getEntities({excludeTypes:t.permissions.allowedEntitys}))!t.entityInRegion(e)||(e.teleport({x:0,y:-64,z:0},e.dimension,0,0),e.kill())},100);R(t=>{for(let e of f.getAllRegions())e.entityInRegion(t)?(t.addTag("inRegion"),e.permissions.pvp||t.addTag("region-protected")):(t.removeTag("inRegion"),t.removeTag("region-protected"))},5);import{world as Se}from"mojang-minecraft";Se.events.playerJoin.subscribe(({player:t})=>{let e=Se.events.tick.subscribe(n=>{try{y.overworld.runCommand(`testfor @a[name="${t.name}"]`),Se.events.tick.unsubscribe(e),v.getMuteData(t)&&t.runCommand("ability @s mute true");let r=k.getPlayersRoleToSet(t.name);r&&t.setDynamicProperty("role",r)}catch{}})});import{MinecraftItemTypes as xt,world as Ce}from"mojang-minecraft";var mt=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],Nt=[10,11,12,13,14,15,16,19,20,21,22,23,24,25,28,29,30,31,32,33,34,37,38,39,40,41,42,43];function $t(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let i=0;i<r.size;i++){let o=e.slots[i];if(!o||!o.item){r.setItem(i,z);continue}r.setItem(i,o.item.setComponents())}for(let[i,o]of[...Ce.getPlayers()].entries()){let c=mt[i],l=new p("minecraft:skull",1,3,{nameTag:o.name});r.setItem(c,l.setComponents()),e.slots[c]={item:l,action:m=>{m.PageAction("moderation:see_inventory",{name:o.name})}}}}function Ot(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let m=0;m<r.size;m++){let h=e.slots[m];if(!h||!h.item){r.setItem(m,z);continue}r.setItem(m,h.item.setComponents())}let i=new p("minecraft:ender_chest",1,0,{nameTag:`\xA7eView \xA7f${n?.name}\xA7e Ender Chest
\xA7fNote: \xA7cThis will not grab \xA7lANY NBT!\xA7r`});r.setItem(49,i.setComponents()),e.slots[49]={item:i,action:m=>{m.PageAction("moderation:see_ender_chest",{name:n.name})}};let o=[...Ce.getPlayers()].find(m=>m.name==n.name);if(!o)return;let c=o.getComponent("inventory").container,l=0;for(let m=0;m<c.size;m++){let h=c.getItem(m);if(!h)continue;let ae=mt[l];l++,r.setItem(ae,h),e.slots[ae]={item:new p(h.id,h.amount,h.data,null,h),action:lt=>{m<9?o.runCommand(`replaceitem entity @s slot.hotbar ${m} air`):o.runCommand(`replaceitem entity @s slot.inventory ${m-9} air`),lt.GiveAction(),e.slots[ae]={item:null,action:dt=>{c.addItem(dt.getItemAdded())}}}}}}function Mt(t,e,n){let r=t.getComponent("minecraft:inventory").container;for(let c=0;c<r.size;c++){let l=e.slots[c];if(!l||!l.item){r.setItem(c,z);continue}r.setItem(c,l.item.setComponents())}let i=[...Ce.getPlayers()].find(c=>c.name==n?.name);if(!i)return;let o=0;for(let c of Object.values(xt))try{i.runCommand(`testfor @s[hasitem={item=${c.id},location=slot.enderchest}]`);let l=new p(c.id,1,0,{nameTag:"Note: \xA7l\xA7cThis is not the exzact item"}),m=Nt[o];r.setItem(m,l.setComponents()),e.slots[m]={item:l,action:h=>{h.GiveAction(),e.slots[m]=null}},o++}catch{}}new I("moderation:see",54,$t).setSlots([45,46,47,49,51,52,53],new p("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([50],new p("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),t=>{t.PageAction("home")}).setButtonAtSlot(48,b);new I("moderation:see_inventory",54,Ot).setSlots([45,46,47,49,51,52,53],new p("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([50],new p("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setButtonAtSlot(48,b);new I("moderation:see_ender_chest",54,Mt).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,49,51,52,53],new p("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),t=>{t.SetAction()}).setSlots([50],new p("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setButtonAtSlot(48,b);var s={config:new g("config"),freezes:new g("freezes"),mutes:new g("mutes"),bans:new g("bans"),regions:new g("regions"),roles:new g("roles"),tasks:new g("tasks")},ct={},tt=[],z=new Bt(zt.stick,0);Y(()=>{ct={};for(let t of j.getPlayers()){let e=De(t.location),n=e.offset(S.x,S.y,S.z),r=e.offset(-S.x,-S.y,-S.z);for(let i of n.blocksBetween(r)){if(i.y<-64)continue;let o=t.dimension.getBlock(i);!Pe.includes(o.id)||(ct[JSON.stringify(i)]=new X(o.getComponent("inventory").container))}}},100);j.events.worldInitialize.subscribe(({propertyRegistry:t})=>{Be("tickingarea add 0 0 0 0 0 0 db true");let e=new Ee;e.defineString("name",30),e.defineNumber("index"),t.registerEntityTypeDynamicProperties(e,Lt.get(U));let n=new Ee;n.defineString("role",30),t.registerEntityTypeDynamicProperties(n,Dt.player);let r=new Ee;r.defineBoolean("roleHasBeenSet"),t.registerWorldDynamicProperties(r)});Ft.events.beforeWatchdogTerminate.subscribe(t=>{t.cancel=!0,console.warn(`WATCHDOG TRIED TO CRASH = ${t.terminateReason}`)});var Gt=j.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{if(j.getDynamicProperty("roleHasBeenSet"))return j.events.beforeDataDrivenEntityTriggerEvent.unsubscribe(Gt);t.entity.id=="minecraft:player"&&t.id=="rubedo:becomeAdmin"&&(t.entity.setDynamicProperty("role","admin"),s.roles.set(t.entity.name,"admin"),j.setDynamicProperty("roleHasBeenSet",!0),t.entity.tell("\xA7l\xA7cYou have been given admin, the function start will not work anymore!!!!"))});export{z as AIR,ct as CONTAINER_LOCATIONS,tt as NPC_LOCATIONS,s as TABLES};
