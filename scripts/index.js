import{DynamicPropertiesDefinition as ze,EntityTypes as In,ItemStack as vn,MinecraftEntityTypes as En,MinecraftItemTypes as Sn,Player as Cn,system as Tn,world as V}from"mojang-minecraft";import{world as P,BlockLocation as Ie,MinecraftBlockTypes as At,MinecraftDimensionTypes as we}from"mojang-minecraft";var _={"api.name":()=>"Smelly API","api.error.unknown":()=>"An unknown error has occured.","api.database.error.table_name":(e,t)=>`The display name ${e} is too long for an objective, it can be at most ${t} characters long`,"api.utilities.formatter.error.ms":e=>`${e} is not a string or a number`,"api.Providers.form.invaildtype":(e,t)=>`Type ${e} is not a vaild type to add a ${t}`,"api.Providers.form.invaildFormtype":(e,t)=>{`${e}${JSON.stringify(t)}`},"api.ChestGUI.error.pagenotfound":e=>`Page ${e} not found!`,"modules.protections.cps.clickingToFast":()=>"You are clicking to fast! Please click slower!","modules.managers.mute.isMuted":()=>"You are muted and cannot send messages please try again later","modules.commands.ban.reply":(e,t,n,r)=>`\xA7cBanned \xA7f"\xA7a${e}\xA7f" \xA7cfor ${t} ${n} Because: "${r??"No reason Provided"}" \xA7aSuccessfully`};import{BlockLocation as Et,world as St}from"mojang-minecraft";var Ge=32e3,K="rubedo:database",be=St.getDimension("overworld"),_e=new Et(0,-64,0);import{ItemStack as Ct,MinecraftItemTypes as Tt}from"mojang-minecraft";function Fe(e,t){return e.match(new RegExp(".{1,"+t+"}","g"))}var u=class{static compress(t){return t}static decompress(t){return t}static createEntity(t,n){let r=be.spawnEntity(K,_e);r.setDynamicProperty("name",t),r.setDynamicProperty("index",n);let i=r.getComponent("inventory").container,o=new Ct(Tt.acaciaBoat,1);return n==0&&(o.nameTag="{}"),i.setItem(0,o),r}static getInventorySlotName(t,n){return t.getComponent("inventory").container.getItem(n)?.nameTag}static setInventorySlotName(t,n,r){let i=t.getComponent("inventory").container,o=i.getItem(n);return o.nameTag=r,i.setItem(n,o)}constructor(t){this.name=t,this.savedEntitys=void 0,this.MEMORY=void 0}get entitys(){if(this.savedEntitys)return this.savedEntitys;let t=be.getEntitiesAtBlockLocation(_e).filter(n=>n.id==K&&n.getDynamicProperty("name")==this.name);return this.savedEntitys=t,t}data(){if(this.MEMORY)return this.MEMORY;if(this.entitys.length==0&&u.createEntity(this.name,0),this.entitys.length==1){let n=JSON.parse(u.decompress(u.getInventorySlotName(this.entitys[0],0)));return this.MEMORY=n,n}let t=new Array(this.entitys.length);for(let n of this.entitys){let r=n.getDynamicProperty("index");t[r]=u.getInventorySlotName(n,0)}try{t=JSON.parse(t.join(""))}catch{t={}}return this.MEMORY=t,t}save(t){this.MEMORY=t;let n=Fe(u.compress(JSON.stringify(t)),Ge);if(this.entitys&&n.length==this.entitys.length)for(let r=0;r<n.length;r++)u.setInventorySlotName(this.entitys[r],0,n[r]);else{this.entitys?.forEach(r=>r?.triggerEvent("despawn")),this.savedEntitys=void 0;for(let r=0;r<n.length;r++){let i=u.createEntity(this.name,r);u.setInventorySlotName(i,0,n[r])}}}set(t,n){let r=this.data();r[t]=n,this.save(r)}get(t){return this.data()[t]}has(t){return this.keys().includes(t)}delete(t){let n=this.data(),r=delete n[t];return this.save(n),r}size(){return this.keys().length}clear(){this.save({})}keys(){return Object.keys(this.data())}values(){return Object.values(this.data())}getCollection(){return this.data()}};var a={config:new u("config"),freezes:new u("freezes"),mutes:new u("mutes"),bans:new u("bans"),regions:new u("regions"),roles:new u("roles"),tasks:new u("tasks")};var He={doorsAndSwitches:!0,openContainers:!0,pvp:!1,allowedEntitys:["minecraft:player","minecraft:npc","minecraft:item"]},Ye=["minecraft:acacia_door","minecraft:acacia_trapdoor","minecraft:acacia_button","minecraft:birch_door","minecraft:birch_trapdoor","minecraft:birch_button","minecraft:crimson_door","minecraft:crimson_trapdoor","minecraft:crimson_button","minecraft:dark_oak_door","minecraft:dark_oak_trapdoor","minecraft:dark_oak_button","minecraft:jungle_door","minecraft:jungle_trapdoor","minecraft:jungle_button","minecraft:mangrove_door","minecraft:mangrove_trapdoor","minecraft:mangrove_button","minecraft:spruce_door","minecraft:spruce_trapdoor","minecraft:spruce_button","minecraft:warped_door","minecraft:warped_trapdoor","minecraft:warped_button","minecraft:wooden_door","minecraft:wooden_button","minecraft:trapdoor","minecraft:iron_door","minecraft:iron_trapdoor","minecraft:polished_blackstone_button","minecraft:lever"],je=["minecraft:chest","minecraft:ender_chest","minecraft:barrel","minecraft:trapped_chest","minecraft:dispenser","minecraft:dropper","minecraft:furnace","minecraft:blast_furnace","minecraft:lit_furnace","minecraft:lit_blast_furnace","minecraft:hopper","minecraft:shulker_box","minecraft:undyed_shulker_box"];var ke=[],Pt=!1,Ue=-64,Ve=320;function Ke(e,t,n){return n.every((r,i)=>r>=Math.min(e[i],t[i])&&r<=Math.max(e[i],t[i]))}var p=class{static getAllRegions(){if(Pt)return ke;let t=a.regions.values().map(n=>new p(n.from,n.to,n.dimensionId,n.permissions,n.key));return t.forEach(n=>{ke.push(n)}),t}static blockLocationInRegion(t,n){return this.getAllRegions().find(r=>r.dimensionId==n&&Ke([r.from.x,Ue,r.from.z],[r.to.x,Ve,r.to.z],[t.x,t.y,t.z]))}static removeRegionAtBlockLocation(t,n){let r=this.blockLocationInRegion(t,n);return r?a.regions.delete(r.key):!1}constructor(t,n,r,i,o){this.from=t,this.to=n,this.dimensionId=r,this.permissions=i??He,this.key=o||Date.now().toString(),o||(this.update(),te(),ke.push(this))}update(){a.regions.set(this.key,{key:this.key,from:this.from,dimensionId:this.dimensionId,permissions:this.permissions,to:this.to})}delete(){return a.regions.delete(this.key)}entityInRegion(t){return this.dimensionId==t.dimension.id&&Ke([this.from.x,Ue,this.from.z],[this.to.x,Ve,this.to.z],[t.location.x,t.location.y,t.location.z])}changePermission(t,n){this.permissions[t]=n,this.update()}};var k=class{static getTasks(){return a.tasks.get("changePlayerRole")??[]}static getPlayersRoleToSet(t){return k.getTasks().find(r=>r.playerName==t)?.role}constructor(t,n){let r=k.getTasks();r.push({playerName:t,role:n}),a.tasks.set("changePlayerRole",r)}};var I={overworld:P.getDimension(we.overworld),nether:P.getDimension(we.nether),theEnd:P.getDimension(we.theEnd)};function ne(e,t=[],n){try{e.runCommand(`kick "${e.nameTag}" \xA7r${t.join(`
`)}`),e.triggerEvent("kick")}catch(r){if(!/"statusCode":-2147352576/.test(r))return;n&&n()}}function s(e){if(typeof e=="string"){let t=[...P.getPlayers()].find(n=>n.name==e);return t?t.getDynamicProperty("role"):a.roles.get(e)??"member"}else return e.getDynamicProperty("role")}function Je(e,t){if(typeof e=="string"){a.roles.set(e,t);let n=[...P.getPlayers()].find(r=>r.name==e);n?n.setDynamicProperty("role",t):new k(e,t)}else a.roles.set(e.name,t),e.setDynamicProperty("role",t)}function te(){for(let e of p.getAllRegions()){let t=new Ie(e.from.x,-64,e.from.z),n=new Ie(e.to.x,-64,e.to.z);for(let r of t.blocksBetween(n))I[e.dimensionId].getBlock(r)?.setType(At.deny)}}var Xe={};function h(e,t=0){let n=Date.now();return Xe[n]={callback:e,delay:t,lastCall:0},n}P.events.tick.subscribe(e=>{let t=[...P.getPlayers()];for(let[n,r]of t.entries()){if(["moderator","admin"].includes(s(r)))return;for(let i of Object.values(Xe))i.delay!=0&&e.currentTick-i.lastCall<i.delay||(i.callback(r,e),n==t.length-1&&(i.lastCall=e.currentTick))}});function qe(e,t="overworld",n=!1){try{return n?console.warn(JSON.stringify(this.runCommand(e))):I.overworld.runCommand(e)}catch{return{error:!0}}}function f(e){try{return e.scoreboard.id.toString()}catch{try{e.runCommand("scoreboard objectives add test dummy")}catch{}try{e.runCommand("scoreboard players add @s test 0")}catch{}return e.scoreboard.id.toString()}}function M(e,{compactDuration:t,fullDuration:n,avoidDuration:r}={}){try{if(typeof e=="string"){if(/^\d+$/.test(e))return Number(e);let i=e.match(/-?\d*\.?\d+\s*?(years?|yrs?|weeks?|days?|hours?|hrs?|minutes?|mins?|seconds?|secs?|milliseconds?|msecs?|ms|[smhdwy])/gi);return i?i.reduce((o,c)=>o+Rt(c),0):null}if(typeof e=="number")return xt(e,{compactDuration:t,fullDuration:n,avoidDuration:r});throw new Error(_["api.utilities.formatter.error.ms"](e))}catch(i){let o=Nt(i)?`${i.message}. Value = ${JSON.stringify(e)}`:_["api.error.unknown"]();throw new Error(o)}}function Rt(e){let t=Number(e.replace(/[^-.0-9]+/g,""));return e=e.replace(/\s+/g,""),/\d+(?=y)/i.test(e)?t*3154e7:/\d+(?=w)/i.test(e)?t*6048e5:/\d+(?=d)/i.test(e)?t*864e5:/\d+(?=h)/i.test(e)?t*36e5:/\d+(?=m)/i.test(e)?t*6e4:/\d+(?=s)/i.test(e)?t*1e3:/\d+(?=ms|milliseconds?)/i.test(e)?t:0}function xt(e,{compactDuration:t,fullDuration:n,avoidDuration:r}={}){let i=Math.abs(e),c=[{short:"w",long:"week",duration:Math.floor(i/6048e5)},{short:"d",long:"day",duration:Math.floor(i/864e5)%7},{short:"h",long:"hour",duration:Math.floor(i/36e5)%24},{short:"m",long:"minute",duration:Math.floor(i/6e4)%60},{short:"s",long:"second",duration:Math.floor(i/1e3)%60},{short:"ms",long:"millisecond",duration:i%1e3}].filter(m=>m.duration!==0&&r?n&&!r.map(y=>y.toLowerCase()).includes(m.short):m.duration).map(m=>`${Math.sign(e)===-1?"-":""}${t?`${Math.floor(m.duration)}${m.short}`:`${Math.floor(m.duration)} ${m.long}${m.duration===1?"":"s"}`}`);return(n?c.join(t?" ":", "):c[0])||`${i}`}function Nt(e){return typeof e=="object"&&e!==null&&"message"in e}function We(e){return new Ie(Math.floor(e.x),Math.floor(e.y),Math.floor(e.z))}import{world as $t}from"mojang-minecraft";var A="-";var re=class{constructor(t,n){this.data=t,this.args=n,this.sender=t.sender}reply(t){this.sender.tell(t)}run(t){try{this.sender.runCommand(t)}catch{}}invalidArg(t){this.sender.tell({translate:"commands.generic.parameter.invalid",with:[t]})}invalidPermission(){this.sender.tell({translate:"commands.generic.permission.selector"})}give(t){this.sender.getComponent("minecraft:inventory").container.addItem(t)}};import{BlockLocation as Ot,world as Lt}from"mojang-minecraft";function Ze([e,t,n],{location:r,viewVector:i}){if(!e||!t||!e)return null;let o=[e,t,n].map(l=>{let m=parseInt(l.replace(/\D/g,""));return isNaN(m)?0:m}),c=[e,t,n].map((l,m)=>l.includes("~")?o[m]+r[m]:l.includes("^")?o[m]+i[m]:o[m]);return new Ot(c[0],c[1],c[2])}function ve(e){return[...Lt.getPlayers()].find(t=>t.name===e)}var $=class{};$.fail="commands.generic.parameter.invalid",$.validate=t=>t&&t!="",$.parse=t=>t;var v=class{};v.fail="commands.generic.num.invalid",v.validate=t=>!isNaN(t),v.parse=t=>parseInt(t);var B=class{};B.fail=v.fail,B.validate=t=>t?.match(/^\d+\.\d+$/)?.[0],B.parse=t=>parseFloat(t);var D=class{};D.fail=v.fail,D.validate=t=>t?.match(/^([\~\^]{1})?([-]?\d*)$/)?.[0],D.parse=t=>t;var z=class{};z.fail="commands.generic.boolean.invalid",z.validate=t=>t?.match(/^(true|false)$/)?.[0],z.parse=t=>t=="true";var G=class{};G.fail="commands.generic.player.notFound",G.validate=t=>!!ve(t),G.parse=t=>ve(t);var F=class{};F.fail="commands.generic.player.notFound",F.validate=t=>t?.match(/^(@.|"[\s\S]+")$/)?.[0],F.parse=t=>t;var H=class{};H.fail="commands.generic.parameter.invalid",H.validate=(t,n)=>n.includes(t),H.parse=t=>t;var ie={string:$,int:v,float:B,location:D,boolean:z,player:G,target:F,array:H};var R=class{constructor(t,n,r,i=!1){this.name=t,this.type=n,this.description=r,this.optional=i}verify(t){return Array.isArray(this.type)?ie.array.validate(t,this.type):ie[this.type].validate(t)}validate(t){return Array.isArray(this.type)?t:ie[this.type].parse(t)}};var Mt=e=>!0;function Qe(e){let t=Ee(e),n=(o,c)=>c.every((l,m)=>l===o[m]),r=null,i={};for(let o of x){i[o.path.toString()]=o;for(let c of o.aliases){let l=[...o.path];l[0]=c,i[l.toString()]=o}if(o.path.length>1){let c=x.find(l=>l.name==o.path[0]);for(let l of c.aliases){let m=[...o.path];m[0]=l,i[m.toString()]=o}}}for(let[o,c]of Object.entries(i)){let l=o.split(",");n(t,l)&&(r=c)}return r}function Ee(e){return e.message.slice(A.length).trim().match(/"[^"]+"|[^\s]+/g).map(t=>t.replace(/"(.+)"/,"$1").toString())}var d=class{constructor(t,n){this.name=t.name.toString().toLowerCase(),this.description=t.description,this.aliases=t.aliases??[],this.tags=t.tags??[],this.hasPermission=t.hasPermission??Mt,this.path=t.path??[this.name],this.permissions=t.permissions??[],this.options=[],this.callback=n,x.push(this)}addSubCommand(t,n){let r=[...this.path];return r.push(t.name),new d({name:t.name,description:t.description,tags:t.tags,hasPermission:t.hasPermission,path:r},n)}addOption(t,n,r,i=!1){return n=="location"?(this.options.push({name:t,type:"location",description:r,optional:i,x:new R(`x${Date.now()}`,n,r,i),y:new R(`y${Date.now()}`,n,r,i),z:new R(`z${Date.now()}`,n,r,i)}),this):(this.options.push(new R(t,n,r,i)),this)}getName(){return this.name}sendCallback(t,n){if(!this.callback)return;let r={};for(let[i,o]of this.options.entries()){if(o.type=="location"){r[o.name]=Ze([n[i],n[i+1],n[i+2]],{location:[t.sender.location.x,t.sender.location.y,t.sender.location.z],viewVector:[t.sender.viewVector.x,t.sender.viewVector.y,t.sender.viewVector.z]});continue}r[o.name]=o.validate(n[i])}this.callback(new re(t,n),r)}executes(t){return this.callback=t,this}};var x=[];$t.events.beforeChat.subscribe(e=>{try{if(!e.message.startsWith(A))return;e.cancel=!0;let t=Ee(e),n=Qe(e);if(!n||!n.callback)return e.sender.tell({translate:"commands.generic.unknown",with:[`\xA7f${t[0]}\xA7c`]});if(!n.tags.every(r=>e.sender.hasTag(r))||!n.hasPermission(e.sender))return e.sender.tell("You do not have permission to use this command");t.shift(),t=t.filter(r=>!n.path.includes(r));for(let[r,i]of n.options.entries()){if(i.type=="location"){if(i.x.verify(t[r]))if(t?.[r+1]&&i.y.verify(t[r+1])){if(t?.[r+2]&&i.z.verify(t[r+2]))continue;r+=2}else r+=1}else if(i.verify(t[r]))continue;if(i.optional)break;return e.sender.tell({translate:"commands.generic.syntax",with:[`${A}${n.path.join(" ")} ${t.slice(0,r).join(" ")}`,t[r],t.slice(r+1).join(" ")]})}n.sendCallback(e,t)}catch(t){console.warn(`${t} : ${t.stack}`),e.cancel=!1}});import{world as Re}from"mojang-minecraft";var Se="rubedo:gui",Ce="rubedo:inventory",et="home";import{world as j}from"mojang-minecraft";var J={};function oe(e,t,n){let r=e.getComponent("minecraft:inventory").container;for(let i=0;i<r.size;i++){let o=t.slots[i];if(!o||!o.item){r.setItem(i,Y);continue}r.setItem(i,o.item.setComponents())}}function tt(e){let t="";if(e){let{id:n,nameTag:r,amount:i,data:o}=e;t=[n,r,i,o].join("")}return t}var E=class{constructor(t,n,r=oe){if(n%9!=0)throw new Error("Size needs to be in a increment of 9");if(J[t])throw new Error(`Id of ${t} Already exsists`);this.id=t,this.size=n,this.slots=Array(this.size),this.fillType=r,J[t]=this}setSlots(t,n,r){let i=n?{item:n,action:r}:null;for(let o of t)this.slots[o]=i;return this}setButtonAtSlot(t,n){return this.slots[t]={item:n.Item,action:n.Action},this}};import{world as nt}from"mojang-minecraft";var rt=new Map,X=class{constructor(t,n,r=!1,i=Date.now()){this.callbackTick=null,this.tickDelay=n,this.loop=r,this.callback=t,this.id=i,rt.set(i,this),this.TickCallBack=nt.events.tick.subscribe(({currentTick:o})=>{if(this.callbackTick||(this.callbackTick=o+this.tickDelay),!(this.callbackTick>o)){if(this.callback(o),!this.loop)return this.expire();this.callbackTick=o+this.tickDelay}})}expire(){nt.events.tick.unsubscribe(this.TickCallBack),rt.delete(this.id)}};var it=e=>new Promise(t=>Te(t,e));function Te(e,t){new X(e,t)}function w(e,t){return new X(e,t,!0)}var se=class{constructor(t,n,r){this.gui=t,this.slot=n,this.change=r}message(t){this.gui.player.tell(t)}getItemAdded(){return this.slot.item?null:this.gui.entity.getComponent("minecraft:inventory").container.getItem(this.change.slot)}GiveAction(t=this.slot.item.itemStack){this.gui.player.getComponent("minecraft:inventory").container.addItem(t)}TakeAction(t=null){this.gui.player.getComponent("minecraft:inventory").container.addItem(this.slot.item.itemStack),this.gui.page.slots[this.change.slot]=null,t&&t.delete(this.slot.item.components.dbKey)}PageAction(t,n){this.gui.setPage(t,n)}BackAction(t=1){if(this.gui.pageHistory.length<t)return new Error("Tried to Go back to a page number that doesnt exist");console.warn(JSON.stringify(this.gui.pageHistory));let n=this.gui.pageHistory.splice(-1-t)[0];console.warn(JSON.stringify(this.gui.page.extras)),this.PageAction(n,this.gui.page.extras)}CloseAction(){this.gui.kill()}SetAction(){this.gui.entity.getComponent("minecraft:inventory").container.setItem(this.change.slot,this.slot.item.itemStack)}async FormAction(t){return this.CloseAction(),await it(5),await t.show(this.gui.player)}};import{MinecraftDimensionTypes as Bt}from"mojang-minecraft";async function ot(e,t){try{let n=e.getComponent("minecraft:inventory").container,r=[];for(let i=0;i<n.size;i++){let o=n.getItem(i);!o||o?.id==t?.id&&(r.push({slot:i,item:o}),n.setItem,i<9?e.runCommand(`replaceitem entity @s slot.hotbar ${i} air`):e.runCommand(`replaceitem entity @s slot.inventory ${i-9} air`))}e.runCommand(`clear @s ${t?.id} ${t.data} ${t.amount}`);for(let i of r)n.setItem(i.slot,i.item)}catch(n){console.warn(n+n.stack),[...e.dimension.getEntities({type:"minecraft:item",location:e.location,maxDistance:2,closest:1})].forEach(r=>r.kill())}}function st(e,t){return e.getComponent("minecraft:inventory").container.getItem(t)}function at(e){let t=[];for(let n of Object.keys(Bt))[...I[n].getEntities()].forEach(r=>t.push(r));return e?t.filter(n=>n?.id==e):t}function Pe(e){return e.getComponent("minecraft:inventory").container.getItem(e.selectedSlot)}var N={},U=class{static getEntitysGuiInstance(t){return Object.values(N).find(n=>n.entity==t)}static getSlotChange(t,n){if(t.length!=n.length)return null;for(let r=0;r<t.length;r++)if(t[r].uid!=n[r].uid)return{slot:r,item:t[r].item};return null}constructor(t,n){this.player=t,this.playersName=t.name,this.entity=n,this.previousMap=null,this.HAS_CONTAINER_OPEN=!1,this.pageHistory=[],this.extras=null,this.page=null,this.loops=[],this.entity||this.summon(),this.events={tick:j.events.tick.subscribe(()=>{try{if(!this.HAS_CONTAINER_OPEN||!this.previousMap)return;for(let i of this.loops)i();let r=U.getSlotChange(this.previousMap,this.mapInventory);if(r==null)return;this.onSlotChange(r)}catch(r){console.warn(r+r.stack)}}),playerLeave:j.events.playerLeave.subscribe(({playerName:r})=>{r==this.playersName&&this.kill()}),beforeDataDrivenEntityTriggerEvent:j.events.beforeDataDrivenEntityTriggerEvent.subscribe(r=>{if(!!["rubedo:has_container_open","rubedo:dosent_have_container_open"].includes(r.id)&&r.entity.nameTag==this.player.nameTag){if(r.id=="rubedo:has_container_open")return this.HAS_CONTAINER_OPEN=!0;this.HAS_CONTAINER_OPEN=!1}})},N[this.playersName]=this}summon(){try{at(Ce)?.find(n=>n.getTags().includes(`id:${this.playersName}`))?.triggerEvent("despawn");let t=j.events.entityCreate.subscribe(n=>{n.entity?.id==Ce&&(this.entity=n.entity,this.entity.addTag(`id:${this.playersName}`),this.setPage(et)),j.events.entityCreate.unsubscribe(t)});this.player.triggerEvent("rubedo:spawn_inventory")}catch(t){console.warn(t+t.stack)}}reload(){this.entity.triggerEvent("despawn"),this.summon()}kill(){try{this.entity?.triggerEvent("despawn")}catch{}for(let t in this.events)j.events[t].unsubscribe(this.events[t]);delete N[this.playersName]}setPage(t,n){this.extras=n,this.pageHistory.push(t),this.loops=[];let r=J[t];if(!r)return new Error(_["api.ChestGUI.error.pagenotfound"](t??"Undefined"));r.fillType(this.entity,r,n),this.page=r,this.previousMap=this.mapInventory,this.entity.nameTag=`size:${r.size}`??"size:27"}get mapInventory(){let t=this.entity.getComponent("inventory").container,n=[];for(let r=0;r<t.size;r++){let i=t.getItem(r);n.push({uid:tt(i),item:i})}return this.previousMap=n,n}onSlotChange(t){let n=this.page.slots[t.slot];if(!n)this.entity.runCommand(`replaceitem entity @s slot.inventory ${t.slot} air`);else{if(n.item&&ot(this.player,n.item),!n.item&&!st(this.entity,t.slot))return;this.runItemAction(n,t)}this.previousMap=this.mapInventory}runItemAction(t,n){!t.action||t.action(new se(this,t,n))}registerLoop(t){this.loops.push(t)}};import{Items as Dt,ItemStack as zt,MinecraftEnchantmentTypes as Ae}from"mojang-minecraft";var g=class{static itemStackToItem(t,n={}){let r=t.getComponent("enchantments").enchantments,i=[];for(let o in Ae)!r.getEnchantment(Ae[o])||i.push(Ae[o]);return new g(t.id,t.amount,t.data,{nameTag:t.nameTag,lore:t.getLore(),enchantments:i})}constructor(t,n=1,r=0,i={},o){this.id=t,this.amount=n,this.data=r,this.components=i,this.itemStack=o||new zt(Dt.get(this.id),n,r)}setComponents(t=this.components){if(this.components=t,t?.nameTag&&(this.itemStack.nameTag=t.nameTag),this.components?.lore&&this.itemStack.setLore(this.components.lore),t?.enchantments?.length>0){let n=this.itemStack.getComponent("enchantments").enchantments;for(let r of t.enchantments)n.addEnchantment(r);this.itemStack.getComponent("enchantments").enchantments=n}return this.itemStack}};var ae=class{};ae.Item=new g("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),ae.Action=t=>{t.BackAction()};var b=class{};b.Item=new g("minecraft:barrier",1,0,{nameTag:"\xA7cClose GUI"}),b.Action=t=>{t.CloseAction()};var yi=new E("home",54,oe).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,48,50,51,52,53],new g("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),e=>{e.SetAction()}).setSlots([22],new g("minecraft:ender_chest",1,0,{nameTag:"\xA7l\xA7bInventory Viewer"}),e=>{e.PageAction("moderation:see")}).setButtonAtSlot(49,b);Re.events.tick.subscribe(()=>{for(let e of Re.getPlayers()){if(s(e)!="admin")continue;if(Pe(e)?.id!=Se)return;N[e.name]||(N[e.name]=new U(e))}});Re.events.tick.subscribe(()=>{for(let e of Object.values(N))if(!!e.entity?.id){try{if(e.entity.getComponent("minecraft:health").current<=0)return e.kill()}catch{e.kill()}if(Pe(e.player)?.id!=Se||!e.player)return e.kill();e.entity.teleport(e.player.location,e.player.dimension,0,0)}});var S=class{constructor(t,n,r,i="No Reason",o="Smelly Anti Cheat"){n=n?M(`${n} ${r}`):null;let c={key:f(t),player:t.name,date:Date.now(),length:n,expire:n?n+Date.now():null,reason:i,by:o};a.bans.set(f(t),c)}};new d({name:"ban",description:"Ban players for lengths",hasPermission:e=>s(e)=="admin"}).addOption("player","player","Player to ban").addOption("length","int","Time ammount to ban").addOption("unit","string","The unit for the time").addOption("reason","string","reason for ban",!0).executes((e,{player:t,length:n,unit:r,reason:i})=>{new S(t,n,r,i,e.sender.name),e.reply(_["modules.commands.ban.reply"](t.name,n,r,i))});var O={aquaAffinity:1,baneOfArthropods:5,binding:1,blastProtection:4,channeling:1,depthStrider:3,efficiency:5,featherFalling:4,fireAspect:2,fireProtection:4,flame:1,fortune:3,frostWalker:2,impaling:5,infinity:1,knockback:2,looting:3,loyalty:4,luckOfTheSea:3,lure:3,mending:1,multishot:1,piercing:4,power:5,projectileProtection:4,protection:4,punch:2,quickCharge:3,respiration:3,riptide:3,sharpness:5,silkTouch:1,smite:5,soulSpeed:3,swiftSneak:4,thorns:3,unbreaking:3,vanishing:1};var q=["minecraft:beehive","minecraft:beenest","minecraft:acacia_standing_sign","minecraft:acacia_wall_sign","minecraft:agent_spawn_egg","minecraft:allay_spawn_egg","minecraft:allow","minecraft:axolotl_bucket","minecraft:axolotl_spawn_egg","minecraft:balloon","minecraft:bamboo_sapling","minecraft:barrier","minecraft:barrier","minecraft:bat_spawn_egg","minecraft:bedrock","minecraft:bee_nest","minecraft:bee_spawn_egg","minecraft:beehive","minecraft:birch_standing_sign","minecraft:birch_wall_sign","minecraft:blackstone_double_slab","minecraft:blaze_spawn_egg","minecraft:border_block","minecraft:brewingstandblock","minecraft:bubble_column","minecraft:camera","minecraft:carrots","minecraft:cat_spawn_egg","minecraft:cave_spider_spawn_egg","minecraft:cave_vines","minecraft:cave_vines_body_with_berries","minecraft:chain_command_block","minecraft:chemical_heat","minecraft:chemistry_table","minecraft:chicken_spawn_egg","minecraft:client_request_placeholder_block","minecraft:cobbled_deepslate_double_slab","minecraft:cod_bucket","minecraft:cod_spawn_egg","minecraft:colored_torch","minecraft:colored_torch_bp","minecraft:colored_torch_rg","minecraft:command_block","minecraft:command_block_minecart","minecraft:compound","minecraft:compoundcreator","minecraft:cow_spawn_egg","minecraft:creeper_spawn_egg","minecraft:crimson_double_slab","minecraft:crimson_standing_sign","minecraft:crimson_wall_sign","minecraft:darkoak_standing_sign","minecraft:darkoak_wall_sign","minecraft:daylight_detector_inverted","minecraft:debug_stick","minecraft:deepslate_brick_double_slab","minecraft:deepslate_tile_double_slab","minecraft:deny","minecraft:dolphin_spawn_egg","minecraft:donkey_spawn_egg","minecraft:double_cut_copper_slab","minecraft:double_wooden_slab","minecraft:drowned_spawn_egg","minecraft:elder_guardian_spawn_egg","minecraft:end_gateway","minecraft:end_portal","minecraft:end_portal_frame","minecraft:enderman_spawn_egg","minecraft:endermite_spawn_egg","minecraft:evoker_spawn_egg","minecraft:exposed_double_cut_copper_slab","minecraft:fire","minecraft:flowing_lava","minecraft:flowing_water","minecraft:fox_spawn_egg","minecraft:frog_spawn_egg","minecraft:frosted_ice","minecraft:ghast_spawn_egg","minecraft:glow_squid_spawn_egg","minecraft:glow_stick","minecraft:glowingobsidian","minecraft:goat_spawn_egg","minecraft:guardian_spawn_egg","minecraft:hard_glass","minecraft:hard_glass_pane","minecraft:hard_stained_glass","minecraft:hard_stained_glass_pane","minecraft:hoglin_spawn_egg","minecraft:horse_spawn_egg","minecraft:husk_spawn_egg","minecraft:ice_bomb","minecraft:info_update","minecraft:info_update2","minecraft:invisible_bedrock","minecraft:invisiblebedrock","minecraft:item.acacia_door","minecraft:item.bed","minecraft:item.beetroot","minecraft:item.birch_door","minecraft:item.cake","minecraft:item.campfire","minecraft:item.cauldron","minecraft:item.chain","minecraft:item.crimson_door","minecraft:item.dark_oak_door","minecraft:item.flower_pot","minecraft:item.frame","minecraft:item.glow_frame","minecraft:item.hopper","minecraft:item.iron_door","minecraft:item.jungle_door","minecraft:item.kelp","minecraft:item.nether_sprouts","minecraft:item.nether_wart","minecraft:item.reeds","minecraft:item.skull","minecraft:item.soul_campfire","minecraft:item.spruce_door","minecraft:item.warped_door","minecraft:item.wheat","minecraft:item.wooden_door","minecraft:jigsaw","minecraft:jungle_standing_sign","minecraft:jungle_wall_sign","minecraft:lava","minecraft:lava_cauldron","minecraft:light_block","minecraft:lit_blast_furnace","minecraft:lit_deepslate_redstone_ore","minecraft:lit_furnace","minecraft:lit_redstone_lamp","minecraft:lit_redstone_ore","minecraft:lit_smoker","minecraft:llama_spawn_egg","minecraft:magma_cube_spawn_egg","minecraft:medicine","minecraft:melon_stem","minecraft:mob_spawner","minecraft:mooshroom_spawn_egg","minecraft:movingBlock","minecraft:moving_block","minecraft:movingblock","minecraft:mule_spawn_egg","minecraft:netherreactor","minecraft:npc_spawn","minecraft:npc_spawn_egg","minecraft:ocelot_spawn_egg","minecraft:oxidized_double_cut_copper_slab","minecraft:panda_spawn_egg","minecraft:parrot_spawn_egg","minecraft:phantom_spawn_egg","minecraft:pig_spawn_egg","minecraft:piglin_brute_spawn_egg","minecraft:piglin_spawn_egg","minecraft:pillager_spawn_egg","minecraft:piston_arm_collision","minecraft:piston_arm_collision","minecraft:pistonarmcollision","minecraft:polar_bear_spawn_egg","minecraft:polished_blackstone_brick_double_slab","minecraft:polished_blackstone_double_slab","minecraft:polished_deepslate_double_slab","minecraft:portal","minecraft:potatoes","minecraft:powder_snow","minecraft:powder_snow_bucket","minecraft:powered_comparator","minecraft:powered_repeater","minecraft:pufferfish_bucket","minecraft:pufferfish_spawn_egg","minecraft:pumpkin_stem","minecraft:rabbit_spawn_egg","minecraft:rapid_fertilizer","minecraft:ravager_spawn_egg","minecraft:real_double_stone_slab","minecraft:real_double_stone_slab2","minecraft:real_double_stone_slab3","minecraft:real_double_stone_slab4","minecraft:redstone_wire","minecraft:repeating_command_block","minecraft:reserved3","minecraft:reserved4","minecraft:reserved6","minecraft:salmon_bucket","minecraft:salmon_spawn_egg","minecraft:sea_turtle_spawn_egg","minecraft:sheep_spawn_egg","minecraft:shulker_spawn_egg","minecraft:silverfish_spawn_egg","minecraft:skeleton_horse_spawn_egg","minecraft:skeleton_spawn_egg","minecraft:slime_spawn_egg","minecraft:soul_fire","minecraft:soul_fire","minecraft:sparkler","minecraft:spawn_egg","minecraft:spawn_egg","minecraft:spawner","minecraft:spider_spawn_egg","minecraft:spruce_standing_sign","minecraft:spruce_wall_sign","minecraft:squid_spawn_egg","minecraft:standing_banner","minecraft:standing_sign","minecraft:stickyPistonArmCollision","minecraft:sticky_piston_arm_collision","minecraft:stonecutter","minecraft:stray_spawn_egg","minecraft:strider_spawn_egg","minecraft:structure_block","minecraft:structure_void","minecraft:tadpole_bucket","minecraft:tadpole_spawn_egg","minecraft:tripwire","minecraft:tropical_fish_bucket","minecraft:tropical_fish_spawn_egg","minecraft:underwater_torch","minecraft:unknown","minecraft:unlit_redstone_ore","minecraft:unpowered_comparator","minecraft:unpowered_repeater","minecraft:vex_spawn_egg","minecraft:villager_spawn_egg","minecraft:vindicator_spawn_egg","minecraft:wall_banner","minecraft:wall_sign","minecraft:wandering_trader_spawn_egg","minecraft:warden_spawn_egg","minecraft:warped_double_slab","minecraft:warped_standing_sign","minecraft:warped_wall_sign","minecraft:water","minecraft:waxed_double_cut_copper_slab","minecraft:waxed_exposed_double_cut_copper_slab","minecraft:waxed_oxidized_double_cut_copper_slab","minecraft:waxed_weathered_double_cut_copper_slab","minecraft:weathered_double_cut_copper_slab","minecraft:witch_spawn_egg","minecraft:wither_spawn_egg","minecraft:wolf_spawn_egg","minecraft:zoglin_spawn_egg","minecraft:zombie_horse_spawn_egg","minecraft:zombie_spawn_egg","minecraft:zombie_villager_spawn_egg","minecraft:zombified_piglin_spawn_egg"],W=["minecraft:moving_block","minecraft:beehive","minecraft:beenest"],me=["minecraft:chest","minecraft:trapped_chest"],L={x:7,y:7,z:7};var xe=new d({name:"config",description:"Opens up a form to configure rubedo",hasPermission:e=>s(e)=="admin"}),mt=xe.addSubCommand({name:"banned",description:"Manages banned items/blocks on this server",hasPermission:e=>s(e)=="admin"}),ct=mt.addSubCommand({name:"items",description:"Manages the banned items on this server",hasPermission:e=>s(e)=="admin"});ct.addSubCommand({name:"add",description:"Adds a item to the banned items list",hasPermission:e=>s(e)=="admin"}).addOption("item","string","item to add make sure it is prefix:item").executes((e,{item:t})=>{let n=a.config.get("banned_items")??q;n.includes(t)||n.push(t),a.config.set("banned_items",n),e.reply(`Banned the item "${t}"`)});ct.addSubCommand({name:"remove",description:"Removes a item from the banned items list",hasPermission:e=>s(e)=="admin"}).addOption("item","string","item to remove make sure it is prefix:item").executes((e,{item:t})=>{let n=a.config.get("banned_items")??q;if(!n.includes(t))return e.reply(`item: "${t}" is not banned`);n=n.filter(r=>r!=t),a.config.set("banned_items",n),e.reply(`Removed Banned item "${t}"`)});var lt=mt.addSubCommand({name:"blocks",description:"Manages the banned blocks on this server",hasPermission:e=>s(e)=="admin"});lt.addSubCommand({name:"add",description:"Adds a block to the banned blocks list",hasPermission:e=>s(e)=="admin"}).addOption("block","string","item to add make sure it is prefix:block").executes((e,{block:t})=>{let n=a.config.get("banned_blocks")??W;n.includes(t)||n.push(t),a.config.set("banned_blocks",t),e.reply(`Banned the block "${t}"`)});lt.addSubCommand({name:"remove",description:"Removes a block from the banned blocks list",hasPermission:e=>s(e)=="admin"}).addOption("block","string","block to remove make sure it is prefix:block").executes((e,{block:t})=>{let n=a.config.get("banned_blocks")??W;if(!n.includes(t))return e.reply(`block: "${t}" is not banned`);n=n.filter(r=>r!=t),a.config.set("banned_blocks",t),e.reply(`Removed Banned block "${t}"`)});var dt=xe.addSubCommand({name:"enchantments",description:"Manages the maxEnchants on this srrver",hasPermission:e=>s(e)=="admin"});dt.addSubCommand({name:"set",description:"Sets a enchantment to a level",hasPermission:e=>s(e)=="admin"}).addOption("enchantment",Object.keys(O),"enchantment to change").addOption("level","int","Max level to change the enchantment to").executes((e,{enchantment:t,level:n})=>{let r=a.config.get("enchantments")??O;r[t]=n,a.config.set("enchantments",r),e.reply(`Set max level for ${t} to ${n}`)});dt.addSubCommand({name:"get",description:"Gets the max level for a enchantment",hasPermission:e=>s(e)=="admin"}).addOption("enchantment",Object.keys(O),"enchantment to change").executes((e,{enchantment:t})=>{let n=a.config.get("enchantments")??O;e.reply(`Max level for ${t} is ${n[t]}`)});xe.addSubCommand({name:"setAppealLink",description:"Sets the appeal link for this server",hasPermission:e=>s(e)=="admin"}).addOption("link","string","the link to have people go to, to appeal").executes((e,{link:t})=>{a.config.set("appealLink",t),e.reply(`Changed the servers appeal link to ${t}`)});var Ne=new d({name:"database",description:"Interacts with SA Database",aliases:["db"],hasPermission:e=>s(e)=="admin"});Ne.addSubCommand({name:"get",hasPermission:e=>s(e)=="admin"}).addOption("table","string","Table to grab from").addOption("key","string","Key to grab").executes((e,{table:t,key:n})=>{try{let r=a[t].get(n);r?e.reply(r):e.reply(`No data could be found for key ${n}`)}catch(r){e.reply(r+r.stack)}});Ne.addSubCommand({name:"set",hasPermission:e=>s(e)=="admin"}).addOption("table","string","Table to set to").addOption("key","string","Key to set").addOption("value","string","Value to assign to the key").executes((e,{table:t,key:n,value:r})=>{try{a[t].set(n,r),e.reply(`Set Key: "${n}", to value: "${r}" on table: "${t}"`)}catch(i){e.reply(i+i.stack)}});Ne.addSubCommand({name:"clear",hasPermission:e=>s(e)=="admin"}).addOption("table","string","Table to set to").executes((e,{table:t})=>{try{a[t].clear(),e.reply(`Cleared Table ${t}`)}catch(n){e.reply(n+n.stack)}});new d({name:"ecwipe",description:"Clears a players ender chest",hasPermission:e=>s(e)=="admin"}).addOption("player","player","Player to clear").executes((e,{player:t})=>{for(let n=0;n<27;n++)t.runCommand(`replaceitem entity @s slot.enderchest ${n} air`);e.reply(`Cleared ${t.name} Ender chest!`)});var ce=class{constructor(t,n="No Reason"){let r={player:t.name,key:f(t),reason:n,location:{x:t.location.x,y:t.location.y,z:t.location.z,dimension:t.dimension.id}};a.freezes.set(f(t),r)}};new d({name:"freeze",description:"Freeze a player",hasPermission:e=>s(e)=="admin"}).addOption("player","player","Player to ban").addOption("reason","string","reason for ban",!0).executes((e,{player:t,reason:n})=>{new ce(t,n),e.reply(`\xA7cFroze \xA7f"\xA7a${t.name}\xA7f" Because: "${n??"No reason Provided"}" \xA7aSuccessfully`),e.sender.tell(`\xA7cYou have been frozen by \xA7f"\xA7a${e.sender.nameTag}\xA7f" Because: "${n??"No reason Provided"}"`)});new d({name:"help",description:"Provides help/list of commands.",aliases:["?","h"]},e=>{if(x.length==0)return e.reply("No Commands Found");let t=x.filter(o=>o.callback&&o.hasPermission(e.sender)),n=1,r=Math.ceil(t.length/10),i=e.args[0];if(i)if(!isNaN(parseInt(i)))n=parseInt(i);else{let o=t.find(c=>c.path.includes(i));if(!o)return e.reply(`The command ${i} does not exist`);e.sender.tell({rawtext:[{translate:"commands.help.command.aliases",with:[o.name,o.aliases.join(", ")]}]}),e.reply(o.description),e.reply(`Usage: 
`);for(let c of t.filter(l=>l.path[0]==e.args[0])){let l=c.options.map(m=>`${m.optional?"[":"<"}${m.name}: ${m.type}${m.optional?"]":">"}`);e.reply(`-${c.path.join(" ")} ${l.join(" ")}`)}return}n>r&&(n=r),e.sender.tell({rawtext:[{translate:"commands.help.header",with:[n.toString(),r.toString()]}]});for(let o of t.slice(n*10-10,n*10)){let c=o.options.map(l=>`${l.optional?"[":"<"}${l.name}: ${l.type}${l.optional?"]":">"}`);e.reply(`-${o.path.join(" ")} ${c.join(" ")}`)}});var C=class{static getMuteData(t){return a.mutes.get(f(t))}constructor(t,n,r,i="No Reason",o="Smelly Anti Cheat"){t.runCommand("ability @s mute true");let c=n?M(`${n} ${r}`):null,l={player:f(t),date:Date.now(),length:c,expire:c?c+Date.now():null,reason:i,by:o};a.mutes.set(f(t),l)}};new d({name:"mute",description:"Mute a player for lengths",hasPermission:e=>["admin","moderator"].includes(s(e))}).addOption("player","player","Player to mute").addOption("length","int","Time ammount of mute",!0).addOption("unit","string","The unit for the time",!0).addOption("reason","string","reason for mute",!0).executes((e,{player:t,length:n,unit:r,reason:i})=>{new C(t,n,r,i,e.sender.nameTag),e.reply(`\xA7cMuted \xA7f"\xA7a${t.name}\xA7f" \xA7cfor ${n} ${r} Because: "${i??"No reason Provided"}" \xA7aSuccessfully`),t.tell(`\xA7cYou have been muted by \xA7f"${e.sender.name}" \xA7cfor ${n} ${r} Because: "${i??"No reason Provided"}"`)});new d({name:"npc",description:"Spawns a npc at your coordinates",hasPermission:e=>s(e)=="admin"},e=>{le.push(e.sender.location),e.sender.dimension.spawnEntity("minecraft:npc",e.sender.location),e.reply("Spawned a verifed npc at your current location")});import{world as ft}from"mojang-minecraft";new d({name:"ping",description:"Returns the current TPS of the servers ping"},e=>{let t=ft.events.tick.subscribe(({deltaTime:n})=>{e.reply(`Pong! Current TPS: ${1/n}`),ft.events.tick.unsubscribe(t)})});import{BlockLocation as Z}from"mojang-minecraft";var Q=new d({name:"region",description:"Create a Region",hasPermission:e=>s(e)=="admin"});Q.addSubCommand({name:"add",description:"Adds a new protection region",hasPermission:e=>s(e)=="admin"}).addOption("from_x","int","The starting x of the region").addOption("from_z","int","The starting z of the region").addOption("to_x","int","The ending x of the region").addOption("to_z","int","The ending z of the region").executes((e,{from_x:t,from_z:n,to_x:r,to_z:i})=>{new p({x:t,z:n},{x:r,z:i},e.sender.dimension.id),e.reply(`Created Region From ${t} -64 ${n} ${r} 320 ${i}`)});Q.addSubCommand({name:"remove",description:"Removes a region at the players current postion",hasPermission:e=>s(e)=="admin"},e=>{let t=new Z(e.sender.location.x,e.sender.location.y,e.sender.location.z);p.removeRegionAtBlockLocation(t,e.sender.dimension.id)?e.reply(`Removed Region at ${t.x} ${t.y} ${t.z}`):e.reply(`Failed to find/remove region at ${t.x} ${t.y} ${t.z}`)});Q.addSubCommand({name:"removeAll",description:"Removes all regions",hasPermission:e=>s(e)=="admin"},e=>{p.getAllRegions().forEach(t=>t.delete()),e.reply("Removed All regions")});Q.addSubCommand({name:"list",description:"Lists all regions and positions",hasPermission:e=>s(e)=="admin"},e=>{let t=p.getAllRegions();for(let n of t)e.reply(`Region from ${n.from.x}, ${n.from.z} to ${n.to.x}, ${n.to.z} in dimension ${n.dimensionId}`);if(t.length==0)return e.reply("No regions have been made yet")});var Oe=Q.addSubCommand({name:"permission",description:"Handels permissions for regions",hasPermission:e=>s(e)=="admin"});Oe.addSubCommand({name:"set",description:"Sets a certin permission on the region the player is currently in to a value",hasPermission:e=>s(e)=="admin"}).addOption("key",["doorsAndSwitches","openContainers","pvp"],"The region permission to change").addOption("value","boolean","If this permission should be on or off").executes((e,{key:t,value:n})=>{let r=p.blockLocationInRegion(new Z(e.sender.location.x,e.sender.location.y,e.sender.location.z),e.sender.dimension.id);if(!r)return e.reply("You are not in a region");r.changePermission(t,n),e.reply(`Changed permision ${t} to ${n}`)});Oe.addSubCommand({name:"list",description:"Lists the permissions for the current region",hasPermission:e=>s(e)=="admin"},e=>{let t=p.blockLocationInRegion(new Z(e.sender.location.x,e.sender.location.y,e.sender.location.z),e.sender.dimension.id);if(!t)return e.reply("You are not in a region");e.reply(`Current region permissions ${JSON.stringify(t.permissions)}`)});var pt=Oe.addSubCommand({name:"entities",description:"Holds the subCommands for adding or removing allowedEntitys",hasPermission:e=>s(e)=="admin"});pt.addSubCommand({name:"add",description:"Adds a entity to the allowed entitys list",hasPermission:e=>s(e)=="admin"}).addOption("entity","string","the entity id to add").executes((e,{entity:t})=>{let n=p.blockLocationInRegion(new Z(e.sender.location.x,e.sender.location.y,e.sender.location.z),e.sender.dimension.id);if(!n)return e.reply("You are not in a region");let r=n.permissions.allowedEntitys;r.push(t),n.changePermission("allowedEntitys",r),e.reply(`Added entity ${t} to the allowed entitys of the region your currently standing in`)});pt.addSubCommand({name:"remove",description:"Removes a entity from the allowed entitys in the region",hasPermission:e=>s(e)=="admin"}).addOption("entity","string","the entity id to add").executes((e,{entity:t})=>{let n=p.blockLocationInRegion(new Z(e.sender.location.x,e.sender.location.y,e.sender.location.z),e.sender.dimension.id);if(!n)return e.reply("You are not in a region");let r=n.permissions.allowedEntitys;if(!r.includes(t))return e.reply(`The entity ${t} is not allowed to enter the region`);r=r.filter(i=>i!=t),n.changePermission("allowedEntitys",r),e.reply(`Removed entity ${t} to the allowed entitys of the region your currently standing in`)});import{world as Le}from"mojang-minecraft";var gt=new d({name:"role",description:"Changes role for a player",hasPermission:e=>s(e)=="admin"||Le.getDynamicProperty("worldsOwner")==f(e)});gt.addSubCommand({name:"set",description:"Sets the role for a player",hasPermission:e=>s(e)=="admin"||Le.getDynamicProperty("worldsOwner")==f(e)}).addOption("playerName","string","player to set").addOption("role",["member","moderator","admin"],"Role to set this player to").executes((e,{playerName:t,role:n})=>{Je(t,n),e.reply(`Changed role of ${t} to ${n}`)});gt.addSubCommand({name:"get",description:"Gets the role of a player",hasPermission:e=>s(e)=="admin"||Le.getDynamicProperty("worldsOwner")==f(e)}).addOption("playerName","string","player to set").executes((e,{playerName:t})=>{e.reply(`${t} has role: ${s(t)}`)});import{world as ut}from"mojang-minecraft";new d({name:"vanish",description:"Toggles Vanish Mode on the sender",hasPermission:e=>s(e)=="admin"}).addOption("say","boolean","if say you left/joined",!0).executes((e,{say:t})=>{if(e.sender.hasTag("spectator")){if(e.sender.runCommand("gamemode c"),e.sender.runCommand("event entity @s removeSpectator"),e.sender.removeTag("spectator"),!t)return;ut.say({rawtext:[{translate:"multiplayer.player.joined",with:[`\xA7e${e.sender.name}`]}]})}else{if(e.sender.runCommand("gamemode spectator"),e.sender.runCommand("event entity @s addSpectator"),e.sender.addTag("spectator"),!t)return;ut.say({rawtext:[{translate:"multiplayer.player.left",with:[`\xA7e${e.sender.name}`]}]})}});new d({name:"unban",description:"Unban a banned player",hasPermission:e=>s(e)=="admin"}).addOption("playerName","string","Player to ban").executes((e,{playerName:t})=>{let n=a.bans.values().find(r=>r.player==t);if(!n)return e.reply(`${t} is not banned`);a.bans.delete(n.key),e.reply(`\xA7a${t}\xA7r has been Unbanned!`)});new d({name:"unfreeze",description:"Unfreeze a frozen player",hasPermission:e=>s(e)=="admin"}).addOption("playerName","string","Player to unfreeze").executes((e,{playerName:t})=>{let n=a.freezes.values().find(r=>r.player==t);if(!n)return e.reply(`${t} is not frozen`);a.freezes.delete(n.key),e.reply(`\xA7a${t}\xA7r has been UnFrozen!`)});new d({name:"unmute",description:"Unmutes a muted player",hasPermission:e=>["admin","moderator"].includes(s(e))}).addOption("playerName","string","Player to unfreeze").executes((e,{playerName:t})=>{let n=a.mutes.values().find(r=>r.player==t);if(!n)return e.reply(`${t} is not muted!`);a.mutes.delete(n.player);try{e.sender.runCommand(`ability "${t}" mute false`)}catch{}e.reply(`\xA7a${t}\xA7r has been UnMuted!`)});var yt="2.4.0-beta";var ht="https://discord.gg/dMa3A5UYKX";new d({name:"version",description:"Get Current Version",aliases:["v"]},e=>{e.reply(`Current Rubedo Version: ${yt}`)});h(e=>{let t=f(e),n=a.bans.get(t);if(!!n){if(n.expire&&n.expire<Date.now())return a.bans.delete(t);ne(e,["\xA7cYou have been banned!",`\xA7aReason: \xA7f${n.reason}`,`\xA7fExpiry: \xA7b${n.expire?M(n.length):"Forever"}`,`\xA7fAppeal at: \xA7b${a.config.get("appealLink")??ht}`],()=>{a.bans.delete(t)})}},20);import{Location as Gt}from"mojang-minecraft";h(e=>{let t=a.freezes.get(f(e));!t||e.teleport(new Gt(t.location.x,t.location.y,t.location.z),I[t.location.dimension],0,0)},20);import{world as Ft}from"mojang-minecraft";Ft.events.beforeChat.subscribe(e=>{if(e.message.startsWith(A))return;let t=C.getMuteData(e.sender);if(!!t){if(t.expire&&t.expire<Date.now())return a.mutes.delete(f(e.sender));e.cancel=!0,e.sender.tell(_["modules.managers.mute.isMuted"]())}});import{BlockLocation as Ht,world as de}from"mojang-minecraft";w(()=>{te()},6e3);de.events.beforeItemUseOn.subscribe(e=>{if(["moderator","admin"].includes(s(e.source)))return;let t=p.blockLocationInRegion(e.blockLocation,e.source.dimension.id);if(!t)return;let n=e.source.dimension.getBlock(e.blockLocation);Ye.includes(n.id)&&t.permissions.doorsAndSwitches||je.includes(n.id)&&t.permissions.openContainers||(e.cancel=!0)});de.events.beforeExplosion.subscribe(e=>{for(let t=0;t<e.impactedBlocks.length;t++){let n=e.impactedBlocks[t];if(p.blockLocationInRegion(n,e.dimension.id))return e.cancel=!0}});de.events.entityCreate.subscribe(e=>{let t=p.blockLocationInRegion(new Ht(e.entity.location.x,e.entity.location.y,e.entity.location.z),e.entity.dimension.id);!t||t.permissions.allowedEntitys.includes(e.entity.id)||(e.entity.teleport({x:0,y:-64,z:0},e.entity.dimension,0,0),e.entity.kill())});w(()=>{for(let e of p.getAllRegions())for(let t of de.getDimension(e.dimensionId).getEntities({excludeTypes:e.permissions.allowedEntitys}))!e.entityInRegion(t)||(t.teleport({x:0,y:-64,z:0},t.dimension,0,0),t.kill())},100);h(e=>{for(let t of p.getAllRegions())t.entityInRegion(e)?(e.addTag("inRegion"),t.permissions.pvp||e.addTag("region-protected")):(e.removeTag("inRegion"),e.removeTag("region-protected"))},5);import{world as Me}from"mojang-minecraft";Me.events.playerJoin.subscribe(({player:e})=>{let t=Me.events.tick.subscribe(n=>{try{I.overworld.runCommand(`testfor @a[name="${e.name}"]`),Me.events.tick.unsubscribe(t),C.getMuteData(e)&&e.runCommand("ability @s mute true");let r=k.getPlayersRoleToSet(e.name);r&&e.setDynamicProperty("role",r)}catch{}})});import{MinecraftItemTypes as Yt,world as $e}from"mojang-minecraft";var bt=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],jt=[10,11,12,13,14,15,16,19,20,21,22,23,24,25,28,29,30,31,32,33,34,37,38,39,40,41,42,43];function Ut(e,t,n){let r=e.getComponent("minecraft:inventory").container;for(let i=0;i<r.size;i++){let o=t.slots[i];if(!o||!o.item){r.setItem(i,Y);continue}r.setItem(i,o.item.setComponents())}for(let[i,o]of[...$e.getPlayers()].entries()){let c=bt[i],l=new g("minecraft:skull",1,3,{nameTag:o.name});r.setItem(c,l.setComponents()),t.slots[c]={item:l,action:m=>{m.PageAction("moderation:see_inventory",{name:o.name})}}}}function Vt(e,t,n){let r=e.getComponent("minecraft:inventory").container;for(let m=0;m<r.size;m++){let y=t.slots[m];if(!y||!y.item){r.setItem(m,Y);continue}r.setItem(m,y.item.setComponents())}let i=new g("minecraft:ender_chest",1,0,{nameTag:`\xA7eView \xA7f${n?.name}\xA7e Ender Chest
\xA7fNote: \xA7cThis will not grab \xA7lANY NBT!\xA7r`});r.setItem(49,i.setComponents()),t.slots[49]={item:i,action:m=>{m.PageAction("moderation:see_ender_chest",{name:n.name})}};let o=[...$e.getPlayers()].find(m=>m.name==n.name);if(!o)return;let c=o.getComponent("inventory").container,l=0;for(let m=0;m<c.size;m++){let y=c.getItem(m);if(!y)continue;let he=bt[l];l++,r.setItem(he,y),t.slots[he]={item:new g(y.id,y.amount,y.data,null,y),action:It=>{m<9?o.runCommand(`replaceitem entity @s slot.hotbar ${m} air`):o.runCommand(`replaceitem entity @s slot.inventory ${m-9} air`),It.GiveAction(),t.slots[he]={item:null,action:vt=>{c.addItem(vt.getItemAdded())}}}}}}function Kt(e,t,n){let r=e.getComponent("minecraft:inventory").container;for(let c=0;c<r.size;c++){let l=t.slots[c];if(!l||!l.item){r.setItem(c,Y);continue}r.setItem(c,l.item.setComponents())}let i=[...$e.getPlayers()].find(c=>c.name==n?.name);if(!i)return;let o=0;for(let c of Object.values(Yt))try{i.runCommand(`testfor @s[hasitem={item=${c.id},location=slot.enderchest}]`);let l=new g(c.id,1,0,{nameTag:"Note: \xA7l\xA7cThis is not the exzact item"}),m=jt[o];r.setItem(m,l.setComponents()),t.slots[m]={item:l,action:y=>{y.GiveAction(),t.slots[m]=null}},o++}catch{}}new E("moderation:see",54,Ut).setSlots([45,46,47,49,51,52,53],new g("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),e=>{e.SetAction()}).setSlots([50],new g("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),e=>{e.PageAction("home")}).setButtonAtSlot(48,b);new E("moderation:see_inventory",54,Vt).setSlots([45,46,47,49,51,52,53],new g("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),e=>{e.SetAction()}).setSlots([50],new g("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),e=>{e.PageAction("moderation:see")}).setButtonAtSlot(48,b);new E("moderation:see_ender_chest",54,Kt).setSlots([0,1,2,3,4,5,6,7,8,9,17,18,26,27,35,36,44,45,46,47,49,51,52,53],new g("minecraft:stained_glass_pane",1,15,{nameTag:"\xA7r"}),e=>{e.SetAction()}).setSlots([50],new g("minecraft:arrow",1,0,{nameTag:"\xA7fBack"}),e=>{e.PageAction("moderation:see")}).setButtonAtSlot(48,b);import{world as Jt}from"mojang-minecraft";var Xt=64,qt=32,Wt=["minecraft:command_block_minecart"];h(e=>{let n=e.getComponent("minecraft:inventory").container.getItem(e.selectedSlot);if(!n)return;let r=()=>e.runCommand(`replaceitem entity @s slot.hotbar ${e.selectedSlot} air`);if(n.amount>Xt||(a.config.get("banned_items")??q).includes(n.id)||n.nameTag?.length>qt)return r();let o=n.getComponent("enchantments").enchantments,c=a.config.get("enchantments")??O,l=[];for(let m of o){let y=c[m.type.id]??m.type.maxLevel;if(o.slot==0&&!o.canAddEnchantment(m)||m.level>y||l.includes(m.type.id))return r();l.push(m.type.id)}},5);Jt.events.entityCreate.subscribe(e=>{let t=()=>{try{e.entity.triggerEvent("despawn"),e.entity.kill()}catch{e.entity.kill()}};if(Wt.includes(e.entity.id)||e.entity.id=="minecraft:npc"&&!le.find(n=>n.equals(e.entity.location)))return t()});var Be=1e5;h(e=>{(Math.abs(e.location.x)>Be||Math.abs(e.location.y)>Be||Math.abs(e.location.z)>Be)&&new S(e,null,null,"Hacking: Crasher")});import{world as Zt}from"mojang-minecraft";var T=class{constructor(){this.data=new Map,this.events={playerLeave:Zt.events.playerLeave.subscribe(t=>this.data.delete(t.playerName))}}set(t,n){this.data.set(t.name,n)}get(t){return this.data.get(t.name)}delete(t){this.data.delete(t.name)}clear(){this.data.clear()}playerNames(){return[...this.data.keys()]}};import{world as fe}from"mojang-minecraft";var pe=class{constructor(t,n,r){this.player=t,this.location=t.location,this.dimension=t.dimension,this.rotation=t.rotation,this.tick=n,this.storage=r,this.events={playerLeave:fe.events.playerLeave.subscribe(({playerName:i})=>{i==this.player.name&&this.expire()})},this.storage.set(t,this)}back(){this.player.teleport(this.location,this.dimension,this.rotation.x,this.rotation.y)}update(){let t=fe.events.tick.subscribe(n=>{this.tick=n.currentTick,fe.events.tick.unsubscribe(t)});this.location=this.player.location,this.dimension=this.player.dimension,this.rotation=this.player.rotation}expire(){this.storage.delete(this.player);for(let t in this.events)fe.events[t].unsubscribe(this.events[t])}};var _t=new T,Qt=.9,en=20,tn=!0,nn=["gliding","riding","levitating","swimming"];function rn(e){return e.getComponent("minecraft:inventory").container.getItem(e.selectedSlot)}h((e,{currentTick:t})=>{if(e.getTags().some(i=>nn.includes(i)))return;let n=()=>_t.get(e)??new pe(e,t,_t),r=Math.sqrt(e.velocity.x**2+e.velocity.z**2);if(e.hasTag("on_ground"))return n().update();if(!(r<Qt)&&rn(e)?.id!="minecraft:trident"&&!(t-n().tick<en)&&(n().back(),tn))try{e.runCommand("damage @s 4 fly_into_wall")}catch{}},20);import{GameMode as on,world as sn}from"mojang-minecraft";var an=on.creative;w(()=>{for(let e of sn.getPlayers({gameMode:an})){if(["moderator","admin","builder"].includes(s(e)))return;try{e.runCommand("gamemode s"),e.runCommand("clear @s")}catch{}}},20);import{world as mn}from"mojang-minecraft";var De=new T,cn=10;mn.events.entityHit.subscribe(e=>{if(e.entity.getEntitiesFromViewVector()[0]==e.hitEntity)return;let t=(De.get(e.entity)??0)+1;De.set(e.entity,t),!(t<=cn)&&new S(e.entity,null,null,"Kill aura")});w(()=>{De.clear()},20);import{world as kt}from"mojang-minecraft";var ln=/^([\p{L}])([\p{L}\d\s#'()-_]{1,20})([\p{L}\d\)])$/isu,dn="\xA7c\xA7k\xA7m\xA7A\xA7r\xA7cToolbox Gamer\xA7k\xA7mA\xA7r";kt.events.playerJoin.subscribe(({player:e})=>{let t=e.name,n=()=>ne(e,["\xA7cYou have been kicked!",`\xA7aReason: \xA7f'${t}' is Invalid`,"\xA7fThis Server requires you to have a valid gamertag!"]);if(t==dn||!ln.test(t)||[...kt.getPlayers()].filter(r=>r.name==e.name).length>1)return n()});import{world as pn,Location as gn}from"mojang-minecraft";import{world as fn}from"mojang-minecraft";var ge=class{constructor(t){this.emptySlotsCount=t.emptySlotsCount,this.size=t.size,this.items=[];for(let n=0;n<this.size;n++)this.items[n]=t.getItem(n)}load(t){for(let n=0;n<t.size;n++)!this.items[n]||t.setItem(n,this.items[n])}};var ue={};w(()=>{ue={};for(let e of fn.getPlayers()){let t=We(e.location),n=t.offset(L.x,L.y,L.z),r=t.offset(-L.x,-L.y,-L.z);for(let i of n.blocksBetween(r)){if(i.y<-64)continue;let o=e.dimension.getBlock(i);!me.includes(o.id)||(ue[JSON.stringify(i)]=new ge(o.getComponent("inventory").container))}}},100);var wt=new T,un=70,yn=["snow","lush_plants_replaceable","azalea_log_replaceable","minecraft:crop","fertilize_area"],hn=["minecraft:water","minecraft:flowing_water","minecraft:lava","minecraft:flowing_lava","minecraft:bedrock"];pn.events.blockBreak.subscribe(({block:e,brokenBlockPermutation:t,dimension:n,player:r})=>{if(["moderator","admin"].includes(s(r))||e.getTags().some(o=>yn.includes(o)))return;let i=wt.get(r);if(wt.set(r,Date.now()),!!i&&!hn.includes(e.id)&&!(i<Date.now()-un)){if(n.getBlock(e.location).setPermutation(t.clone()),me.includes(t.type.id)){let o=ue[JSON.stringify(e.location)];o&&o.load(e.getComponent("inventory").container)}Te(()=>{[...n.getEntities({maxDistance:2,type:"minecraft:item",location:new gn(e.location.x,e.location.y,e.location.z)})].forEach(o=>o.kill())},0)}});import{world as bn,MinecraftBlockTypes as _n}from"mojang-minecraft";bn.events.blockPlace.subscribe(({block:e,player:t})=>{if(["moderator","admin"].includes(s(t)))return;(a.config.get("banned_blocks")??W).includes(e.id)&&e.setType(_n.air)});import{MinecraftBlockTypes as kn,world as ye}from"mojang-minecraft";var wn=7;function ee(e,t){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2+(e.z-t.z)**2)>wn}ye.events.beforeItemUseOn.subscribe(e=>{!ee(e.source.location,e.blockLocation)||(e.cancel=!0)});ye.events.blockBreak.subscribe(e=>{!ee(e.player.location,e.block.location)||e.dimension.getBlock(e.block.location).setPermutation(e.brokenBlockPermutation)});ye.events.blockPlace.subscribe(e=>{!ee(e.player.location,e.block.location)||e.dimension.getBlock(e.block.location).setType(kn.air)});ye.events.entityHit.subscribe(e=>{if(e.hitEntity){if(!ee(e.entity.location,e.hitEntity.location))return}else if(e.hitBlock){if(!ee(e.entity.location,e.hitBlock.location))return}else return});var le=[],Y=new vn(Sn.stick,0);V.events.worldInitialize.subscribe(({propertyRegistry:e})=>{qe("tickingarea add 0 0 0 0 0 0 db true");let t=new ze;t.defineString("name",30),t.defineNumber("index"),e.registerEntityTypeDynamicProperties(t,In.get(K));let n=new ze;n.defineString("role",30),e.registerEntityTypeDynamicProperties(n,En.player);let r=new ze;r.defineBoolean("roleHasBeenSet"),r.defineString("worldsOwner",100),e.registerWorldDynamicProperties(r)});Tn.events.beforeWatchdogTerminate.subscribe(e=>{e.cancel=!0,console.warn(`WATCHDOG TRIED TO CRASH = ${e.terminateReason}`)});var Pn=V.events.beforeDataDrivenEntityTriggerEvent.subscribe(e=>{if(V.getDynamicProperty("roleHasBeenSet"))return V.events.beforeDataDrivenEntityTriggerEvent.unsubscribe(Pn);e.entity instanceof Cn&&e.id=="rubedo:becomeAdmin"&&(e.entity.setDynamicProperty("role","admin"),a.roles.set(e.entity.name,"admin"),V.setDynamicProperty("roleHasBeenSet",!0),V.setDynamicProperty("worldsOwner",f(e.entity)),e.entity.tell("\xA7l\xA7cYou have been given admin, the function start will not work anymore!!!!"))});export{Y as AIR,le as NPC_LOCATIONS};
/**
 * Minecraft Bedrock Anti Bad Blocks
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti block place stops players from placing unwanted blocks
 * Simpliy when a player places a blocks it tests if that block is banned
 * And cancles that block from being placed, (add more blocks to list)
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti CBE
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This is a anti hacked items, meaning it checks a players inventory every
 * tick then it tests if they have any banned items, then checks if they have
 * items that have hacked enchants and clears the item from inventory
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Crasher
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti crasher works by testing if a player has reached a location
 * Horion's crasher teleports the player to 30 Million so we just test for
 * That location and if they are there we kick the player (USES: player.json)
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Fly
 * @license MIT
 * @author Smell of curry
 * @author moisesgamingtv9
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti fly works by detecting horizontal velocity, bassicly when
 * the player has reached the FLYING_VELOCITY they are considered flying And
 * if they are considered flying for 1 second they will be teleported back.
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Gamemode
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This checks every tick to test if a player has entered a gamemode that they
 * shouldnet be able to get into. If the player has the staff tag it wont
 * check the list of illegle gamemodes are below
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti NameSpoof
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This is a anti Bad gamertag it checks when a player joins if there name is
 * invaild it determins its invalid by checking the length and characters in it
 * the requirememts are from xbox gamertag requiremnts
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Nuker
 * @license MIT
 * @author Smell of curry
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * This anti nuker works by loging everytime a player breaks a block
 * Then the next time they break a block it tests the time from now to then
 * And if they broke a block in 50 miliseconds than we place that block back
 * --------------------------------------------------------------------------
 */
/**
 * Minecraft Bedrock Anti Reach
 * @license MIT
 * @author Smell of curry
 * @author Visual1mpact
 * @version 1.0.0
 * --------------------------------------------------------------------------
 * Detect players who are reaching and autmaticly cancel that action
 * Works with block placing, block interacting, block destroying, and hurting
 * entitys. tests by using 7 block max reach distance
 * --------------------------------------------------------------------------
 */
