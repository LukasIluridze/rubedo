import{ItemStack as Ro,MinecraftItemTypes as _o,world as Lo}from"@minecraft/server";import{world as Bn}from"@minecraft/server";var v="-";import{Location as An}from"@minecraft/server";import{world as Pn}from"@minecraft/server";import{BlockLocation as wn}from"@minecraft/server";var lt=32e3,ee="rubedo:database",B=new wn(0,-64,0);import{ItemStack as Sn,MinecraftItemTypes as En}from"@minecraft/server";function dt(t,e){return t.match(new RegExp(".{1,"+e+"}","g"))}import{BlockLocation as Tn,MinecraftDimensionTypes as K,world as q}from"@minecraft/server";import{MessageFormData as vn}from"@minecraft/server-ui";var Y=class{constructor(e,n){this.title=e,this.body=n,this.form=new vn,e&&this.form.title(e),n&&this.form.body(n),this.triedToShow=0}setButton1(e,n){return this.button1={text:e,callback:n},this.form.button1(e),this}setButton2(e,n){return this.button2={text:e,callback:n},this.form.button2(e),this}show(e){this.form.show(e).then(n=>{if(n.canceled){if(n.cancelationReason=="userBusy"){if(this.triedToShow>200)return e.tell("\xA7cForm Timeout: tried to show form, but you were busy (close chat after running command)");this.triedToShow++,this.show(e)}return}n.selection==1&&this.button1?.callback?.(),n.selection==0&&this.button2?.callback?.()})}};var b={overworld:q.getDimension(K.overworld),nether:q.getDimension(K.nether),theEnd:q.getDimension(K.theEnd),"minecraft:overworld":q.getDimension(K.overworld),"minecraft:nether":q.getDimension(K.nether),"minecraft:the_end":q.getDimension(K.theEnd)};function ne(t){let e=t.split(",");console.warn(e.length);let n=0;for(let o of e){let r=parseInt(o.match(/\D+|\d+/g)[0]),i=o.match(/\D+|\d+/g)[1];i=="y"&&(n=n+317098e-16*r),i=="w"&&(n=n+6048e5*r),i=="d"&&(n=n+864e5*r),i=="h"&&(n=n+36e5*r),i=="m"&&(n=n+6e4*r),i=="s"&&(n=n+1e3*r),i=="ms"&&(n=n+r)}return n}function W(t){return new Date(t).toString()}function ut(t){return new Tn(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))}function he(t,e,n,o=()=>{}){new Y("Confirm To Continue",e).setButton1("Confirm",n).setButton2("Never Mind",o).show(t)}var f=class{static compress(e){return e}static decompress(e){return e}static createEntity(e,n){let o=b.overworld.spawnEntity(ee,B);o.setDynamicProperty("name",e),o.setDynamicProperty("index",n);let r=o.getComponent("inventory").container,i=new Sn(En.acaciaBoat,1);return n==0&&(i.nameTag="{}"),r.setItem(0,i),o}static getInventorySlotName(e,n){return e.getComponent("inventory").container.getItem(n)?.nameTag}static setInventorySlotName(e,n,o){let r=e.getComponent("inventory").container,i=r.getItem(n);return i.nameTag=o,r.setItem(n,i)}constructor(e){this.name=e,this.savedEntitys=void 0,this.MEMORY=void 0}get entitys(){if(this.savedEntitys)return this.savedEntitys;let e=b.overworld.getEntitiesAtBlockLocation(B).filter(n=>n.typeId==ee&&n.getDynamicProperty("name")==this.name);return this.savedEntitys=e,e}data(){if(this.MEMORY)return this.MEMORY;if(this.entitys.length==0&&f.createEntity(this.name,0),this.entitys.length==1){let n=JSON.parse(f.decompress(f.getInventorySlotName(this.entitys[0],0)));return this.MEMORY=n,n}let e=new Array(this.entitys.length);for(let n of this.entitys){let o=n.getDynamicProperty("index");e[o]=f.getInventorySlotName(n,0)}try{e=JSON.parse(e.join(""))}catch{e={}}return this.MEMORY=e,e}save(e){this.MEMORY=e;let n=dt(f.compress(JSON.stringify(e)),lt);if(this.entitys&&n.length==this.entitys.length)for(let o=0;o<n.length;o++)f.setInventorySlotName(this.entitys[o],0,n[o]);else{this.entitys?.forEach(o=>o?.triggerEvent("despawn")),this.savedEntitys=void 0;for(let o=0;o<n.length;o++){let r=f.createEntity(this.name,o);f.setInventorySlotName(r,0,n[o])}}}set(e,n){let o=this.data();o[e]=n,this.save(o)}get(e){return this.data()[e]}has(e){return this.keys().includes(e)}delete(e){let n=this.data(),o=delete n[e];return this.save(n),o}size(){return this.keys().length}clear(){this.save({})}keys(){return Object.keys(this.data())}values(){return Object.values(this.data())}getCollection(){return this.data()}};var s={config:new f("config"),freezes:new f("freezes"),mutes:new f("mutes"),bans:new f("bans"),regions:new f("regions"),roles:new f("roles"),tasks:new f("tasks"),npcs:new f("npcs"),ids:new f("ids"),logs:new f("logs")};function pt(t){return[...Pn.getPlayers()].find(e=>e.name===t)}var $=class{constructor(e="literal"){this.name=e;this.typeName="literal";this.name=e}matches(e){return{success:this.name==e}}fail(e){return`${e} should be ${this.name}!`}},oe=class{constructor(e="string"){this.name=e;this.typeName="string";this.name=e}matches(e){return{success:e&&e!="",value:e}}fail(e){return"Value must be of type string!"}},re=class{constructor(e="integer"){this.name=e;this.typeName="int";this.name=e}matches(e){return{success:!isNaN(e),value:parseInt(e)}}fail(e){return"Value must be valid number!"}},Me=class{constructor(e="float"){this.name=e;this.typeName="float";this.name=e}matches(e){return{success:Boolean(e?.match(/^\d+\.\d+$/)?.[0]),value:parseInt(e)}}fail(e){return"Value must be valid float!"}},j=class{constructor(e="location"){this.name=e;this.typeName="location";this.name=e}matches(e){return{success:/^([~^]{0,1}(-\d)?(\d*)?(\.(\d+))?)$/.test(e),value:e}}fail(e){return"Value needs to be a valid number, value can include: [~,^]"}},ie=class{constructor(e="boolean"){this.name=e;this.typeName="boolean";this.name=e}matches(e){return{success:Boolean(e?.match(/^(true|false)$/)?.[0]),value:e=="true"}}fail(e){return`"${e}" can be either "true" or "false"`}},De=class{constructor(e="player"){this.name=e;this.typeName="playerName";this.name=e}matches(e){return{success:!!pt(e),value:pt(e)}}fail(e){return`player: "${e}", is not in this world`}},$e=class{constructor(e="target"){this.name=e;this.typeName="Target";this.name=e}matches(e){return{success:Boolean(e?.match(/^(@.|"[\s\S]+")$/)?.[0]),value:e}}fail(e){return`${e} is not a valid target`}},se=class{constructor(e="array",n){this.name=e;this.types=n;this.typeName="string";this.name=e,this.types=n,this.typeName=n.join(" | ").replace(/(.{25})..+/,"$1...")}matches(e){return{success:this.types.includes(e),value:e}}fail(e){return`"${e}" must be one of these values: ${this.types.join(" | ")}`}},Oe=class{constructor(e){this.name=e;this.typeName="Duration"}matches(e){return{success:/^(\d+[hdysmw],?)+$/.test(e),value:e}}fail(e){return`"${e}" must be a value like "10d" or "3s" the first part is the length second is unit`}},Fe=class{constructor(e="playerName"){this.name=e;this.typeName="playerName";this.name=e}matches(e){return{success:!!s.ids.get(e),value:e}}fail(e){return`player: "${e}" has never played this world before! Tip: if the name has spaces in it use quotes around name!`}},g={string:oe,int:re,float:Me,location:j,boolean:ie,player:De,target:$e,array:se,duration:Oe,playerName:Fe};var be=class{constructor(e){this.data=e,this.sender=e.sender}reply(e){this.sender.tell(e)}};function ft(t,e){try{return t.slice(e.length).trim().match(/"[^"]+"|[^\s]+/g).map(n=>n.replace(/"(.+)"/,"$1").toString())}catch{return[]}}function gt(t,e){t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.unknown",with:[`${e}`]}]})}function ze(t,e){t.tell({rawtext:[{text:e.data.invaildPermission?e.data.invaildPermission:`\xA7cYou do not have permission to use "${e.data.name}"`}]})}function yt(t,e,n,o,r){if(t.tell({rawtext:[{text:"\xA7c"},{translate:"commands.generic.syntax",with:[`${v}${e.data.name} ${o.slice(0,r).join(" ")}`,o[r]??" ",o.slice(r+1).join(" ")]}]}),n.children.length>1||!o[r]){let i=n.children.map(a=>a.type instanceof $?a.type.name:a.type?.typeName);t.tell(`\xA7c"${o[r]??"undefined"}" is not valid! Argument "${[...new Set(n.children.map(a=>a.type.name))][0]}" can be typeof: "${i.join('", "')}"`)}else t.tell(`\xA7c${n.children[0]?.type?.fail(o[r])}`)}function xn([t,e,n],{location:o,viewVector:r}){if(!t||!e||!t)return null;let i=[o.x,o.y,o.z],a=[r.x,r.y,r.z],m=[t,e,n].map(y=>{let I=parseFloat(y);return isNaN(I)?0:I}),d=[t,e,n].map((y,I)=>y.includes("~")?m[I]+i[I]:y.includes("^")?m[I]+a[I]:m[I]);return new An(d[0],d[1],d[2])}function ht(t,e,n,o){let r=e[e.length-1]??o,i=[];for(let[a,m]of e.entries())if(!m.type.name.endsWith("*")){if(m.type instanceof j){i.push(xn([t[a],t[a+1],t[a+2]],n.sender));continue}m.type instanceof $||i.push(m.type.matches(t[a]).value??t[a])}r.callback(new be(n),...i)}var L=[];Bn.events.beforeChat.subscribe(t=>{if(!t.message.startsWith(v))return;t.cancel=!0;let e=ft(t.message,v),n=L.find(i=>i.depth==0&&(i.data.name==e[0]||i.data?.aliases?.includes(e[0])));if(!n)return gt(t.sender,e[0]);if(!n.data?.requires(t.sender))return ze(t.sender,n);e.shift();let o=[],r=(i,a)=>{if(i.children.length>0){let m=i.children.find(d=>d.type.matches(e[a]).success);return!m&&!e[a]&&i.callback?void 0:m?m.data?.requires(t.sender)?(o.push(m),r(m,a+1)):(ze(t.sender,m),"fail"):(yt(t.sender,n,i,e,a),"fail")}};r(n,0)||ht(e,o,t,n)});import{Player as zn,world as Ye}from"@minecraft/server";var bt="rubedo:gui",ae="rubedo:inventory";import{world as H,Player as Rn,BlockLocation as Bt,MinecraftBlockTypes as _n,GameMode as Ln}from"@minecraft/server";var kt={doorsAndSwitches:!0,openContainers:!0,pvp:!1,allowedEntitys:["minecraft:player","minecraft:npc","minecraft:item","rubedo:inventory","rubedo:database"]},It=["minecraft:acacia_door","minecraft:acacia_trapdoor","minecraft:acacia_button","minecraft:birch_door","minecraft:birch_trapdoor","minecraft:birch_button","minecraft:crimson_door","minecraft:crimson_trapdoor","minecraft:crimson_button","minecraft:dark_oak_door","minecraft:dark_oak_trapdoor","minecraft:dark_oak_button","minecraft:jungle_door","minecraft:jungle_trapdoor","minecraft:jungle_button","minecraft:mangrove_door","minecraft:mangrove_trapdoor","minecraft:mangrove_button","minecraft:spruce_door","minecraft:spruce_trapdoor","minecraft:spruce_button","minecraft:warped_door","minecraft:warped_trapdoor","minecraft:warped_button","minecraft:wooden_door","minecraft:wooden_button","minecraft:trapdoor","minecraft:iron_door","minecraft:iron_trapdoor","minecraft:polished_blackstone_button","minecraft:lever"],Ct=["minecraft:chest","minecraft:ender_chest","minecraft:barrel","minecraft:trapped_chest","minecraft:dispenser","minecraft:dropper","minecraft:furnace","minecraft:blast_furnace","minecraft:lit_furnace","minecraft:lit_blast_furnace","minecraft:hopper","minecraft:shulker_box","minecraft:undyed_shulker_box","minecraft:lit_smoker","minecraft:smoker"];var Ge=[],Nn=!1,wt=-64,vt=320;function Tt(t,e,n){return n.every((o,r)=>o>=Math.min(t[r],e[r])&&o<=Math.max(t[r],e[r]))}var h=class{static getAllRegions(){if(Nn)return Ge;let e=s.regions.values().map(n=>new h(n.from,n.to,n.dimensionId,n.permissions,n.key));return e.forEach(n=>{Ge.push(n)}),e}static blockLocationInRegion(e,n){return this.getAllRegions().find(o=>o.dimensionId==n&&Tt([o.from.x,wt,o.from.z],[o.to.x,vt,o.to.z],[e.x,e.y,e.z]))}static removeRegionAtBlockLocation(e,n){let o=this.blockLocationInRegion(e,n);return o?s.regions.delete(o.key):!1}constructor(e,n,o,r,i){this.from=e,this.to=n,this.dimensionId=o,this.permissions=r??kt,this.key=i||Date.now().toString(),i||(this.update(),ke(),Ge.push(this))}update(){s.regions.set(this.key,{key:this.key,from:this.from,dimensionId:this.dimensionId,permissions:this.permissions,to:this.to})}delete(){return s.regions.delete(this.key)}entityInRegion(e){return this.dimensionId==e.dimension.id&&Tt([this.from.x,wt,this.from.z],[this.to.x,vt,this.to.z],[e.location.x,e.location.y,e.location.z])}changePermission(e,n){this.permissions[e]=n,this.update()}};var M=class{static getTasks(){return s.tasks.get("changePlayerRole")??[]}static getPlayersRoleToSet(e){return M.getTasks().find(o=>o.playerName==e)?.role}constructor(e,n){let o=M.getTasks();o.push({playerName:e,role:n}),s.tasks.set("changePlayerRole",o)}};import{MinecraftBlockTypes as me,MinecraftItemTypes as u}from"@minecraft/server";var St=[u.beehive.id,u.beeNest.id,u.axolotlBucket.id,u.codBucket.id,u.tadpoleBucket.id,u.tropicalFishBucket.id,u.salmonBucket.id,u.pufferfishBucket.id],Et=[u.allow.id,u.barrier.id,u.borderBlock.id,u.debugStick?.id??"minecraft:debug_stick",u.deny.id,u.jigsaw.id,u.lightBlock.id,u.commandBlock.id,u.repeatingCommandBlock.id,u.chainCommandBlock.id,u.commandBlockMinecart.id,u.structureBlock.id,u.structureVoid.id,u.bedrock.id,u.endPortalFrame.id,"minecraft:info_update","minecraft:info_update2","minecraft:reserved3","minecraft:reserved4","minecraft:reserved6","minecraft:movingBlock","minecraft:moving_block","minecraft:movingblock","minecraft:piston_arm_collision","minecraft:piston_arm_collision","minecraft:pistonarmcollision","minecraft:stickyPistonArmCollision","minecraft:sticky_piston_arm_collision","minecraft:unknown","minecraft:glowingobsidian","minecraft:invisible_bedrock","minecraft:invisiblebedrock","minecraft:netherreactor","minecraft:portal","minecraft:fire","minecraft:water","minecraft:lava","minecraft:flowing_lava","minecraft:flowing_water","minecraft:soul_fire"],Pt=[me.dispenser.id],At=[me.bedrock.id,me.barrier.id,"minecraft:invisiblebedrock","minecraft:movingBlock","minecraft:movingblock","minecraft:moving_block"],Ie=[me.chest.id,me.trappedChest.id],Nr=[u.chest.id,u.trappedChest.id,u.barrel.id,u.dispenser.id,u.dropper.id,u.furnace.id,"minecraft:lit_furnace",u.blastFurnace.id,"minecraft:lit_blast_furnace",u.smoker.id,"minecraft:lit_smoker",u.hopper.id,u.shulkerBox.id,u.undyedShulkerBox.id],U={x:7,y:7,z:7};var Ce={aquaAffinity:1,baneOfArthropods:5,binding:1,blastProtection:4,channeling:1,depthStrider:3,efficiency:5,featherFalling:4,fireAspect:2,fireProtection:4,flame:1,fortune:3,frostWalker:2,impaling:5,infinity:1,knockback:2,looting:3,loyalty:4,luckOfTheSea:3,lure:3,mending:1,multishot:1,piercing:4,power:5,projectileProtection:4,protection:4,punch:2,quickCharge:3,respiration:3,riptide:3,sharpness:5,silkTouch:1,smite:5,soulSpeed:3,swiftSneak:4,thorns:3,unbreaking:3,vanishing:1};var xt="2.5.5-beta";var we="https://discord.gg/dMa3A5UYKX";function N(t,e=[],n){if(je(t))return console.warn("[WARNING]: TRIED TO KICK OWNER"),t.tell("You have been tried to kick, but you cant!"),n?.();try{t.runCommand(`kick "${t.name}" \xA7r${e.join(`
`)}`),t.triggerEvent("kick")}catch(o){if(!/"statusCode":-2147352576/.test(o))return;n&&n()}}function c(t){return t instanceof Rn?s.roles.get(t.name)??"member":s.roles.get(t)??"member"}function J(t,e){if(typeof t=="string"){s.roles.set(t,e);let n=[...H.getPlayers()].find(o=>o.name==t);n?n.setDynamicProperty("role",e):new M(t,e)}else s.roles.set(t.name,e),t.setDynamicProperty("role",e)}function je(t){return H.getDynamicProperty("worldsOwner")==t.id}function ve(){return H.getDynamicProperty("isLockDown")??!1}function Ue(t){H.setDynamicProperty("isLockDown",t)}function ke(){for(let t of h.getAllRegions()){let e=new Bt(t.from.x,t.dimensionId=="minecraft:overworld"?-64:0,t.from.z),n=new Bt(t.to.x,t.dimensionId=="minecraft:overworld"?-64:0,t.to.z);for(let o of e.blocksBetween(n))b[t.dimensionId].getBlock(o)?.setType(_n.deny)}}var Nt=[];function R(t,e=0){Nt.push({callback:t,delay:e,lastCall:0})}H.events.tick.subscribe(t=>{let e=[...H.getPlayers()];for(let[n,o]of e.entries())if(!["moderator","admin"].includes(c(o)))for(let r of Nt)r.delay!=0&&t.currentTick-r.lastCall<r.delay||(r.callback(o,t),n==e.length-1&&(r.lastCall=t.currentTick))});function p(t){switch(t){case"spam_config":return s.config.get("spam_config")??{repeatedMessages:!0,zalgo:!0,violationCount:0,permMutePlayer:!1};case"cbe_config":return s.config.get("cbe_config")??{clearItem:!0,violationCount:0,banPlayer:!1,canAddEnchantment:!1};case"gamemode_config":return s.config.get("gamemode_config")??{setToSurvival:!0,clearPlayer:!0,violationCount:0,banPlayer:!1};case"nuker_data":return s.config.get("nuker_data")??{violationCount:0,banPlayer:!1};case"banned_items":return s.config.get("banned_items")??Et;case"banned_blocks":return s.config.get("banned_blocks")??At;case"enchantments":return s.config.get("enchantments")??Ce;case"appealLink":return s.config.get("appealLink")??we}}function Rt(t){return p("enchantments")[t.type.id]??t.type.maxLevel}function _t(t){return Object.values(Ln).find(e=>[...H.getPlayers({name:t.name,gameMode:e})].length)}import{world as Lt}from"@minecraft/server";var Mt=new Map,ce=class{constructor(e,n,o=!1,r=Date.now()){this.callbackTick=null,this.tickDelay=n,this.loop=o,this.callback=e,this.id=r,Mt.set(r,this),this.TickCallBack=Lt.events.tick.subscribe(({currentTick:i})=>{if(this.callbackTick||(this.callbackTick=i+this.tickDelay),!(this.callbackTick>i)){if(this.callback(i),!this.loop)return this.expire();this.callbackTick=i+this.tickDelay}})}expire(){Lt.events.tick.unsubscribe(this.TickCallBack),Mt.delete(this.id)}};var Dt=t=>new Promise(e=>He(e,t));function He(t,e){new ce(t,e)}function A(t,e){return new ce(t,e,!0)}import{world as Gt}from"@minecraft/server";var Ve={},$t={},O={};function Mn(t,e,n){if(e.length!=n.length)return[];let o=[];for(let r=0;r<n.length;r++){if(e[r]?.item?.amount<n[r]?.item?.amount||e[r]?.item?.amount>n[r]?.item?.amount&&e[r]?.item?.amount!=0){let i={slot:r,uid:n[r].uid,oldUid:e[r].uid,item:n[r].item,oldItem:e[r].item,changeType:"fluctuation"};o.push(i),O[t.id]=i;continue}if(n[r].uid!=e[r].uid)if(e[r]?.item&&n[r]?.item){let i={slot:r,uid:n[r].uid,oldUid:e[r].uid,item:n[r].item,oldItem:e[r].item,changeType:"swap"};o.push(i),O[t.id]=i}else if(n[r]?.item){if(n[r]?.item)if(O[t.id]?.changeType=="delete"&&O[t.id]?.uid==n[r].uid){let i={slot:r,uid:n[r].uid,item:n[r].item,changeType:"move"};o.push(i),O[t.id]=i;continue}else{let i={slot:r,uid:n[r].uid,item:n[r].item,changeType:"put"};o.push(i),O[t.id]=i}}else{let i={slot:r,uid:e[r].uid,item:e[r].item,changeType:"delete"};o.push(i),O[t.id]=i}}return o}function Dn(t){if(!t)return"";let e=[];return e.push(t.typeId),e.push(t.nameTag),e.push(t.data),e.push(t.getLore().join("")),e.join("")}function $n(t){let e=[];for(let n=0;n<t.size;n++){let o=t.getItem(n);e[n]={uid:Dn(o),item:o}}return e}A(()=>{for(let t of Object.values(Ve))for(let e of b.overworld.getEntities(t.entities)){let n=$n(e.getComponent("inventory").container),o=Mn(e,$t[e.id]??n,n);if($t[e.id]=n,o.length!=0){if(e.hasTag("skipCheck")){e.removeTag("skipCheck"),delete O[e.id];continue}for(let r of o)t.callback(e,r)}}},5);var le=class{static subscribe(e,n){let o=Date.now();return Ve[o]={callback:n,entities:e},o}static unsubscribe(e){delete Ve[e]}};import{world as On}from"@minecraft/server";var T=class{constructor(){this.data=new Map,this.events={playerLeave:On.events.playerLeave.subscribe(e=>this.data.delete(e.playerName))}}set(e,n){this.data.set(e.name,n)}get(e){return this.data.get(e.name)}delete(e){this.data.delete(e.name)}clear(){this.data.clear()}playerNames(){return[...this.data.keys()]}includes(e){return this.playerNames().includes(e.name)}};var x={},X={},de=new T;function Ot(t){return t.getComponent("minecraft:inventory").container.getItem(t.selectedSlot)}async function Ft(t,e){try{let n=t.getComponent("minecraft:inventory").container,o=[];for(let r=0;r<n.size;r++){let i=n.getItem(r);!i||i?.typeId==e?.typeId&&(o.push({slot:r,item:i}),n.setItem,r<9?t.runCommand(`replaceitem entity @s slot.hotbar ${r} air`):t.runCommand(`replaceitem entity @s slot.inventory ${r-9} air`))}t.runCommand(`clear @s ${e?.typeId} ${e.data} ${e.amount}`);for(let r of o)n.setItem(r.slot,r.item)}catch{[...t.dimension.getEntities({type:"minecraft:item",location:t.location,maxDistance:2,closest:1})].forEach(o=>o.kill())}}function zt(t,e){return t.getComponent("minecraft:inventory").container.getItem(e)}var Te=class{constructor(e,n,o){this.gui=e,this.slot=n,this.change=o}message(e){this.gui.player.tell(e)}getItemAdded(){return this.slot.item?null:this.gui.entity.getComponent("minecraft:inventory").container.getItem(this.change.slot)}GiveAction(e=this.slot.item.itemStack){this.gui.player.getComponent("minecraft:inventory").container.addItem(e)}TakeAction(e=null){this.gui.player.getComponent("minecraft:inventory").container.addItem(this.slot.item.itemStack),this.gui.page.slots[this.change.slot]=null,e&&e.delete(this.slot.item.components.dbKey)}PageAction(e,n){this.gui.setPage(e,n)}CloseAction(){this.gui.despawn()}SetAction(){this.gui.entity.getComponent("minecraft:inventory").container.setItem(this.change.slot,this.slot.item.itemStack)}async FormAction(e){return this.CloseAction(),await Dt(5),await e.show(this.gui.player)}};var Z=class{static spawnEntity(e){try{return e.dimension.spawnEntity(ae,e.headLocation)}catch{return null}}constructor(e){this.player=e,this.entity=Z.spawnEntity(e),this.entity&&(this.hasChestOpen=!1,this.setPage("home")),this.tickEvent=Gt.events.tick.subscribe(()=>{if(!this.entity)return this.despawn();if(de.get(this.player))this.hasChestOpen||(this.slotChangeEvent=le.subscribe({type:ae},(n,o)=>{n.id==this.entity.id&&this.onSlotChange(o)})),this.hasChestOpen=!0;else try{this.entity.teleport(this.player.headLocation,this.player.dimension,this.player.rotation.x,this.player.rotation.y,!0)}catch{this.despawn()}})}setPage(e,n){let o=this.entity.getComponent("inventory").container;for(let i=0;i<o.size;i++)o.setItem(i,C);if(!Object.keys(X).includes(e))throw new Error(`pageId ${e} does not exist!`);let r=X[e];this.page=r,r.fillType(this.entity,r,n),this.entity.nameTag="size:54"}onSlotChange(e){let n=this.page.slots[e.slot];if(!n)this.entity.getComponent("inventory").container.setItem(e.slot,C);else if(e.changeType=="delete"){if(n.item&&Ft(this.player,e.item),!n.item&&!zt(this.entity,e.slot))return;n.action(new Te(this,n,e))}}despawn(){try{this.entity?.triggerEvent("despawn")}catch{}try{delete x[this.player.name]}catch{}this.tickEvent&&Gt.events.tick.unsubscribe(this.tickEvent),this.slotChangeEvent&&le.unsubscribe(this.slotChangeEvent)}};import{ItemStack as Fn}from"@minecraft/server";var k=class{constructor(e,n={},o){this.itemType=e,this.components=n,this.setItemStack=o}get itemStack(){if(this.setItemStack)return this.setItemStack;let e=new Fn(this.itemType);if(this.components){e.amount=this.components?.amount??1,e.data=this.components?.data??0,e.nameTag=this.components?.nameTag,e.setLore(this.components?.loreList??[]);let n=e.getComponent("enchantments").enchantments;for(let o of this.components?.enchantments??[])n.addEnchantment(o);e.getComponent("enchantments").enchantments=n}return e}};function jt(t,e,n){let o=t.getComponent("minecraft:inventory").container;for(let r=0;r<o.size;r++){let i=e.slots[r];if(!i||!i.item){o.setItem(r,C);continue}o.setItem(r,i.item.itemStack)}}var F=class{constructor(e,n=jt){if(Object.keys(X).includes(e))throw new Error(`Page: ${e}, Already exists!`);this.id=e,this.fillType=n,this.slots=[],X[e]=this}setSlots(e,n,o){let r=n?{item:n,action:o}:null;for(let i of e)this.slots[i]=r;return this}};import{MinecraftItemTypes as Ut}from"@minecraft/server";var Ni=new F("home").setSlots([22],new k(Ut.enderChest,{nameTag:"\xA7l\xA7bInventory Viewer"}),t=>{t.PageAction("moderation:see")}).setSlots([54],new k(Ut.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});Ye.events.tick.subscribe(t=>{for(let e of Ye.getPlayers())if(c(e)=="admin"){if(Ot(e)?.typeId!=bt){x[e.name]&&x[e.name].despawn();continue}Object.keys(x).includes(e?.name)||(x[e.name]=new Z(e))}});Ye.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{t.entity instanceof zn&&(t.id=="rubedo:has_container_open"?de.set(t.entity,!0):t.id=="rubedo:dosent_have_container_open"&&de.set(t.entity,!1))});A(()=>{let t=Object.values(x).map(e=>e.entity.id);for(let e of b.overworld.getEntities({type:ae}))t.includes(e.id)||e.triggerEvent("despawn")},100);var S={"api.name":()=>"Smelly API","api.error.unknown":()=>"An unknown error has occurred.","api.database.error.table_name":(t,e)=>`The display name ${t} is too long for an objective, it can be at most ${e} characters long`,"api.utilities.formatter.error.ms":t=>`${t} is not a string or a number`,"api.Providers.form.invalidType":(t,e)=>`Type ${t} is not a valid type to add a ${e}`,"api.Providers.form.invalidFormtype":(t,e)=>{`${t}${JSON.stringify(e)}`},"api.ChestGUI.error.pagenotfound":t=>`Page ${t} not found!`,"modules.protections.cps.clickingToFast":()=>"You are clicking to fast! Please click slower!","modules.managers.mute.isMuted":()=>"You are muted and cannot send messages please try again later","modules.commands.ban.reply":(t,e,n="")=>`\xA7cBanned \xA7f"\xA7a${t}\xA7f" \xA7cfor ${e} Because: "${n??"No reason Provided"}" \xA7aSuccessfully`,"lockdown.kick.message":()=>["\xA7cYou have been kicked!","\xA7aReason: \xA7fServer is currently under LockDown","\xA7fServer will be up soon, Try to join later"],"commands.ban.list.player":(t,e,n)=>`- "${t}" Because: ${e}, Expiry ${n}`,"commands.freeze.list.player":(t,e)=>`- "${t}" Because: ${e}`,"commands.mutes.list.player":(t,e,n)=>`- "${t}" Because: ${e}, Expiry: ${n}`,"commands.lockdown.confirm":"Are you sure you want to lockdown the server, this will kick all active players and all players who try to join who are not admin"};var l=class{constructor(e,n,o=0,r){this.data=e;this.type=n;this.depth=o;this.parent=r;e.requires||(e.requires=i=>!0),this.data=e,this.type=n??new $(this.data.name),this.children=[],this.depth=o,this.parent=r,this.callback=null,L.push(this)}argument(e){let n=new l(this.data,e,this.depth+1,this);return this.children.push(n),n}string(e){return this.argument(new oe(e))}int(e){return this.argument(new re(e))}array(e,n){return this.argument(new se(e,n))}boolean(e){return this.argument(new ie(e))}location(e){let n=this.argument(new j(e));return e.endsWith("*")?n:n.location(e+"_y*").location(e+"_z*")}literal(e){let n=new l(e,new $(e.name),this.depth+1,this);return this.children.push(n),n}executes(e){return this.callback=e,this}};import{Player as Ht}from"@minecraft/server";var E=class{constructor(e,n,o="No Reason",r="Rubedo Auto Mod"){let i=e instanceof Ht?e.id:s.ids.get(e);if(!i)throw new Error(`"${e}" does not have a saved id!`);let a={key:i,playerName:e instanceof Ht?e.name:e,date:Date.now(),duration:n?ne(n):null,expire:n?ne(n)+Date.now():null,reason:o,by:r};s.bans.set(i,a)}};function Ke(t,e,n,o,r){if(s.bans.get(s.ids.get(e)))return t.reply(`\xA7c${e} is already banned`);t.reply("\xA7aClose chat to confirm"),he(t.sender,`Are you sure you want to ban ${e}, for ${n??"forever"}`,()=>{new E(e,n,o,t.sender.name),t.reply(S["modules.commands.ban.reply"](e,n,o))})}var qe=new l({name:"ban",description:"Manage bans",requires:t=>["admin","moderator"].includes(c(t))});qe.literal({name:"add",description:"Bans a player"}).argument(new g.playerName).executes((t,e)=>{Ke(t,e,null,null,t.sender.name)}).argument(new g.duration("duration")).executes((t,e,n)=>{Ke(t,e,n,null,t.sender.name)}).string("reason").executes((t,e,n,o)=>{Ke(t,e,n,o,t.sender.name)});qe.literal({name:"remove",description:"unbans a player"}).argument(new g.playerName("playerName")).executes((t,e)=>{let n=s.bans.values().find(o=>o.playerName==e);if(!n)return t.reply(`${e} is not banned`);s.bans.delete(n.key)?t.reply(`\xA7a${e}\xA7r has been Unbanned!`):t.reply(`\xA7cFailed to unban ${e}`)});qe.literal({name:"list",description:"Lists all bans"}).executes(t=>{let e=s.bans.values();if(e.length==0)return t.sender.tell("\xA7cNo one is banned!");t.sender.tell(`\xA72--- Showing Bans (${e.length}) ---`);for(let n of e)t.sender.tell(S["commands.ban.list.player"](n.playerName,n.reason,n.expire?W(n.duration):"Forever"))});var ue=new l({name:"database",description:"Interacts with SA Database",aliases:["db"],requires:t=>c(t)=="admin"});ue.literal({name:"get"}).string("table").string("key").executes((t,e,n)=>{try{let o=s[e].get(n);o?t.reply(JSON.stringify(o)):t.reply(`No data could be found for key ${n}`)}catch(o){t.reply(o+o.stack)}});ue.literal({name:"set"}).string("table").string("key").string("value").executes((t,e,n,o)=>{try{s[e].set(n,o),t.reply(`Set Key: "${n}", to value: "${o}" on table: "${e}"`)}catch(r){t.reply(r+r.stack)}});ue.literal({name:"clear"}).string("table").executes((t,e)=>{try{s[e].clear(),t.reply(`Cleared Table ${e}`)}catch(n){t.reply(n+n.stack)}});ue.literal({name:"keys",description:"Returns all keys on a database"}).string("table").executes((t,e)=>{try{let n=s[e].keys();t.reply(`Keys on database: ${e}: ${n}`)}catch(n){t.reply(n+n.stack)}});ue.literal({name:"values",description:"Returns all values on a database"}).string("table").executes((t,e)=>{try{let n=s[e].values();t.reply(`Values on database: ${e}: ${JSON.stringify(n,null,2)}`)}catch(n){n instanceof TypeError?t.reply(`No values on database ${e}`):t.reply(n+n.stack)}});new l({name:"ecwipe",description:"Clears a players ender chest",requires:t=>c(t)=="admin"}).argument(new g.player("player")).executes((t,e)=>{for(let n=0;n<27;n++)e.runCommand(`replaceitem entity @s slot.enderchest ${n} air`);t.reply(`Cleared ${e.name} Ender chest!`)});var Se=class{constructor(e,n="No Reason"){let o={playerName:e.name,key:e.id,reason:n,location:{x:e.location.x,y:e.location.y,z:e.location.z,dimension:e.dimension.id}};s.freezes.set(e.id,o)}};var We=new l({name:"freeze",description:"Manage Freezes",requires:t=>["admin","moderator"].includes(c(t))});We.literal({name:"add",description:"Freezes a player"}).argument(new g.player("player")).string("reason").executes((t,e,n)=>{new Se(e,n),t.reply(`\xA7cFroze \xA7f"\xA7a${e.name}\xA7f" Because: "${n}" \xA7aSuccessfully`),t.sender.tell(`\xA7cYou have been frozen by \xA7f"\xA7a${t.sender.name}\xA7f" Because: "${n}"`)});We.literal({name:"remove",description:"unfreezes a player"}).argument(new g.playerName("playerName")).executes((t,e)=>{let n=s.freezes.values().find(o=>o.playerName==e);if(!n)return t.reply(`${e} is not frozen`);s.freezes.delete(n.key),t.reply(`\xA7a${e}\xA7r has been UnFrozen!`)});We.literal({name:"list",description:"Lists all freezes"}).executes(t=>{let e=s.freezes.values();if(e.length==0)return t.sender.tell("\xA7cNo one is frozen!");t.sender.tell(`\xA72--- Showing Freezes (${e.length}) ---`);for(let n of e)t.sender.tell(S["commands.freeze.list.player"](n.playerName,n.reason))});var Je=class{constructor(e){this.name=e;this.typeName="CommandName"}matches(e){return{success:Boolean(L.find(n=>n.depth==0&&n.data.name==e)),value:e}}fail(e){return`"${e}" is not a valid command`}};function Gn(t,e,n){n.tell(`${v}${t.data.name} ${e.map(o=>o.type.typeName=="literal"?o.data.name:`<${o.type.name}: ${o.type.typeName}>`).join(" ")}`)}function Ee(t,e,n,o){if(!!e.data?.requires(o)&&(e.callback&&Gn(t,e.depth==0?n:n.concat(e),o),e.children.length>0))for(let r of e.children)Ee(t,r,e.depth==0?n:n.concat(e),o)}function Vt(t,e,n){t.tell(`\xA72--- Showing help page ${e} of ${n} (${v}help <page: int>) ---`)}function Yt(t){let e=L.filter(n=>n.depth==0&&n.data?.requires(t));return e.length==0?0:Math.ceil(e.length/5)}var Kt=new l({name:"help",description:"Provides help/list of commands.",aliases:["?","h"]}).executes(t=>{let e=Yt(t.sender),n=L.filter(o=>o.depth==0&&o.data?.requires(t.sender)).slice(1*5-5,1*5);Vt(t.sender,1,e);for(let o of n)Ee(o,o,[],t.sender)});Kt.int("page").executes((t,e)=>{let n=Yt(t.sender);e>n&&(e=n);let o=L.filter(r=>r.depth==0&&r.data?.requires(t.sender)).slice(e*5-5,e*5);Vt(t.sender,e,n);for(let r of o)Ee(r,r,[],t.sender)});Kt.argument(new Je("command")).executes((t,e)=>{let n=L.filter(o=>o.depth==0&&o.data.name==e)[0];t.sender.tell(`\xA7e${n.data.name}: ${n.data.aliases?`aliases (${n.data.aliases.join(", ")})`:""}`),t.sender.tell(`\xA7e${n.data.description}`),t.sender.tell("Usage:"),Ee(n,n,[],t.sender)});import{world as qt}from"@minecraft/server";new l({name:"lockdown",description:"Toggles the servers lockdown, meaning no one can join",requires:t=>c(t)=="admin"}).executes(t=>{ve()?(Ue(!1),t.sender.tell("Unlocked the server!")):(t.reply("\xA7aClose chat to confirm lockdown"),he(t.sender,S["commands.lockdown.confirm"],()=>{Ue(!0);for(let e of qt.getPlayers())c(e)!="admin"&&N(e,S["lockdown.kick.message"]());qt.say("\xA7l\xA7cServer is now LOCKED!")}))});var _=class{static getMuteData(e){return s.mutes.get(e.name)}constructor(e,n,o="No Reason",r="Rubedo Auto Mod"){let i=n?ne(n):null,a={playerName:e.name,date:Date.now(),duration:i,expire:i?i+Date.now():null,reason:o,by:r};s.mutes.set(e.name,a)}};var Xe=new l({name:"mute",description:"Manage Mutes",requires:t=>["admin","moderator"].includes(c(t))});Xe.literal({name:"add",description:"Mutes a player"}).argument(new g.player("player")).argument(new g.duration("duration")).string("reason").executes((t,e,n,o)=>{new _(e,n,o,t.sender.name),t.reply(`\xA7cMuted \xA7f"\xA7a${e.name}\xA7f" \xA7cfor ${n} Because: "${o}" \xA7aSuccessfully`),e.tell(`\xA7cYou have been muted by \xA7f"${t.sender.name}" \xA7cfor ${n} Because: "${o}"`)});Xe.literal({name:"remove",description:"unmutes a player"}).argument(new g.playerName("playerName")).executes((t,e)=>{let n=s.mutes.values().find(o=>o.playerName==e);if(!n)return t.reply(`${e} is not muted!`);s.mutes.delete(n.playerName);try{t.sender.runCommand(`ability "${e}" mute false`)}catch{}t.reply(`\xA7a${e}\xA7r has been UnMuted!`)});Xe.literal({name:"list",description:"Lists all feeezes"}).executes(t=>{let e=s.mutes.values();if(e.length==0)return t.sender.tell("\xA7cNo one is muted!");t.sender.tell(`\xA72--- Showing Mutes (${e.length}) ---`);for(let n of e)t.sender.tell(S["commands.mutes.list.player"](n.playerName,n.reason,n.expire?W(n.expire):"Forever"))});var Q=class{static isVaild(e){return e.typeId!="minecraft:npc"?!1:Pe.find(n=>n.equals(e.location))?!0:!!s.npcs.keys().find(n=>e.id==n)}constructor(e,n){Pe.push(e);let o=n.spawnEntity("minecraft:npc",e),r={dimension:o.dimension.id,x:o.location.x,y:o.location.y,z:o.location.z};s.npcs.set(o.id,r),Wt()}};new l({name:"npc",description:"Spawns a npc at your coordinates",requires:t=>c(t)=="admin"}).executes(t=>{new Q(t.sender.location,t.sender.dimension),t.reply("Spawned a verifed npc at your current location")});import{world as Jt}from"@minecraft/server";new l({name:"ping",description:"Returns the current TPS of the servers ping"}).executes(t=>{let e=Jt.events.tick.subscribe(({deltaTime:n})=>{t.reply(`Pong! Current TPS: ${1/n}`),Jt.events.tick.unsubscribe(e)})});import{BlockLocation as pe}from"@minecraft/server";var fe=new l({name:"region",description:"Create a Region",requires:t=>c(t)=="admin"});fe.literal({name:"add",description:"Adds a new protection region"}).int("from_x").int("from_z").int("to_x").int("to_z").executes((t,e,n,o,r)=>{new h({x:e,z:n},{x:o,z:r},t.sender.dimension.id),t.reply(`Created Region From ${e} -64 ${n} ${o} 320 ${r}`)});fe.literal({name:"remove",description:"Removes a region at the players current postion"}).executes(t=>{let e=new pe(t.sender.location.x,t.sender.location.y,t.sender.location.z);h.removeRegionAtBlockLocation(e,t.sender.dimension.id)?t.reply(`Removed Region at ${e.x} ${e.y} ${e.z}`):t.reply(`Failed to find/remove region at ${e.x} ${e.y} ${e.z}`)});fe.literal({name:"removeAll",description:"Removes all regions"}).executes(t=>{h.getAllRegions().forEach(e=>e.delete()),t.reply("Removed All regions")});fe.literal({name:"list",description:"Lists all regions and positions"}).executes(t=>{let e=h.getAllRegions();for(let n of e)t.reply(`Region from ${n.from.x}, ${n.from.z} to ${n.to.x}, ${n.to.z} in dimension ${n.dimensionId}`);if(e.length==0)return t.reply("No regions have been made yet")});var Ze=fe.literal({name:"permission",description:"Handels permissions for regions"});Ze.literal({name:"set",description:"Sets a certin permission on the region the player is currently in to a value"}).array("key",["doorsAndSwitches","openContainers","pvp"]).boolean("value").executes((t,e,n)=>{let o=h.blockLocationInRegion(new pe(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!o)return t.reply("You are not in a region");o.changePermission(e,n),t.reply(`Changed permision ${e} to ${n}`)});Ze.literal({name:"list",description:"Lists the permissions for the current region"}).executes(t=>{let e=h.blockLocationInRegion(new pe(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!e)return t.reply("You are not in a region");t.reply(`Current region permissions ${JSON.stringify(e.permissions)}`)});var Xt=Ze.literal({name:"entities",description:"Holds the subCommands for adding or removing allowedEntitys"});Xt.literal({name:"add",description:"Adds a entity to the allowed entitys list"}).string("entity").executes((t,e)=>{let n=h.blockLocationInRegion(new pe(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let o=n.permissions.allowedEntitys;o.push(e),n.changePermission("allowedEntitys",o),t.reply(`Added entity ${e} to the allowed entitys of the region your currently standing in`)});Xt.literal({name:"remove",description:"Removes a entity from the allowed entitys in the region"}).string("entity").executes((t,e)=>{let n=h.blockLocationInRegion(new pe(t.sender.location.x,t.sender.location.y,t.sender.location.z),t.sender.dimension.id);if(!n)return t.reply("You are not in a region");let o=n.permissions.allowedEntitys;if(!o.includes(e))return t.reply(`The entity ${e} is not allowed to enter the region`);o=o.filter(r=>r!=e),n.changePermission("allowedEntitys",o),t.reply(`Removed entity ${e} to the allowed entitys of the region your currently standing in`)});var Qe=(r=>(r[r.member=0]="member",r[r.admin=1]="admin",r[r.moderator=2]="moderator",r[r.builder=3]="builder",r))(Qe||{});var jn=t=>isNaN(Number(t))===!1;function Un(t){return Object.keys(t).filter(jn).map(e=>t[e])}var Zt=new l({name:"role",description:"Changes the role for a player",requires:t=>c(t)=="admin"||je(t)});Zt.literal({name:"set",description:"Sets the role for a player"}).argument(new g.playerName("playerName")).argument(new g.array("role",Un(Qe))).executes((t,e,n)=>{J(e,n),t.reply(`Changed role of ${e} to ${n}`)});Zt.literal({name:"get",description:"Gets the role of a player"}).argument(new g.playerName("playerName")).executes((t,e)=>{t.reply(`${e} has role: ${c(e)}`)});import{ActionFormData as Hn}from"@minecraft/server-ui";var z=class{constructor(e,n){this.title=e,this.body=n,this.form=new Hn,e&&this.form.title(e),n&&this.form.body(n),this.buttons=[],this.triedToShow=0}addButton(e,n=null,o){return this.buttons.push({text:e,iconPath:n,callback:o}),this.form.button(e,n),this}show(e){this.form.show(e).then(n=>{if(n.canceled){if(n.cancelationReason=="userBusy"){if(this.triedToShow>200)return e.tell("\xA7cForm Timeout: tried to show form, but you were busy (close chat after running command)");this.triedToShow++,this.show(e)}return}this.buttons[n.selection].callback?.()})}};import{MinecraftBlockTypes as Yn}from"@minecraft/server";import{ModalFormData as Vn}from"@minecraft/server-ui";var Ae=class{constructor(e,n,o){this.form=e,this.player=n,this.callback=o}error(e){new Y("Error",e).setButton1("Return to form",()=>{this.form.show(this.player,this.callback)}).setButton2("Cancel",null).show(this.player)}};var P=class{constructor(e){this.title=e,this.form=new Vn,e&&this.form.title(e),this.args=[],this.triedToShow=0}addDropdown(e,n,o){return this.args.push({type:"dropdown",options:n}),this.form.dropdown(e,n,o),this}addSlider(e,n,o,r,i){return this.args.push({type:"slider"}),this.form.slider(e,n,o,r,i),this}addToggle(e,n){return this.args.push({type:"toggle"}),this.form.toggle(e,n),this}addTextField(e,n,o){return this.args.push({type:"textField"}),this.form.textField(e,n,o),this}show(e,n){this.form.show(e).then(o=>{if(o.canceled){if(o.cancelationReason=="userBusy"){if(this.triedToShow>200)return e.tell("\xA7cForm Timeout: tried to show form, but you were busy (close chat after running command)");this.triedToShow++,this.show(e,n)}return}n(new Ae(this,e,n),...o.formValues.map((r,i)=>this.args[i].type=="dropdown"?this.args[i].options[r]:r))})}};function Qt(t){new z("Remove a Banned Item").addButton("Remove a Banned Item",null,()=>{Kn(t)}).addButton("Ban an item",null,()=>{qn(t)}).show(t)}function Kn(t){new P("Remove Banned Items").addDropdown("Select item to remove",p("banned_items")).show(t,(e,n)=>{let o=p("banned_items");o=o.filter(r=>r!=n),s.config.set("banned_items",o),t.tell(`Removed Banned item "${n}"`)})}function qn(t){new P("Add Banned Items").addTextField("Item Id","minecraft:string").show(t,(e,n)=>{let o=p("banned_items");if(o.includes(n))return e.error(`\xA7cItem "${n}" is already banned`);o.push(n),s.config.set("banned_items",o),t.tell(`Banned the item "${n}"`)})}function en(t){new P("Manage Banned Blocks").addDropdown("Add/Remove Block",["add","remove"],0).addTextField("Block Id","minecraft:barrier").show(t,(e,n,o)=>{if(!Yn.get(o)?.id)return e.error(`\xA7c"${o}" is not a valid block id, note: this item must be either a block in a behavior pack or a default minecraft block`);if(n=="add"){let r=p("banned_blocks");if(r.includes(o))return e.error(`\xA7cBlock "${o}" is already banned`);r.push(o),s.config.set("banned_blocks",o),t.tell(`Banned the block "${o}"`)}else{let r=p("banned_blocks");if(!r.includes(o))return e.error(`block: "${o}" is not banned`);r=r.filter(i=>i!=o),s.config.set("banned_blocks",o),t.tell(`Removed Banned block "${o}"`)}})}function tn(t){new P("Manage Enchantment Levels").addDropdown("Enchantment to change",Object.keys(Ce),0).addTextField("Level (number)","5").show(t,(e,n,o)=>{if(isNaN(o))return e.error(`\xA7c"${o}" is not a number, please enter a value like, "3", "9", etc.`);let r=parseInt(o),i=p("enchantments");i[n]=r,s.config.set("enchantments",i),t.tell(`Set max level for ${n} to ${r}`)})}function nn(t){new P("Manage Appeal Link").addTextField("Appeal Link",we).show(t,(e,n)=>{s.config.set("appealLink",n),t.tell(`Changed the servers appeal link to ${n}`)})}function on(t){new z("Rubedo Settings").addButton("Anti Spam","textures/ui/permissions_op_crown.png",()=>{Jn(t)}).addButton("Cbe","textures/blocks/sculk_shrieker_top.png",()=>{Xn(t)}).addButton("Gamemode","textures/blocks/barrier.png",()=>{Zn(t)}).addButton("Nuker","textures/ui/Feedback.png",()=>{Qn(t)}).show(t)}function Jn(t){let e=p("spam_config");new P("Manage Spam Protection").addToggle("Ban Repeated Messages",e.repeatedMessages).addToggle("Ban Zalgo",e.zalgo).addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Perm Mute Player",e.permMutePlayer).show(t,(n,o,r,i,a)=>{s.config.set("spam_config",{repeatedMessages:o,zalgo:r,violationCount:i,permMutePlayer:a}),t.tell("Updated Spam Protection settings!")})}function Xn(t){let e=p("cbe_config");new P("Manage CBE Protection").addToggle("Clear Item",e.clearItem).addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Ban Player",e.banPlayer).addToggle("Allow non-enchantable items to be enchanted",e.banPlayer).show(t,(n,o,r,i,a)=>{s.config.set("cbe_config",{clearItem:o,violationCount:r,banPlayer:i,canAddEnchantment:a}),t.tell("Updated CBE Protection settings!")})}function Zn(t){let e=p("gamemode_config");new P("Manage Gamemode Protection").addToggle("Set to survival",e.setToSurvival).addToggle("Clear Player (Once this players gamemode has been switched back to survival should it clear the inventory?)",e.clearPlayer).addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Ban Player",e.banPlayer).show(t,(n,o,r,i,a)=>{s.config.set("gamemode_config",{setToSurvival:o,clearPlayer:r,violationCount:i,banPlayer:a}),t.tell("Updated Gamemode Protection settings!")})}function Qn(t){let e=p("nuker_data");new P("Manage Gamemode Protection").addSlider("Violation Count before ban (if ban is false this does nothing)",0,20,1,e.violationCount).addToggle("Ban Player",e.banPlayer).show(t,(n,o,r)=>{s.config.set("nuker_data",{violationCount:o,banPlayer:r}),t.tell("Updated Nuker Protection settings!")})}function rn(t){new z("Rubedo Settings").addButton("Auto Mod","textures/ui/permissions_op_crown.png",()=>{on(t)}).addButton("Banned items","textures/blocks/sculk_shrieker_top.png",()=>{Qt(t)}).addButton("Banned blocks","textures/blocks/barrier.png",()=>{en(t)}).addButton("Enchantments","textures/items/book_enchanted.png",()=>{tn(t)}).addButton("Appeal Link","textures/ui/Feedback.png",()=>{nn(t)}).show(t)}new l({name:"settings",description:"Opens up the settings menu for the player",requires:t=>["admin","moderator"].includes(c(t))}).executes(t=>{rn(t.sender),t.sender.tell("\xA7aForm request sent, close chat to continue!")});import{world as sn}from"@minecraft/server";function an(t,e){if(t.hasTag("spectator")){if(t.runCommand("gamemode c"),t.runCommand("event entity @s removeSpectator"),t.removeTag("spectator"),!e)return;sn.say({rawtext:[{translate:"multiplayer.player.joined",with:[`\xA7e${t.name}`]}]})}else{if(t.runCommand("gamemode spectator"),t.runCommand("event entity @s addSpectator"),t.addTag("spectator"),!e)return;sn.say({rawtext:[{translate:"multiplayer.player.left",with:[`\xA7e${t.name}`]}]})}}new l({name:"vanish",description:"Toggles Vanish Mode on the sender",requires:t=>c(t)=="admin"}).executes(t=>{an(t.sender,!1)}).boolean("say").executes((t,e)=>{an(t.sender,e)});new l({name:"version",description:"Get Current Version",aliases:["v"]}).executes(t=>{t.reply(`Current Rubedo Version: ${xt}`)});new l({name:"kick",description:"Kicks a player from the game",requires:t=>c(t)=="admin"}).argument(new g.player).string("reason").executes((t,e,n)=>{N(e,[n]),t.reply(`\xA7aKicked ${e.name} from world`)});var V=class{constructor(e){this.data=e,console.warn(`[LOG]: ${e.message}`),s.logs.set(Date.now().toString(),e)}};function et(t){var e=6e4,n=e*60,o=n*24,r=o*30,i=o*365,a=Date.now()-t;return a<e?Math.round(a/1e3)+" seconds ago":a<n?Math.round(a/e)+" minutes ago":a<o?Math.round(a/n)+" hours ago":a<r?"approximately "+Math.round(a/o)+" days ago":a<i?"approximately "+Math.round(a/r)+" months ago":"approximately "+Math.round(a/i)+" years ago"}var ge=new l({name:"log",description:"Manages the log command",requires:t=>c(t)=="admin"});ge.literal({name:"add",description:"Adds a new log"}).string("message").executes((t,e)=>{new V({message:e}),t.reply(`\xA7aAdded new log: ${e}`)});ge.literal({name:"getAll",description:"Gets all logs sorted in decending"}).int("page").array("order",["ascending","descending"]).executes((t,e,n)=>{let o=Object.entries(s.logs.getCollection()).sort((i,a)=>n=="ascending"?parseInt(a[0])-parseInt(i[0]):parseInt(i[0])-parseInt(a[0]));if(o.length==0)return t.reply("\xA7cNo Logs have been made!");let r=Math.ceil(o.length/8);e>r&&(e=r),t.reply(`\xA72--- Showing logs page ${e} of ${r} (${v}log getAll <page: int>) ---`);for(let[i,a]of o.slice(e*8-8,e*8))t.reply(`${et(parseInt(i))}: ${a.message}`)});ge.literal({name:"getPlayersLogs",description:"Gets all logs associated with a player"}).argument(new g.playerName).int("page").array("order",["ascending","descending"]).executes((t,e,n,o)=>{let r=Object.entries(s.logs.getCollection()).filter(a=>a[1].playerName==e).sort((a,m)=>o=="ascending"?parseInt(m[0])-parseInt(a[0]):parseInt(a[0])-parseInt(m[0]));if(r.length==0)return t.reply(`\xA7cNo Logs exists for "${e}"!`);let i=Math.ceil(r.length/8);n>i&&(n=i),t.reply(`\xA72--- Showing logs for "${e}" page ${n} of ${i} ---`);for(let[a,m]of r.slice(n*8-8,n*8))t.reply(`${et(parseInt(a))}: ${m.message}`)});ge.literal({name:"getProtectionLogs",description:"Gets all logs associated with a protection"}).string("protection").int("page").array("order",["ascending","descending"]).executes((t,e,n,o)=>{let r=Object.entries(s.logs.getCollection()).filter(a=>a[1].protection==e).sort((a,m)=>o=="ascending"?parseInt(m[0])-parseInt(a[0]):parseInt(a[0])-parseInt(m[0]));if(r.length==0)return t.reply(`\xA7cNo Logs exists for protection: "${e}"!`);let i=Math.ceil(r.length/8);n>i&&(n=i),t.reply(`\xA72--- Showing logs for Protection: "${e}" page ${n} of ${i} ---`);for(let[a,m]of r.slice(n*8-8,n*8))t.reply(`${et(parseInt(a))}: ${m.message}`)});ge.literal({name:"clearAll",description:"Clears all logs"}).executes(t=>{s.logs.clear(),t.reply("\xA7aCleared All logs!")});R(t=>{try{let e=s.bans.get(t.id);if(!e)return;if(e.expire&&e.expire<Date.now())return s.bans.delete(t.id);N(t,["\xA7cYou have been banned!",`\xA7aReason: \xA7f${e.reason}`,`\xA7fExpiry: \xA7b${e.expire?W(e.expire-Date.now()):"Forever"}`,`\xA7fAppeal at: \xA7b${p("appealLink")}`],()=>{console.warn(new Error("Failed to kick player")),s.bans.delete(t.id)})}catch(e){console.warn(e+e.stack)}},20);import{Location as to}from"@minecraft/server";R(t=>{let e=s.freezes.get(t.id);!e||t.teleport(new to(e.location.x,e.location.y,e.location.z),b[e.location.dimension],0,0)},20);import{world as no}from"@minecraft/server";var tt={};no.events.beforeChat.subscribe(t=>{if(!t.message.startsWith(v))for(let e of Object.values(tt))e.callback(t)});var xe=class{static subscribe(e){let n=Date.now();return tt[n]={callback:e},n}static unsubscribe(e){delete tt[e]}};xe.subscribe(t=>{let e=_.getMuteData(t.sender);if(!!e){if(e.expire&&e.expire<Date.now())return s.mutes.delete(t.sender.name);t.cancel=!0,t.sender.tell(S["modules.managers.mute.isMuted"]())}});import{BlockLocation as oo,world as nt}from"@minecraft/server";A(()=>{ke()},6e3);nt.events.beforeItemUseOn.subscribe(t=>{if(["moderator","admin"].includes(c(t.source)))return;let e=h.blockLocationInRegion(t.blockLocation,t.source.dimension.id);if(!e)return;let n=t.source.dimension.getBlock(t.blockLocation);It.includes(n.typeId)&&e.permissions.doorsAndSwitches||Ct.includes(n.typeId)&&e.permissions.openContainers||(t.cancel=!0)});nt.events.beforeExplosion.subscribe(t=>{for(let e=0;e<t.impactedBlocks.length;e++){let n=t.impactedBlocks[e];if(h.blockLocationInRegion(n,t.dimension.id))return t.cancel=!0}});nt.events.entityCreate.subscribe(t=>{let e=h.blockLocationInRegion(new oo(t.entity.location.x,t.entity.location.y,t.entity.location.z),t.entity.dimension.id);!e||e.permissions.allowedEntitys.includes(t.entity.typeId)||(t.entity.teleport({x:0,y:-64,z:0},t.entity.dimension,0,0),t.entity.kill())});A(()=>{for(let t of h.getAllRegions())for(let e of b[t.dimensionId].getEntities({excludeTypes:t.permissions.allowedEntitys}))!t.entityInRegion(e)||(e.teleport({x:0,y:-64,z:0},e.dimension,0,0),e.kill())},100);R(t=>{for(let e of h.getAllRegions())e.entityInRegion(t)?(t.addTag("inRegion"),e.permissions.pvp||t.addTag("region-protected")):(t.removeTag("inRegion"),t.removeTag("region-protected"))},5);import{world as ot}from"@minecraft/server";ot.events.playerJoin.subscribe(({player:t})=>{if(ve()&&c(t)!="admin")return N(t,S["lockdown.kick.message"]());let e=ot.events.tick.subscribe(n=>{try{b.overworld.runCommand(`testfor @a[name="${t.name}"]`),ot.events.tick.unsubscribe(e),_.getMuteData(t)&&t.runCommand("ability @s mute true"),s.ids.has(t.name)?t.addTag("old"):s.ids.set(t.name,t.id);let o=M.getPlayersRoleToSet(t.name);o&&J(t,o)}catch{}})});import{Items as ro,MinecraftItemTypes as D,world as rt}from"@minecraft/server";var mn=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],io=[10,11,12,13,14,15,16,19,20,21,22,23,24,25,28,29,30,31,32,33,34,37,38,39,40,41,42,43];function so(t,e,n){let o=t.getComponent("minecraft:inventory").container;for(let r=0;r<o.size;r++){let i=e.slots[r];if(!i||!i.item){o.setItem(r,C);continue}o.setItem(r,i.item.itemStack)}for(let[r,i]of[...rt.getPlayers()].entries()){let a=mn[r],m=new k(D.skull,{nameTag:i.name,data:3});o.setItem(a,m.itemStack),e.slots[a]={item:m,action:d=>{d.PageAction("moderation:see_inventory",{name:i.name})}}}}function ao(t,e,n){let o=t.getComponent("minecraft:inventory").container;for(let d=0;d<o.size;d++){let y=e.slots[d];if(!y||!y.item){o.setItem(d,C);continue}o.setItem(d,y.item.itemStack)}let r=new k(D.enderChest,{nameTag:`\xA7eView \xA7f${n?.name}\xA7e Ender Chest
\xA7fNote: \xA7cThis will not grab \xA7lANY NBT!\xA7r`});o.setItem(49,r.itemStack),e.slots[49]={item:r,action:d=>{d.PageAction("moderation:see_ender_chest",{name:n.name})}};let i=[...rt.getPlayers()].find(d=>d.name==n.name);i||(Object.values(x).find(y=>y.entity.id==t.id).despawn(),i.tell(`"${n.name}" Could not be found, Gui Crashed`));let a=i.getComponent("inventory").container,m=0;for(let d=0;d<a.size;d++){let y=a.getItem(d),I=mn[m];if(m++,!y){o.setItem(I,C);continue}o.setItem(I,y),e.slots[I]={item:new k(ro.get(y.typeId),{amount:y.amount,data:y.data},y),action:In=>{d<9?i.runCommand(`replaceitem entity @s slot.hotbar ${d} air`):i.runCommand(`replaceitem entity @s slot.inventory ${d-9} air`),In.GiveAction(),e.slots[I]={item:null,action:Cn=>{a.addItem(Cn.getItemAdded())}}}}}}function mo(t,e,n){let o=t.getComponent("minecraft:inventory").container;for(let m=0;m<o.size;m++){let d=e.slots[m];if(!d||!d.item){o.setItem(m,C);continue}o.setItem(m,d.item.itemStack)}let r=[...rt.getPlayers()].find(m=>m.name==n?.name);r||(Object.values(x).find(d=>d.entity.id==t.id).despawn(),r.tell(`"${n.name}" Could not be found, Gui Crashed`));let i=0,a=Object.values(D);for(let m of a)try{r.runCommand(`testfor @s[hasitem={item=${m.id},location=slot.enderchest}]`),console.warn(`found ${m.id}`);let d=new k(m,{nameTag:"Note: \xA7l\xA7cThis is not the exzact item"}),y=io[i];o.setItem(y,d.itemStack),e.slots[y]={item:d,action:I=>{I.GiveAction(),e.slots[y]=null}},i++}catch{}}new F("moderation:see",so).setSlots([50],new k(D.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("home")}).setSlots([48],new k(D.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});new F("moderation:see_inventory",ao).setSlots([50],new k(D.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setSlots([48],new k(D.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});new F("moderation:see_ender_chest",mo).setSlots([50],new k(D.arrow,{nameTag:"\xA7fBack"}),t=>{t.PageAction("moderation:see")}).setSlots([48],new k(D.barrier,{nameTag:"\xA7cClose GUI"}),t=>{t.CloseAction()});import{world as it,Player as cn,MinecraftBlockTypes as co}from"@minecraft/server";var lo=["minecraft:command_block_minecart"];it.events.entityCreate.subscribe(({entity:t})=>{if(t.typeId!="minecraft:npc")return;let e=()=>{try{t.triggerEvent("despawn"),t.kill()}catch{t.kill()}};if(lo.includes(t.typeId)||t.typeId=="minecraft:npc"&&!Q.isVaild(t))return e()});it.events.beforeItemUseOn.subscribe(t=>{if(!(t.source instanceof cn)||["moderator","admin"].includes(c(t.source)))return;if(Pt.includes(t.item.typeId)){t.cancel=!0;return}!p("banned_blocks").includes(t.item.typeId)||(t.cancel=!0,new E(t.source,null,"Placing Banned Blocks"))});it.events.beforeItemUseOn.subscribe(t=>{!(t.source instanceof cn)||!t.item.typeId.endsWith("spawn_egg")||["admin","moderator"].includes(c(t.source))||t.source.dimension.getBlock(t.blockLocation).typeId==co.mobSpawner.id||(t.cancel=!0,t.source.tell("\xA7c[Rubedo]: You cannot place spawnEggs on the floor!"),t.source.playSound("note.bass"))});var st=32e4;R(t=>{(Math.abs(t.location.x)>st||Math.abs(t.location.y)>st||Math.abs(t.location.z)>st)&&new E(t,null,"Crasher detected")});import{GameMode as uo,world as po}from"@minecraft/server";var fo=uo.creative,ln=new T;A(()=>{let t=p("gamemode_config");for(let e of po.getPlayers({gameMode:fo})){if(["moderator","admin","builder"].includes(c(e)))continue;try{t.setToSurvival&&e.runCommand("gamemode s"),t.clearPlayer&&e.runCommand("clear @s")}catch{}let n=(ln.get(e)??0)+1;ln.set(e,n),t.banPlayer&&n>=t.violationCount&&new E(e,null,"Illegal Gamemode")}},20);import{world as dn}from"@minecraft/server";var go="\xA7c\xA7k\xA7m\xA7A\xA7r\xA7cToolbox Gamer\xA7k\xA7mA\xA7r";dn.events.playerJoin.subscribe(({player:t})=>{let e=()=>N(t,["\xA7cYou have been kicked!",`\xA7aReason: \xA7f'${t.name}' is Detected for nameSpoof`,"\xA7fThis Server requires you to have a valid gamertag!"]);if(t.name==go||[...dn.getPlayers()].filter(n=>n.name==t.name).length>1||(s.ids.get(t.name)??t.id)!=t.id||t.name.includes("\xA7"))return e()});import{world as ho,Location as bo}from"@minecraft/server";import{world as yo}from"@minecraft/server";var Be=class{constructor(e){this.emptySlotsCount=e.emptySlotsCount,this.size=e.size,this.items=[];for(let n=0;n<this.size;n++)this.items[n]=e.getItem(n)}load(e){for(let n=0;n<e.size;n++)!this.items[n]||e.setItem(n,this.items[n])}};var Ne={};A(()=>{Ne={};for(let t of yo.getPlayers()){if(t.dimension.id!="minecraft:overworld")continue;let e=ut(t.location),n=e.offset(U.x,U.y,U.z),o=e.offset(-U.x,-U.y,-U.z);for(let r of n.blocksBetween(o)){if(r.y<-64)continue;let i=t.dimension.getBlock(r);!i||!Ie.includes(i.typeId)||(Ne[JSON.stringify(r)]=new Be(i.getComponent("inventory").container))}}},100);var at={};ho.events.blockBreak.subscribe(t=>{for(let e of Object.values(at))e.callback(new mt(t.block,t.brokenBlockPermutation,t.dimension,t.player))});var Re=class{static subscribe(e){let n=Date.now();return at[n]={callback:e},n}static unsubscribe(e){delete at[e]}},mt=class{constructor(e,n,o,r){this.block=e;this.brokenBlockPermutation=n;this.dimension=o;this.player=r;this.block=e,this.brokenBlockPermutation=n,this.dimension=o,this.player=r}set cancel(e){if(this.dimension.getBlock(this.block.location).setPermutation(this.brokenBlockPermutation.clone()),Ie.includes(this.brokenBlockPermutation.type.id)){let n=Ne[JSON.stringify(this.block.location)];n&&n.load(this.block.getComponent("inventory").container)}He(()=>{[...this.dimension.getEntities({maxDistance:2,type:"minecraft:item",location:new bo(this.block.location.x,this.block.location.y,this.block.location.z)})].forEach(n=>n.kill())},0)}};var un=new T,ko=15,Io=["snow","lush_plants_replaceable","azalea_log_replaceable","minecraft:crop","fertilize_area"],Co=["minecraft:water","minecraft:flowing_water","minecraft:lava","minecraft:flowing_lava","minecraft:bedrock"],pn=new T;Re.subscribe(t=>{if(["moderator","admin"].includes(c(t.player))||t.block.getTags().some(n=>Io.includes(n)))return;let e=un.get(t.player);if(un.set(t.player,Date.now()),!!e){if(!Co.includes(t.block.typeId)){if(e<Date.now()-ko)return;let n=p("nuker_data"),o=(pn.get(t.player)??0)+1;pn.set(t.player,o),n.banPlayer&&o>=n.violationCount&&new E(t.player,null,"Using Nuker")}t.cancel=!0}});import{world as wo}from"@minecraft/server";var fn=new T,gn=new T;wo.events.beforeChat.subscribe(t=>{if(t.message.startsWith(v)||["admin","moderator"].includes(c(t.sender)))return;let e=p("spam_config"),n=()=>{let o=(gn.get(t.sender)??0)+1;gn.set(t.sender,o),e.permMutePlayer&&o>=e.violationCount&&new _(t.sender,null,"Spamming")};if(e.repeatedMessages&&fn.get(t.sender)==t.message)return t.cancel=!0,n(),t.sender.tell("\xA7cRepeated message detected!");if(e.zalgo&&/%CC%/g.test(encodeURIComponent(t.message)))return t.cancel=!0,n(),t.sender.tell("\xA7cYou message contains some type of zalgo and cannot be sent!");fn.set(t.sender,t.message)});var yn=new T;function _e(t,e){let n=t.getComponent("inventory").container,o=n.getItem(e),r=p("cbe_config");if(r.clearItem&&n.setItem(e,C),new V({playerName:t.name,message:`${t.name} Has obtained a unobtainable item: ${o.typeId}`,protection:"unobtainable"}),!r.banPlayer)return;let i=(yn.get(t)??0)+1;yn.set(t,i),!(i<r.violationCount)&&new E(t,null,"Possession of Unobtainable item")}R(t=>{let e=p("banned_items"),n=t.getComponent("inventory").container;for(let o=0;o<n.size;o++){let r=n.getItem(o);if(!r)continue;if(e.includes(r.typeId))return _e(t,o);if(St.includes(r.typeId))return new V({playerName:t.name,message:`${t.name} Has obtained a Forbidden item: ${r.typeId}`,protection:"unobtainable"}),n.setItem(o,C);let i=[];for(let a of r.getComponent("enchantments").enchantments){let m=Rt(a);if(a.level>m)return _e(t,o);if(a.level<1||i.includes(a.type.id))return _e(t,1);i.push(a.type.id)}}});import{MinecraftBlockTypes as w,MinecraftEntityTypes as vo,MinecraftItemTypes as G,Player as To,world as hn}from"@minecraft/server";var So=[w.chest.id,w.trappedChest.id,w.barrel.id,w.dispenser.id,w.dropper.id,w.furnace.id,w.litFurnace.id,w.blastFurnace.id,w.litBlastFurnace.id,w.smoker.id,w.litSmoker.id,w.hopper.id,w.beehive.id,w.beeNest.id,w.mobSpawner.id],Eo=[G.chestBoat.id,G.oakChestBoat.id,G.birchChestBoat.id,G.acaciaChestBoat.id,G.jungleChestBoat.id,G.spruceChestBoat.id,G.darkOakChestBoat.id,G.mangroveChestBoat.id];hn.events.blockPlace.subscribe(async({player:t,block:e})=>{if(!So.includes(e.typeId))return;let n=e.permutation;await e.dimension.runCommandAsync(`setblock ${e.x} ${e.y} ${e.z} ${e.typeId}`),e.setPermutation(n)});hn.events.beforeItemUseOn.subscribe(t=>{t.source instanceof To&&(!Eo.includes(t.item.typeId)||(t.cancel=!0,t.source.dimension.spawnEntity(vo.chestBoat.id,t.blockLocation.above()),_t(t.source)!="creative"&&t.source.getComponent("inventory").container.setItem(t.source.selectedSlot,C)))});import{Player as Po,world as ye}from"@minecraft/server";var Ao=ye.events.beforeDataDrivenEntityTriggerEvent.subscribe(t=>{if(ye.getDynamicProperty("roleHasBeenSet"))return ye.events.beforeDataDrivenEntityTriggerEvent.unsubscribe(Ao);t.entity instanceof Po&&t.id=="rubedo:becomeAdmin"&&(J(t.entity,"admin"),ye.setDynamicProperty("roleHasBeenSet",!0),ye.setDynamicProperty("worldsOwner",t.entity.id),t.entity.tell("\xA7l\xA7cYou have been given admin, the function start will not work anymore!!!!"))});import{system as xo}from"@minecraft/server";xo.events.beforeWatchdogTerminate.subscribe(t=>{t.cancel=!0,console.warn(`WATCHDOG TRIED TO CRASH = ${t.terminateReason}`)});import{DynamicPropertiesDefinition as ct,EntityTypes as Bo,MinecraftEntityTypes as No,world as kn}from"@minecraft/server";var bn=[];kn.events.worldInitialize.subscribe(({propertyRegistry:t})=>{b.overworld.runCommandAsync(`tickingarea add ${B.x} ${B.y} ${B.z} ${B.x} ${B.y} ${B.z} db true`);let e=new ct;e.defineString("name",30),e.defineNumber("index"),t.registerEntityTypeDynamicProperties(e,Bo.get(ee));let n=new ct;n.defineString("role",30),t.registerEntityTypeDynamicProperties(n,No.player);let o=new ct;o.defineBoolean("roleHasBeenSet"),o.defineString("worldsOwner",100),o.defineBoolean("isLockDown"),t.registerWorldDynamicProperties(o);for(let r of bn)kn.scoreboard.addObjective(r.objective,r.displayName??"")});var Pe=[];function Wt(){Pe=[]}console.warn("----- Importing Plugins -----");console.warn("---- STARTING RUBEDO ----");var Le=null,C=new Ro(_o.stick,0);Lo.events.tick.subscribe(t=>{Le?Le=Le+1:Le=t.currentTick});export{C as AIR,Le as CURRENT_TICK};
//# sourceMappingURL=index.js.map
